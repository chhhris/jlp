if("unit_test"!=window.debugMode){var topLevelDomains={com:!0,org:!0,net:!0,edu:!0,gov:!0,mil:!0,info:!0,co:!0,ac:!0},subDomain=document.domain.split(".");if(subDomain.length>2){var beforeLastPart=subDomain[subDomain.length-2];subDomain=topLevelDomains[beforeLastPart]?subDomain[subDomain.length-3]+"."+subDomain[subDomain.length-2]+"."+subDomain[subDomain.length-1]:subDomain[subDomain.length-2]+"."+subDomain[subDomain.length-1]}try{document.domain=subDomain}catch(e){}}define.Const("CoreClasses",{HIDDEN:"hidden"}),define.Const("CoreEvents",{CLICK:"click",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",COPY:"copy",CUT:"cut",BLUR:"blur",FOCUS:"focus",PASTE:"paste",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",MOUSE_WHEEL:"mousewheel",CHANGE:"change",INPUT:"input",RESIZE:"resize",SCROLL:"scroll"}),define.Const("DisplayEvents",{ADDED_TO_DOM:"insertedToDOM",REMOVED_FROM_DOM:"removedFromDOM",DISPLAYED:"displayed!",COLLAPSED:"collapsed!",DISPLAY_CHANGED:"displayed?",MOVED_IN_DOM:"movedInDOM",SKIN_CHANGE:"skinChange"}),define.bootstrapClass("bootstrap.extendnative.Array",function(){return Array.implement({moveItem:function(e,t){var r=this[e];0>t&&(t=0),t>this.length-1&&(t=this.length-1),this.splice(e,1),this.splice(t,0,r)},getIndexByField:function(e,t){for(var r=0,i=this.length;i>r;r++)if(this[r][e]==t)return r;return-1},getByField:function(e,t){var r=this.getIndexByField(e,t);return r>=0?this[r]:void 0},indexOfByPredicate:function(e){for(var t=0;this.length>t;t++)if(e(this[t]))return t;return-1},intersect:function(e,t){return this.filter(function(r){return e.some(function(e){return t?t(r,e):r===e})})},isIntersecting:function(e,t){return this.some(function(r){return e.some(function(e){return t?t(r,e):r===e})})},first:function(e){for(var t,r=0;!t&&this.length>r;r++)e(this[r])&&(t=this[r]);return t},eraseWithPredicate:function(e){var t=this.filter(e);return t.forEach(function(e){this.erase(e)},this),this},toMap:function(e){for(var t={},r=0;this.length>r;r++){var i=e(this[r],r,this);t[i]=this[r]}return t}}),Array.isArray||Array.implement({isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)}}),Array}),define.bootstrapClass("bootstrap.extendnative.Element",function(){return Element.implement({cleanup:function(){var e=$(this.parentNode);e&&e.removeEvents(Constants.DisplayEvents.ADDED_TO_DOM)},insertInto:function(e,t,r){if(!e)return LOG.reportError(wixErrors.CM_NULL_PARENT,"Element","insertInto"),this;if(!t&&this.getParent()===e)return this;var i=$(e);if(i.grab(this,t),("before"==t||"after"==t)&&(e=e.parentNode,null===e))return LOG.reportError(wixErrors.CM_NULL_PARENT,"Element","insertInto"),this;var n=Constants.DisplayEvents.ADDED_TO_DOM;return this.getLogic&&this.getLogic().getIsDisplayed()&&(n=Constants.DisplayEvents.MOVED_IN_DOM),r=r||n,this.isNodeDisplayed()&&this.fireEventRecursively(Constants.DisplayEvents.ADDED_TO_DOM,r),this},fireEventRecursively:function(e,t,r){this.fireEvent(e,t,r);for(var i=this.getChildren(),n=0;i.length>n;n++){var s=i[n];s.fireEventRecursively&&s.fireEventRecursively(e,t,r)}},removeFromDOM:function(){var e=this.isNodeDisplayed();if(this.parentNode){var t=$(this.parentNode);t&&t.removeEvent(Constants.DisplayEvents.ADDED_TO_DOM,this._insertedToDOMCB),this.dispose()}e&&this._onDisplayChangedEvent(Constants.DisplayEvents.REMOVED_FROM_DOM,0)},setCollapsed:function(e){e?this.collapse():this.uncollapse()},toggleCollapsed:function(){return this.hasClass(Constants.CoreClasses.HIDDEN)?this.uncollapse():this.collapse(),this},collapse:function(){return!1===this.hasClass(Constants.CoreClasses.HIDDEN)&&(this.addClass(Constants.CoreClasses.HIDDEN),this._onDisplayChangedEvent(Constants.DisplayEvents.COLLAPSED,0)),this},uncollapse:function(e){return this.hasClass(Constants.CoreClasses.HIDDEN)&&(this.removeClass(Constants.CoreClasses.HIDDEN),e&&this.addClass(e),this._onDisplayChangedEvent(Constants.DisplayEvents.DISPLAYED,0)),this},triggerDisplayChanged:function(){this._onDisplayChangedEvent(Constants.DisplayEvents.DISPLAY_CHANGED,0)},isConnectedToDOM:function(){for(var e=this,t=document.documentElement;e;){if(e.documentElement==t)return!0;e=e.parentNode}return!1},isCollapsed:function(){for(var e=document.documentElement,t=this;t;){if(e==t.documentElement)return!1;t.style;var r=t.getStyle("display");if("none"==r||t.hasClass("hidden"))return!0;t=t.parentNode}return!1},isNodeDisplayed:function(){var e=this;for(document.documentElement;e;){if("document"==typeOf(e))return!0;var t=$(e);if(!t)return!1;var r=t.getStyle("display");if("none"==r||t.hasClass("hidden"))return!1;e=e.parentNode}return!1},_onDisplayChangedEvent:function(e){var t,r,i,n;if(this.getElementsByTagName)if(t=this.getElementsByTagName("*")||[],Browser.ie)if(Array.slice)t=Array.slice(t);else{for(i=[],r=t.length-1;r>=0;--r)i[r]=t[r];t=i}else t=Array.prototype.slice.call(t);else t=this.getElements("*")||[];for(r=0,n=t.length;n>r;++r)try{i=t[r],i.fireEvent&&i.fireEvent(e,e)}catch(s){this._reportUnknownError(s)}try{this.fireEvent(e,e)}catch(o){this._reportUnknownError(o)}},_reportUnknownError:function(e){var t=this&&this.getLogic&&this.getLogic()&&this.getLogic()._editedComponent&&this.getLogic()._editedComponent.$className||"no component name",r=e&&e.message||"no message",i=wixErrors.UNKNOWN_ERROR;i.ignore=!0,LOG.reportError(i,"Element.js",t,r)},_insertedToDOM:function(e){this.fireEvent(Constants.DisplayEvents.ADDED_TO_DOM,e)},getContentRect:function(e){e=e||$$("body")[0];var t=this.getCoordinates(e);return this.getElements("div").forEach(function(r){if(r.isVisible()===!0&&r.isDisplayed()===!0){var i=r.getCoordinates(e);i.left<t.left&&(t.left=i.left),i.right>t.right&&(t.right=i.right),i.top<t.top&&(t.top=i.top),i.bottom>t.bottom&&(t.bottom=i.bottom)}}),t.width=t.right-t.left,t.height=t.bottom-t.top,t},_insertedToDOMCB:null}),Element.NativeEvents.cut=2,Element.NativeEvents.paste=2,Element.Events.paste={base:"paste",condition:function(e){return this.fireEvent(Constants.CoreEvents.PASTE,e,1),!1}},Element.Events.cut={base:"cut",condition:function(e){return this.fireEvent(Constants.CoreEvents.CUT,e,1),!1}},Element}),Object.isEquivalent=function(e,t){if(typeof e!=typeof t)return!1;if(e instanceof Array&&!(t instanceof Array))return!1;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"function"==typeof t)return e===t;var r=0,i=e instanceof Array;if(i){var n=function(e,r){return Object.isEquivalent(e,t[r])};return e.length==t.length&&e.every(n,t)}for(var s in e){if(e.hasOwnProperty(s)&&!t.hasOwnProperty(s))return!1;++r}for(s in t)t.hasOwnProperty(s)&&r--;if(0!==r)return!1;for(s in e)if(e.hasOwnProperty(s)&&!Object.isEquivalent(e[s],t[s]))return!1;return!0},define.Class("bootstrap.managers.BaseManager",function(e){var t=e;t.inherits("bootstrap.utils.Events"),t.methods({isReady:function(){return!0},clone:function(e){var t,r=this.$className;if(e.getResourceFetcher().getResourceValue("W.Classes",function(e){e.getClass(r,function(e){t=new e})}),!t)throw Error("clone failed: "+r);return t}})}),define.Class("bootstrap.managers.InputBindings",function(e){var t=e;t.inherits("bootstrap.managers.BaseManager"),t.binds(["isStopCallback"]),t.methods({initialize:function(){this._listener=Mousetrap;try{this._listener.unpause()}catch(e){console.error("throw new Error('Mousetrap not loaded');")}},isReady:function(){return!0},clone:function(){return new this.$class},addBinding:function(e,t,r){if(t=t||{},e){var i=r?"bindGlobal":"bind",n=t.keypressType,s=t.command,o=t.commandParameter;!s&&t.commandName&&(s=W.Commands.getCommand(t.commandName)),this._listener[i](e,function(e,t){return s&&s.isEnabled()&&(e.combo=t,s.execute(o,e)),e.preventDefault(),e.stopPropagation(),!1},n)}},removeBinding:function(e,t){this._listener.unbind(e,t)},setKeysEnabled:function(e){e?this._listener.unpause():this._listener.pause()},getKeysEnabled:function(){return this._listener.isEnabled()},isStopCallback:function(e,t,r,i){return this._listener.stopCallback(e,t,r,i)}})}),define.bootstrapClass("bootstrap.managers.classmanager.ClassDefinition",function(){"use strict";function e(){this.$constructor=e,this._extends_=void 0,this._binds_=void 0,this._traits_=void 0,this._statics_=void 0,this._fields_={},this._methods_={},this._imports_=void 0,this._resources_=void 0,this._onClassReadyFunc_=void 0,this._inheritStrategy_=new t}var t=this.define.getBootstrapClass("bootstrap.managers.classmanager.InheritStrategy");return e.extendPrototype({InheritStrategy:t,inherits:function(e){this._extends_=e},binds:function(e){this._binds_=e},traits:function(e){this._traits_=e},statics:function(e){"function"==typeof e&&LOG.reportError(wixErrors.INVALID_STATICS_PARAM,"classDefinition","statics"),this._statics_=e},fields:function(e){"function"==typeof e&&LOG.reportError(wixErrors.INVALID_FIELDS_PARAM,"classDefinition","fields"),this._fields_=e},methods:function(e){"function"==typeof e&&LOG.reportError(wixErrors.INVALID_METHODS_PARAM,"classDefinition","methods"),this._methods_=e},resources:function(e){this._resources_=e},utilize:function(e){this._imports_=e},onClassReady:function(e){this._onClassReadyFunc_=e}}),e}),define.bootstrapClass("bootstrap.managers.classmanager.ClassManager",function(){function e(){}return e.extendPrototype({init:function(){var e=this;return resource.getResources(["scriptLoader","W.Experiments"],function(t){var r=t.scriptLoader;e._experimentManager=t.W.Experiments;var i=e.define.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition");e._classRepo=e.define.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassRepository").init(r,e),e._classParser=e.define.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassParser").init(e._classRepo,i,e._experimentManager),e.define.Class.definitionModifier=e._onClassDefineCallBack.bind(e)}),this},addClassNamespaceHook:function(e){this._classRepo.classNamespacesHooks.push(e)},addClassReadyHandler:function(e){this._classRepo.classReadyHandlers.push(e)},loadMissingClasses:function(){this._classRepo.loadMissingClasses()},getClass:function(e,t){var r=this._classRepo.getClassStatus(e);if("ready"==r){var i=this._classRepo.getClass(e);return t&&t(i),i}this._getNotReadyClass(e,r,t)},_getNotReadyClass:function(e,t,r){switch(this._classRepo.addToWaitingForReady(e,r),t){case"loaded":var i=this.define.getDefinition("Class"),n=nsUtil.getNameSpace(i,e),s=this._classParser.registerNewClass(e,n);s&&s.length>0&&this._getClassDependencies(s);break;case"missing":this._classRepo.addClassesToScriptLoadingQueue([e])}},_getClassDependencies:function(e){for(var t=0;e.length>t;t++){var r=this._classRepo.getClassStatus(e[t]);"ready"!=r&&this.getClass(e[t])}},registerClassDefinition:function(e,t){var r=this._classParser.registerClassDefinition(e,t);r&&r.length>0&&this._getClassDependencies(r)},get:function(e,t){return this.getClass(e,t)},_onClassDefineCallBack:function(e,t){return this._classRepo.isClassWaitingForReady(e)&&this._classParser.registerNewClass(e,t),t},override:function(e,t){this._classRepo.override(e,t)},overrideDependency:function(e,t){return this._classParser.override(e,t)},getClassStatus:function(e){return this._classRepo.getClassStatus(e)},getClassStatusDetails:function(e){return this._classRepo.getClassStatusDetails(e)},newClass:function(e){return this._classRepo.getClass(e.name)?(LOG.reportError(wixErrors.CLASS_ALREADY_EXIST,this.className,"newClass",e.name),void 0):(this._classParser.registerClass(Object.clone(e)),this.getClass(e.name))},newTrait:function(e){e.Class=e.trait,delete e.trait,this.newClass(e)},newClasses:function(e){Object.forEach(e,this.newClass.bind(this))},_getClassDataErrorCode:function(e){this._classParser._getClassDataErrorCode(e)},removeClass:function(e){this._classRepo.deleteClass(e)},isReady:function(){return this._classRepo&&this._classRepo.isReady()},clone:function(e){var t=e.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassManager",[]),r=e.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition");return t._classRepo=this._classRepo.clone(e),e.getResourceFetcher().getResourceValue("W.Experiments",function(i){t._experimentManager=i,t._classParser=e.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassParser",[t._classRepo,r,t._experimentManager])}),t}}),e}),define.bootstrapClass("bootstrap.managers.classmanager.ClassParser",function(){function e(){this.registerClass=this.registerClass.bind(this)}return e.extendPrototype({init:function(e,t,r){return this._repository=e,this._overrides={},this.ClassDefinition=t,this._experimentManager=r,this},override:function(e,t){this._overrides[e]=this._overrides[e]||[];var r=this._overrides[e].length?this._overrides[e].getLast():e;return this._overrides[e].push(t),r},registerNewClass:function(e,t){var r=new this.ClassDefinition;return t(r,r._inheritStrategy_),r=this._experimentManager.applyExperiments(e,r),this.registerClassDefinition(e,r)},registerClassDefinition:function(e,t){var r=this._transformClassDefToClassData(e,t);return r._classDef_=t,this.registerClass(r)},registerClass:function(e){if(!this._checkClassRegistraionErrors(e)){var t=this._getItemDependencies(e);this._registerDependencies(t);var r=this._repository.areClassesReady(t);if(!r)return this._repository.registerDependentClass(t,this.registerClass,e),t;this._prepClassData(e);var i=this._prepResources(e);if(i&&i.length){var n=this;e.Class.Resources=i,resource.getResources(i,function(t){e.Class.$Resources=t,n._createAndRegisterWClass(e)})}else this._createAndRegisterWClass(e)}},_createAndRegisterWClass:function(e){var t=new WClass(e.Class,e.name);t._classDef_=e._classDef_,e.Class.Extends&&this._overrideClassObjectFields(t.prototype.Extends.prototype,t.prototype),this._repository.registerClass(t),e.onClassReady&&e.onClassReady(t)},_checkClassRegistraionErrors:function(e){var t=this._getClassDataErrorCode(e);return t?(LOG.reportError(wixErrors.CLASS_INVALID_PENDING_OBJECT,e&&e.name||"Unknown class","class data validation",t),!0):void 0},_registerDependencies:function(e){for(var t=this.define.getDefinition("Class"),r=0;e.length>r;++r){var i=e[r];if("loaded"===this._repository.getClassStatus(i)){var n=nsUtil.getNameSpace(t,i);this.registerNewClass(i,n)}}},_getFullNotReadyDependencyList:function(e,t,r){for(var r=r||{},i=0;t.length>i;i++){var n=t[i];if(n!==e&&!r[n]){var s=this._repository.getClassWaitingDependencies(n);if(s){for(var o=[],a=0;s.length>a;a++)this._repository.isClassReady(s[a])||o.push(s[a]);o.length>0&&(r[n]=o,this._getFullNotReadyDependencyList(e,o,r))}return r}}},_checkReadyRamificationsOnDependencies:function(e,t){for(var r in t)for(var i=t[r],n=0;i.length>n;n++){var s=i[n];if(!t[s]&&e!==s)return!1}return!0},_transformClassDefToClassData:function(e,t){var r={name:e,traits:t._traits_,imports:t._imports_,onClassReady:t._onClassReadyFunc_,Class:{Resources:t._resources_,Extends:t._extends_,Binds:t._binds_,Static:t._statics_}};for(var i in t._methods_){var n=t._methods_[i];r.Class[i]=n}for(var s in t._fields_){var o=t._fields_[s];r.Class[s]=o}return r},_overrideClassObjectFields:function(e,t){for(var r in t)if(t.hasOwnProperty(r)){var i,n=t[r];if(n instanceof Function&&n.mergeFlag){if(n=n(),"object"==typeOf(n)){i=Object.clone(e[r]);for(var s in n)n.hasOwnProperty(s)&&(void 0===n[s]?delete i[s]:i[s]=n[s])}else"array"==typeOf(n)&&(i=e[r].clone(),i.combine(n));t[r]=i}else if(n&&n.cloneFlag){var o=e[r];"object"==typeOf(o)?i=Object.clone(e[r]):"array"==typeOf(o)?i=e[r].clone():"string"==typeOf(o)&&(i=e[r]),t[r]=i}else n&&n.beforeFlag?function(){var i=e[r],s=n();t[r]=function(){s.apply(this,arguments),i.apply(this,arguments)}}():n&&n.aroundFlag?function(){var i=r,s=e[r],o=n();t[r]=function(){var e=this,r=Array.prototype.splice.call(arguments,0),n=!1;r.splice(0,0,function(){return n=!0,s.apply(e,r.slice(1))});var a=o.apply(this,r);return n||LOG.reportError(wixErrors.EXPERIMENT_INVALID_MODIFY+" - Original method was not called",t.className,i,r.slice(1)),a}}():n&&n.afterFlag&&function(){var i=e[r],s=n();t[r]=function(){i.apply(this,arguments),s.apply(this,arguments)}}()}},_getItemDependencies:function(e){var t=[];return e.Class&&e.Class.Extends&&t.combine(this._extractStringsOnlyArray(e.Class.Extends)),e.imports&&t.combine(this._extractStringsOnlyArray(e.imports)),e.traits&&t.combine(this._extractStringsOnlyArray(e.traits)),t=this._replaceDependenciesWithOverrides(e.name,t)},_replaceDependenciesWithOverrides:function(e,t){return Object.keys(this._overrides).length&&Array.each(t,function(r,i){if(this._overrides[r]){var n=this._overrides[r].length-1,s=this._overrides[r].indexOf(e);s>=0&&(n=s?s-1:0),this._overrides[r][n]!=e&&(t[i]=this._overrides[r][n])}}.bind(this)),t},_extractStringsOnlyArray:function(e){return"string"==typeOf(e)?[e]:"array"==typeOf(e)?e.filter(this._isString):[]},_isString:function(e){return"string"==typeOf(e)},_prepClassData:function(e){e=this._prepClassExtends(e),e=this._prepClassTraits(e),e=this._prepClassImports(e);var t=window.W;return e.Class.injects=function(){return t},e.Class.define=this.define,e.Class.resource=this.resource,e},_prepClassExtends:function(e){return e.Class.Extends&&"string"==typeOf(e.Class.Extends)&&(e.Class.Extends=this._repository.getClass(e.Class.Extends)),e},_prepClassTraits:function(e){if(e.traits){e.Class.Implements=[];for(var t=0;e.traits.length>t;t++){var r=e.traits[t];e.Class.Implements.push(this._repository.getClass(r))}}return e},_prepClassImports:function(e){var t,r=e.Class.Extends,i=r&&r.prototype&&r.prototype.imports;if(t=i?Object.clone(r.prototype.imports):{},e.imports)for(var n=0;e.imports.length>n;n++){var s=e.imports[n],o=s.split(".").getLast();t[o]?t[s]=this._repository.getClass(s):t[o]=this._repository.getClass(s)}if(e.Class.imports=t,e.Class.Implements)for(var a=0;e.Class.Implements.length>a;++a){if(!e.Class.Implements[a])return e;var l=e.Class.Implements[a].prototype;l&&l.imports&&(e.Class.imports||(e.Class.imports=[]),Object.merge(e.Class.imports,l.imports))}return e},_prepResources:function(e){var t=e.Class.Resources||[],r=e.Class.Extends,i=r&&r.prototype&&r.prototype.Resources;if(i=i?Array.clone(r.prototype.Resources):[],t=Array.combine(t,i),e.Class.Implements)for(var n=0;e.Class.Implements.length>n;++n){var s=e.Class.Implements[n].prototype;s&&s.Resources&&(t=Array.combine(t,s.Resources))}return t},_getClassDataErrorCode:function(e){return e&&"object"===typeOf(e.Class)?e.name&&instanceOf(e.name,String)?this._isValidClassName(e.name)?e.Extends&&"string"!=typeOf(e.Extends)?"Extends must be a string":e.imports&&!this._isStringArray(e.imports)?"Invalid imports array":e.traits&&!this._isStringArray(e.traits)?"Invalid traits array":!1:"Invalid class name: "+e.name:"No class name":"No class data was found"},_isValidClassName:function(e){for(var t=e.split("."),r=t.length-1,i=0;r>i;i++){if(0===t[i].length)return!1;if(!t[i].test(/^[a-z][a-z0-9_]*$/))return!1}return t[r].test(/^[A-Z][A-Za-z0-9_]*$/)?!0:!1},_isStringArray:function(e){return"array"!=typeOf(e)?!1:e.every(function(e){return"string"==typeOf(e)})}}),e}),define.bootstrapClass("bootstrap.managers.classmanager.ClassRepository",function(){function e(){this.loadMissingClasses=this.loadMissingClasses.bind(this)}return e.extendPrototype({init:function(e,t){return this._readyClasses={},this._waitingForDependencies={},this._waitingForClassReady={},this._scriptLoadingQueue=[],this._scriptLoader=e,this._loadingMissingClassesStarted=!!t,this._loadingMissingClassesTimer=null,this.classNamespacesHooks=[],this.classReadyHandlers=[],this},getClass:function(e){return this._readyClasses[e]||null},getClassWhenReady:function(e,t){return this.isClassReady(e)?(t&&t(this.getClass(e)),this.getClass(e)):(this.isClassLoaded(e)||this.addClassesToScriptLoadingQueue([e]),this._waitingForClassReady[e]||(this._waitingForClassReady[e]=[]),t&&this._waitingForClassReady[e].push(t),void 0)},addToWaitingForReady:function(e,t){this._waitingForClassReady[e]||(this._waitingForClassReady[e]=[]),t&&this._waitingForClassReady[e].push(t)},getClassStatus:function(e){return this.isClassReady(e)?"ready":this.isClassWaitingForDependencies(e)?"pending":this.isClassLoaded(e)?"loaded":"missing"},getClassStatusDetails:function(e,t){t||(t=1);var r=this.getClassStatus(e);if("ready"===r)return"ready";if("missing"===r)return"missing";for(var i="pending:\n",n=this._waitingForDependencies[e].dependenciesArray,s=0;n.length>s;s++){var o=this.getClassStatusDetails(n[s],t+1);"ready"!=o&&(i+=this._addTabs(t)+"class :"+n[s]+":"+o)}return i},_addTabs:function(e){for(var t="",r=0;e>r;r++)t+="	";return t},registerClass:function(e){var t=e.prototype.$className;for(this._readyClasses[t]=e,r=0;this.classReadyHandlers.length>r;++r)this.classReadyHandlers[r](t,e);if(this._waitingForClassReady[t]){for(var r=0;this._waitingForClassReady[t].length>r;r++)this._waitingForClassReady[t][r](e);delete this._waitingForClassReady[t]}for(var i in this._waitingForDependencies){var n=this._waitingForDependencies[i];this.areClassesReady(n.dependenciesArray)&&(delete this._waitingForDependencies[i],n.callback(n.classData))}},isClassReady:function(e){return this._readyClasses[e]!==void 0},deleteClass:function(e){delete this._readyClasses[e]},areClassesReady:function(e){var t,r,i=!0;for(t=0,r=e.length;r>t;t++)if(!this.isClassReady(e[t])){i=!1;break}return i},registerDependentClass:function(e,t,r){return this.areClassesReady(e)?(t(r),void 0):(this._waitingForDependencies[r.name]={dependenciesArray:e,callback:t,classData:r},this.addClassesToScriptLoadingQueue(e),void 0)},loadMissingClasses:function(){this._filterLoadedClassesFromList(this._scriptLoadingQueue),clearTimeout(this._loadingMissingClassesTimer),delete this._loadingMissingClassesTimer,this._loadingMissingClassesStarted=!0;for(var e=0;this._scriptLoadingQueue.length>e;++e){var t={url:this._scriptLoadingQueue[e]};this._scriptLoader.loadResource(t)}this._scriptLoadingQueue=[]},isClassLoaded:function(e){var t=this.define.getDefinition("Class");return nsUtil.getNameSpace(t,e)},isClassWaitingForDependencies:function(e){return this._waitingForDependencies[e]},getClassWaitingDependencies:function(e){return this.isClassWaitingForDependencies(e)?this._waitingForDependencies[e].dependenciesArray:null},isClassWaitingForReady:function(e){return this._waitingForClassReady[e]},isReady:function(){var e;for(e in this._waitingForDependencies)return!1;if(this._scriptLoadingQueue=this._filterLoadedClassesFromList(this._scriptLoadingQueue),this._scriptLoadingQueue.length)return!1;for(e in this._waitingForClassReady)return!1;return!0},clone:function(e){return e.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassRepository",[this._scriptLoader,this._loadingMissingClassesStarted])},addClassesToScriptLoadingQueue:function(e){var t=this._filterLoadedClassesFromList(e);this._loadClassesFromOtherNameSpaces(t),t=this._filterLoadedClassesFromList(t),this._scriptLoadingQueue.combine(t),this._loadingMissingClassesStarted&&!this._loadingMissingClassesTimer&&(this._loadingMissingClassesTimer=setTimeout(this.loadMissingClasses,10))},_loadClassesFromOtherNameSpaces:function(e){var t,r;for(t=0;e.length>t;t++)for(r=0;this.classNamespacesHooks.length>r;r++)"missing"===this.getClassStatus(e[t])&&this.classNamespacesHooks[r](e[t])},_filterLoadedClassesFromList:function(e){var t=this;return e.filter(function(e){return"missing"===t.getClassStatus(e)})},override:function(e,t){if(!e)throw Error("Invalid class name for override");this._readyClasses[e]=t}}),e}),define.experimentPlugin("ExperimentClassPlugin",function(e){function t(e,t){var r=this.define.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition"),i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),n=e;"function"==typeof e&&(n=new r,e(n));var s=new r;return t(s,i),n.inherits(s._extends_||n._extends_),n.resources(i._mergeField_(n._resources_,s._resources_)),n.binds(i._mergeField_(n._binds_,s._binds_)),n.traits(i._mergeField_(n._traits_,s._traits_)),n.utilize(i._mergeField_(n._imports_,s._imports_)),n.statics(i._mergeObjects_(n._statics_,s._statics_)),n.fields(i._mergeObjects_(n._fields_,s._fields_)),n.methods(i._mergeObjects_(n._methods_,s._methods_)),n}function r(e,t){define.Class(e,t)}var i=e;i.init("Class","newClass",t,r)}),define.bootstrapClass("bootstrap.managers.classmanager.InheritStrategy",function(){"use strict";function e(){}return e.extendPrototype({STRATEGIES:{INHERIT:"inherit",MERGE:"merge",OVERRIDE:"override"},inherit:function(){return{_strategy_:this.STRATEGIES.INHERIT}},merge:function(e,t){return{_strategy_:this.STRATEGIES.MERGE,include:e,exclude:t}},getInheritStrategy:function(e){return e?e._strategy_||this.STRATEGIES.OVERRIDE:this.STRATEGIES.OVERRIDE}}),e}),define.bootstrapClass("bootstrap.bootstrap.WClass",function(){function e(e,t){var r=this;if(e=e||{},e.className=t||e.className,r.validateScope(this,e.className),!r.validateClassData(e))return r.InvalidWClass;e.$className=e.className;var i=r.clonePrototype(e.Extends),n={};for(var s in i)n[s]=i[s];r.implementTraits(e.Implements,n);for(s in e)n[s]=e[s];var o=n.Static;delete n.Static,e.Extends||(n.toString=e.hasOwnProperty("toString")&&"function"==typeof e.toString?e.toString:this._$wclassToString,n.hasClassAncestor=this._hasClassAncestor),i.Implements instanceof Array&&n.Implements.combine(i.Implements),n.Binds=r.aggregateBinds(n.Binds,i.Binds,n.Implements),n.$parentPrototype=i,n.parent=function(){function e(){do{if(t=t?t.$parentPrototype:n,!t)return;for(i in t)if(t[i]===s)break}while(t[i]!==s);if(t&&t[i]&&t.$parentPrototype){for(var e=r.realParent(t);t[i]===e[i];)t=e,e=r.realParent(t);if(t=r.realParent(t),t&&t[i]&&"function"==typeof t[i])return t[i]}}for(var t,i,s=n.parent.caller||arguments.callee.caller||arguments.caller;s.$wrapperFunction;)s=s.$wrapperFunction;if(!s)throw Error("no caller!");return s.$parent||(s.$parent=e()||1),1!==s.$parent?s.$parent.apply(this,arguments):void 0},n._super=function(e){function t(e,t,r){if(null==r)throw Error('no method "'+t+'" in the prototype chain above "'+e+'"');var i=r[t];if(void 0===i)return findProtoWithMethodInChain(e,t,r.$parentPrototype);if("function"!=typeof i)throw Error('member "'+t+'" in prototype "'+r+'" is not a function');return r}this.__super_scope=this.__super_scope||{},this.__super_scope[e]=this.__super_scope[e]||n;var r=t(n.$className,e,this.__super_scope[e].$parentPrototype);this.__super_scope[e]=r;var i=Array.prototype.slice.call(arguments,1),s=r[e],o=s.apply(this,i);return delete this.__super_scope[e],o};var a=function(){r.validateScope(this),r.bindMethods(n.Binds,this),r.initializeFieldsThatNeedToBeDeepCopied(this,this.fieldFactory()),n.initialize&&"function"==typeof n.initialize&&n.initialize.apply(this,arguments),r.initializeTraits(n.Implements,this,arguments)},l=Function("_","return function "+e.className.split(".").pop()+" (){ return _.apply(this,arguments); };")(a),c={};return c[e.className]=l,r.copyStatic(l,n,o,e.Extends),n.fieldFactory=this.createFieldFactoryFunction(n,o),n.constructor=c[e.className],l.prototype=n,n.$class=l,e.$Resources&&(n.resources=e.$Resources),n.$class.$originalClassName=n.$className,n.getOriginalClassName=function(){return n.$class.$originalClassName||n.$className},e.$extendsName?(n.$class.$extendsName=e.$extendsName,delete e.$extendsName):delete n.$class.$extendsName,l}e.extendPrototype({constructor:window.WClass,realParent:function(e){for(var t=e.$parentPrototype;t&&t.$className&&e.$class.$extendsName&&e.$class.$extendsName!=t.$className;)t=t.$parentPrototype;return t},validateScope:function(e){e!==window&&e||LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"WClass","validateScope")();for(var t in e)e.hasOwnProperty(t)&&LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"WClass","validateScope")()},clonePrototype:function(e){if("function"!=typeof e)return{};var t={},r=e.prototype||{};if(r===Function.prototype||r===Function)return t;for(var i in r)(r.hasOwnProperty(i)||"toString"==i)&&(t[i]=r[i]);return t},validateClassData:function(e){var t;if("object"!=typeof e)return LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData",t)();if("string"!=typeof e.className||0===e.className.length)return LOG.reportError(wixErrors.WCLASS_CLASS_EMPTY_STRING,"WClass","validateClassData")();for(t in e)if(-1!==this.reservedWords.indexOf(t))return LOG.reportError(wixErrors.WCLASS_CLASS_RESERVED,"WClass","validateClassData",t)();return!e.Implements||e.Implements instanceof Array?!e.Binds||e.Binds instanceof Array?!0:LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData","Binds is not an array")():LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData","Implements is not an array")()},reservedWordsForTraits:["initialize","parent","Extends","Implements","Binds","$parentPrototype","$className"],reservedWords:["parent","$parentPrototype","$className"],excludeFromClone:["define","Implements","Binds","Resources","imports","resource","resources","__super_scope","jsonOfFieldsThatNeedToBeDeepCopied"],bindMethods:function(e,t){var r,i,n;if(e instanceof Array)for(r=0,i=e.length;i>r;r++)n=e[r],"function"==typeof t[n]?t[n]=t[n].bind(t):LOG.reportError(wixErrors.WCLASS_INVALID_BIND,"WClass","bindMethods",n)},implementTraits:function(e,t){var r,i,n,s;if(t.Implements=[],e instanceof Array)for(r=0,i=e.length;i>r;r++){n=e[r],t.Implements.push(n),"function"==typeof n&&(n=n.prototype);for(s in n)s&&-1===this.reservedWordsForTraits.indexOf(s)&&(t[s]=n[s])}},initializeTraits:function(e,t,r){var i,n,s;if(e instanceof Array)for(i=0,n=e.length;n>i;i++){s=e[i],"function"==typeof s&&(s=s.prototype);var o=s.initialize;o&&"function"==typeof o&&o.apply(t,r)}},createFieldFactoryFunction:function(e,t){function r(e,r){return r&&"object"==typeof r&&"$"!==e.charAt(0)&&-1===i.excludeFromClone.indexOf(e)&&!t.hasOwnProperty(e)}var i=this;t=this.getStaticsAsObject(t);var n,s,o={};for(n in e)s=e[n],r(n,s)&&(o[n]=s);var a=JSON.stringify(o);return Function("return "+a)},initializeFieldsThatNeedToBeDeepCopied:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},getStaticsAsObject:function(e){return e?(e instanceof Function&&(e=e()),e):{}},copyStatic:function(e,t,r,i){var n;if("function"==typeof i)for(n in i)i.hasOwnProperty(n)&&(e[n]=i[n]);if(r){var s=r instanceof Function;r=s?r():r;for(n in r){if(t[n]&&!s)throw Error("The property "+n+" conflicts with a static property");e[n]=t[n]=r[n]}}},aggregateBinds:function(e,t,r){var i=[];return e instanceof Array&&i.combine(e),t instanceof Array&&i.combine(t),r&&r.forEach(function(e){e.Binds instanceof Array?i.combine(e.Binds):e.prototype&&e.prototype.Binds instanceof Array&&i.combine(e.prototype.Binds)}),i},_findMethod:function(e,t){for(;e;){if(e.hasOwnProperty(t)){var r=e[t];if("function"==typeof r)return r}if(!e.Extends)return null;e=e.Extends.prototype}return null},_hasClassAncestor:function(e,t){var r=this;do{var i,n=r.className;if(t){var s=RegExp("\\.?"+e+"(\\.|$)");i=n&&n.match(s)}else i=n==e;if(i)return!0;r=r.Extends&&r.Extends.prototype}while(r);return!1},_$wclassToString:function(){return"[wclass "+(this.className||"")+"]"},InvalidWClass:function(){throw Error("invalid WClass")},isReady:function(){return!0}});var t,r=window.instanceOf,i=window;return i.instanceOf=t=function(n,s){if(s===e&&n&&"function"==typeof n&&n.prototype&&n.prototype.$className)return!0;if(n&&n.$className&&"function"==typeof s&&s.prototype&&s.prototype.$className)return n.getOriginalClassName()==s.prototype.getOriginalClassName()||instanceOf(n.$parentPrototype,s);i.instanceOf=r;var o=instanceOf(n,s);return i.instanceOf=t,o},e}),define.Class("bootstrap.managers.commands.Command",function(e){var t=e;t.methods({initialize:function(e){this._listeners=[],this._zombies=[],this._isEnabled=!0,this._name=e,this._numTimesExecuted=0,this._broadcasting=!1},getNumTimesExecuted:function(){return this._numTimesExecuted},registerListener:function(e,t,r){var i=this._findListenerIndex(e,t);
0>i&&(this._listeners.push({listener:e,onExecute:t,onEnabledChanged:r}),r&&r.call(e,this))},unregisterListener:function(e){if(this._broadcasting)this._zombies.push(e);else for(var t;(t=this._findListenerIndex(e))>=0;)this._listeners.splice(t,1)},dispose:function(){this._listeners=[]},getName:function(){return this._name},execute:function(e,t){if(this._isEnabled){var r={command:this,source:t};this._numTimesExecuted++,this._broadcast("onExecute",[e,r])}},setState:function(e){this._setEnabled(!!e)},enable:function(){this._setEnabled(!0)},disable:function(){this._setEnabled(!1)},isEnabled:function(){return this._isEnabled},_broadcast:function(e,t){var r=this._listeners.length;this._broadcasting=!0;for(var i=0;r>i;++i)try{var n=this._listeners[i],s=n[e];s&&s.apply(n.listener,t)}catch(o){W.Utils.debugTrace("Exception whlile processing command",this._name,o,o.stack||"")}this._broadcasting=!1,this._cleanupZombies()},_setEnabled:function(e){e=!!e,e!=this._isEnabled&&(this._isEnabled=e,this._broadcastEnabledChanged())},_broadcastEnabledChanged:function(){this._broadcast("onEnabledChanged",[this])},_cleanupZombies:function(){var e;if(!(0>=this._zombies.length)){for(var t=this._zombies.length-1;t>=0;--t)for(var r=this._zombies[t];(e=this._findListenerIndex(r))>=0;)this._listeners.splice(e,1);this._zombies=[]}},_findListenerIndex:function(e,t){for(var r=this._listeners,i=r.length-1;i>=0;--i)if(r[i].listener===e&&(void 0===t||r[i].onExecute===t))return i;return-1}})}),define.Class("bootstrap.managers.commands.Commands",function(e){var t=e;t.inherits("bootstrap.managers.BaseManager"),t.utilize(["bootstrap.managers.commands.Command"]),t.methods({initialize:function(){return this._commandMap={},this._pendingMap={},this.Command=this.imports.Command,this},isReady:function(){return!0},clone:function(e){return this.parent(e)},toString:function(){return"[Commands Manager]"},getCommand:function(e){var t=null;return e&&(t=e instanceof this.Command?e:this._commandMap[e]||null),t},registerCommand:function(e,t){var r=this._commandMap[e];if(r)return t||LOG.reportError(wixErrors.COMMAND_DUPLICATE,"Commands","registerCommand",e),r;r=this.createCommand(e),this._commandMap[e]=r;var i=this._pendingMap[e];if(i){for(var n=0;i.length>n;++n){var s=i[n];r.registerListener(s.listener,s.executeCB,s.changedCB)}delete this._pendingMap[e]}return r},registerCommandAndListener:function(e,t,r,i,n){var s=this.registerCommand(e,n);return s.registerListener(t,r,i),s},executeCommand:function(e,t,r){var i=typeof e;"string"==i&&(e=this.getCommand(e)),e&&e.execute(t,r)},registerCommandListenerByName:function(e,t,r,i){var n=this.getCommand(e);if(n)n.registerListener(t,r,i);else{var s=this._pendingMap[e]||[];s.push({listener:t,executeCB:r,changedCB:i}),this._pendingMap[e]=s}},createCommand:function(e){return new this.Command(e)},unregisterCommand:function(e){var t=this._commandMap[e];t&&(t.dispose(),delete this._commandMap[e])},unregisterListener:function(e){for(var t in this._commandMap){var r=this._commandMap[t];r.unregisterListener(e)}}})}),define.Class("bootstrap.managers.events.Command",function(e){var t=e;t.inherits("bootstrap.managers.events.EventDispatcher"),t.utilize(["bootstrap.managers.commands.Command"]),t.statics({EXECUTE_EVENT_NAME:"execute",STATE_CHANGED_EVENT_NAME:"stateChanged"}),t.methods({initialize:function(e){this._isEnabled=!0,this._name=e,this._numTimesExecuted=0,this._setEventSysId(e)},getNumTimesExecuted:function(){return this._numTimesExecuted},registerListener:function(e,t,r){t&&this.on(this.EXECUTE_EVENT_NAME,e,t),r&&this.on(this.STATE_CHANGED_EVENT_NAME,e,r)},unregisterListener:function(e){var t=this._getObjectId(e);this.injects().Events.removeEventsForListener(this.getEventsSysId(),t)},getName:function(){return this._name},execute:function(e,t){this._isEnabled&&(this._numTimesExecuted++,this.trigger(this.EXECUTE_EVENT_NAME,{passedData:e,source:t}))},enable:function(){this.setState(!0)},disable:function(){this.setState(!1)},setState:function(e){this._isEnabled!=e&&(this._isEnabled=e,this.trigger(this.STATE_CHANGED_EVENT_NAME,{currentState:this._isEnabled}))},isEnabled:function(){return this._isEnabled},isRemovingFromObjectsMapOnlyUponDeath:function(){return!0}})}),define.Class("bootstrap.managers.events.CommandsManager",function(e){var t=e;t.inherits("bootstrap.managers.BaseManager"),t.utilize(["bootstrap.managers.events.Command","bootstrap.managers.events.ElementEventDispatching"]),t.methods({initialize:function(){new this.imports.ElementEventDispatching},isReady:function(){return!0},getCommand:function(e){var t=null;return e&&(t=e instanceof this.imports.Command?e:this.injects().Events.getObjectById(e)||null),t},registerCommand:function(e){var t=this.injects().Events.getObjectById[e];return t?t:new this.imports.Command(e)},registerCommandListener:function(e,t,r,i){var n=this.registerCommand(e);return n.registerListener(t,r,i),n},registerCommandAndListener:function(e,t,r,i){var n=this.registerCommand(e);return n.registerListener(t,r,i),n},executeCommand:function(e,t,r){e=this.getCommand(e),e&&e.execute(t,r)},registerCommandListenerByName:function(e,t,r,i){this.registerCommandAndListener(e,t,r,i)},createCommand:function(e){return new this.Command(e)},unregisterCommand:function(e){var t=this.getCommand(e);t.exterminate()},unregisterListener:function(e){var t=this.injects().Events.getObjectId(e);t&&this.injects().Events.deleteObjectFromMaps(t)},isCommandInstance:function(e){return e instanceof this.imports.Command}})}),define.Class("bootstrap.managers.events.DispatcherToHandlersMap",function(e){var t=e;t.fields({_map:{}}),t.methods({addHandler:function(e,t,r,i,n){var s=this._getWithInitHandlerObjectsForEventType(e,t),o=new this.HandlerObject(r,i,n);return s.push(o),o},isHandlerRegistered:function(e,t,r,i){var n=this._getWithInitHandlerObjectsForEventType(e,t);return n.some(function(e){return e.listenerId==r&&e.handler==i})},HandlerObject:function(e,t,r){this.listenerId=e,this.handler=t,r&&(this.nativeHandler=r)},removeHandler:function(e,t,r,i){var n=this._map[e];if(!n||!n[t])return null;var s=n[t],o=null;return s.eraseWithPredicate(function(e){return e.listenerId===r&&e.handler===i?(o=e,!0):!1}),0===s.length&&delete n[t],0===Object.keys(n).length&&delete this._map[e],o},removeListenerHandlers:function(e,t){var r=this._map[e],i={};for(var n in r){i[n]=[];var s=r[n];s.eraseWithPredicate(function(e){return e.listenerId===t?(i[n].push(e),!0):!1}),0===s.length&&delete r[n]}return i},deleteEntry:function(e){var t=this._map[e];return delete this._map[e],t},getHandlerObjects:function(e,t){var r=this._map[e];return r&&r[t]?r[t]:[]},getAllHandlerObjectsForDispatcher:function(e){var t=this._map[e];if(!t)return[];var r=Object.values(t);return r.flatten()},getAllDispatcherIds:function(){return Object.keys(this._map)},_getWithInitHandlerObjectsForEventType:function(e,t){return this._map[e]||(this._map[e]={}),this._map[e][t]||(this._map[e][t]=[]),this._map[e][t]}})}),define.Class("bootstrap.managers.events.ElementEventDispatching",function(e){function t(e,t,r){var i=t;return r.condition&&(i=function(i){return r.condition.call(e,i)?t(i):!0}),i}function r(e,t,r){var i=null;return r&&(i=2==r?function(r){r=new Event(r,e.getWindow()),t(r)===!1&&r.stop()}:t),i}function i(){var e=W.Events.getAllDispatchingObjectIds().map(function(e){return this._objectsByIds.getObjectById(e)},this);return e.filter(function(e){return"element"==typeOf(e)})}var n=e;n.methods({initialize:function(){[Element,Window,Document].invoke("implement",{$alive:!0,getEventsSysId:function(){return this._getObjectId(this,!1)},_getObjectId:function(e,t){return void 0===e.$alive||e.$alive?W.Events._objectsByIds.getObjectId(e,t):null},on:function(e,i,n){var s=this._getObjectId(i,!0),o=this._getObjectId(this,!0),a=Element.Events[e],l=a&&a.base||e;if(W.Events.isHandlerRegistered(o,l,s,n))return this;var c=function(e){n.call(i,e)};a&&(a.onAdd&&a.onAdd.call(this,n),c=t(this,c,a));var d=Element.NativeEvents[l];return c=r(this,c,d),W.Events.addEventHandler(o,l,s,n,c),this},off:function(e,t,r){var i=this._getObjectId(t,!0),n=this._getObjectId(this,!0),s=Element.Events[e],o=s&&s.base||e;return W.Events.isHandlerRegistered(n,o,i,r)?(s&&s.onRemove&&s.onRemove.call(this,r),W.Events.removeEventHandler(n,o,i,r),this):this},trigger:function(e,t){var r=Element.Events[e],i=r&&r.base||e,n=Element.NativeEvents[i];if(n)this._triggerNativeEvent(i);else{var s=this._getObjectId(this,!0);W.Events.dispatchEvent(s,e,t)}},exterminate:function(){var e=this._getObjectId(this,!0);W.Events.deleteObjectFromMaps(e),this.destroy(),this.$alive=!1},isHandlingEventsWhenNotDisplayed:function(){return!1},addNativeListener:function(e,t){if("unload"==e){var r=t,i=this;t=function(){i.removeNativeListener("unload",t),r()}}return this.addEventListener?this.addEventListener(e,t,!1):this.attachEvent("on"+e,t),this},removeNativeListener:function(e,t){return this.removeEventListener?this.removeEventListener(e,t,!1):this.detachEvent("on"+e,t),this},_triggerNativeEvent:function(e){var t;return document.createEvent?(t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0),!this.dispatchEvent(t)):(t=document.createEventObject(),this.fireEvent("on"+e,t))}}),window.attachEvent&&!window.addEventListener&&window.addNativeListener("unload",function(){i().each(function(e){e.exterminate()}),window.CollectGarbage&&window.CollectGarbage()})}})}),define.Class("bootstrap.managers.events.EventDispatcher",function(e){var t=e;t.traits(["bootstrap.managers.events.TimersHandler"]),t.fields({$alive:!0}),t.methods({initialize:function(){},getEventsSysId:function(){return this._getObjectId(this,!1)},_setEventSysId:function(e){this.injects().Events._objectsByIds.registerObjectId(this,e)},_getObjectId:function(e,t){return void 0===e.$alive||e.$alive?this.injects().Events._objectsByIds.getObjectId(e,t):null},on:function(e,t,r){var i=this._getObjectId(t,!0),n=this._getObjectId(this,!0);return this.injects().Events.addEventHandler(n,e,i,r),this},off:function(e,t,r){var i=this._getObjectId(t),n=this._getObjectId(this,!0);return this.injects().Events.removeEventHandler(n,e,i,r),this},trigger:function(e,t,r){var i=this._getObjectId(this,!0);return this.injects().Events.dispatchEvent(i,e,t,r)},exterminate:function(){this.trigger(Constants.EventDispatcher.Events.EXTERMINATING);var e=this._getObjectId(this,!0);this.injects().Events.deleteObjectFromMaps(e),this.$alive=!1},isHandlingEventsWhenNotDisplayed:function(){return!1},isRemovingFromObjectsMapOnlyUponDeath:function(){return!1}})}),define.Class("bootstrap.managers.events.EventsManager",function(e){var t=e;t.inherits("bootstrap.managers.BaseManager"),t.utilize(["bootstrap.managers.events.DispatcherToHandlersMap","bootstrap.managers.events.ListenerToDispatchersMap","bootstrap.managers.events.ObjectsByIds"]),t.methods({initialize:function(){this._listenersMapping=new this.imports.ListenerToDispatchersMap,this._dispatchersMapping=new this.imports.DispatcherToHandlersMap,this._objectsByIds=new this.imports.ObjectsByIds},isReady:function(){return!0},addEventHandler:function(e,t,r,i,n){if(this._isValidObjectId(e)&&this._isValidObjectId(r)&&!this.isHandlerRegistered(e,t,r,i)){var s=this._dispatchersMapping.addHandler(e,t,r,i,n);return this._addNativeEvent(e,t,n),this._listenersMapping.addHandler(r,e),s}},removeEventHandler:function(e,t,r,i){var n=this._dispatchersMapping.removeHandler(e,t,r,i);return this._listenersMapping.removeHandler(r,e),this._removeNativeEvent(e,t,n.nativeHandler),this._deleteObjectIfPossible(r),this._deleteObjectIfPossible(e),n},removeEventsForListener:function(e,t){var r=this._dispatchersMapping.removeListenerHandlers(e,t);r&&this._removeNativeEvents({dispatcherId:r}),this._listenersMapping.removeListenerHandlers(t,e),this._deleteObjectIfPossible(t),this._deleteObjectIfPossible(e)},isHandlerRegistered:function(e,t,r,i){return this._dispatchersMapping.isHandlerRegistered(e,t,r,i)},dispatchEvent:function(e,t,r,i){var n=this._dispatchersMapping.getHandlerObjects(e,t);n=this._filterInactiveHandlers(n);var s={type:t,data:r,returnedValues:i?[]:void 0,target:this.getObjectById(e),isCustomEvent:!0};return n.forEach(function(e){var t=this.getObjectById(e.listenerId),r=e.handler.call(t,s);i&&void 0!==r&&s.returnedValues.push(r)},this),s},_filterInactiveHandlers:function(e){return e},deleteObjectFromMaps:function(e){var t=this._listenersMapping.getAllDispatcherIdsForListener(e),r={};t.forEach(function(t){r[t]=this._dispatchersMapping.removeListenerHandlers(t,e),this._deleteObjectIfPossible(t)},this);var i=this._dispatchersMapping.getAllHandlerObjectsForDispatcher(e);i.forEach(function(t){this._listenersMapping.removeHandler(t.listenerId,e),this._deleteObjectIfPossible(t.listenerId)},this),r[e]=this._dispatchersMapping.deleteEntry(e),this._listenersMapping.deleteEntry(e),r&&this._removeNativeEvents(r),this._deleteObjectIfPossible(e,!0)},isObjectListensOrDispatchesAnyEvents:function(e){var t=this._listenersMapping.getAllDispatcherIdsForListener(e);if(t&&t.length>0)return!0;var r=this._dispatchersMapping.getAllHandlerObjectsForDispatcher(e);return r&&r.length>0},getAllDispatchingObjectIds:function(){return this._dispatchersMapping.getAllDispatcherIds()},_deleteObjectIfPossible:function(e,t){var r=this.getObjectById(e);if(r){var i=t||!r.isRemovingFromObjectsMapOnlyUponDeath||!r.isRemovingFromObjectsMapOnlyUponDeath();i&&!this.isObjectListensOrDispatchesAnyEvents(e)&&(this._listenersMapping.deleteEntry(e),this._dispatchersMapping.deleteEntry(e),this._deleteObjectFromMap(e))}},_deleteObjectFromMap:function(e){this._objectsByIds.removeObjectById(e)},getObjectById:function(e){return this._objectsByIds.getObjectById(e,!0)},getObjectId:function(e){return this._objectsByIds.getObjectId(e,!1)},_isValidObjectId:function(){return!0},_addNativeEvent:function(e,t,r){if(r){var i=this.getObjectById(e);i.addNativeListener&&i.addNativeListener(t,r)}},_removeNativeEvent:function(e,t,r){if(r){var i=this.getObjectById(e);i.removeNativeListener&&i.removeNativeListener(t,r)}},_removeNativeEvents:function(e){for(var t in e)for(var r in e[t]){var i=e[t][r];i.each(function(e){this._removeNativeEvent(t,r,e.nativeHandler)},this)}}})}),define.Class("bootstrap.managers.events.ListenerToDispatchersMap",function(e){var t=e;t.fields({_map:{}}),t.methods({addHandler:function(e,t){this._map[e]||(this._map[e]={});var r=this._map[e];r[t]?r[t]++:r[t]=1},removeHandler:function(e,t){var r=this._map[e];r&&r[t]&&(r[t]--,0===r[t]&&delete r[t],0===Object.keys(r).length&&delete this._map[e])},removeListenerHandlers:function(e,t){this._map[e]&&delete this._map[e][t]},deleteEntry:function(e){this._map[e]&&delete this._map[e]},getAllDispatcherIdsForListener:function(e){return this._map[e]?Object.keys(this._map[e]):[]}})}),define.Class("bootstrap.managers.events.ObjectsByIds",function(e){var t=e;t.fields({_objectIdsMap:{},_OBJECT_ID_PROPERTY:"$id"}),t.methods({initialize:function(){},getObjectId:function(e,t){var r=e[this._OBJECT_ID_PROPERTY];return r||(r=this.injects().Utils.getGUID(),e[this._OBJECT_ID_PROPERTY]=r),!this.getObjectById(r)&&t&&(this._objectIdsMap[r]=e),r},registerObjectId:function(e,t){return e[this._OBJECT_ID_PROPERTY]=t,this._objectIdsMap[t]=e,e},getObjectById:function(e){return this._objectIdsMap[e]},removeObjectById:function(e){this._objectIdsMap[e]&&delete this._objectIdsMap[e]}})}),define.Class("bootstrap.managers.events.TimersHandler",function(e){var t=e;t.fields({_timerTypes:{timeout:1,interval:2},_timers:{}}),t.methods({initialize:function(){this.on("exterminating",this,this._clearAllTimers)},setTimeout:function(e,t){var r=t||0,i=this._getExecutingFunction(e,this._timerTypes.timeout),n=window.setTimeout(i,r);return i.timerId=n,this._timers[n]={type:this._timerTypes.timeout,isActive:!0},n},setInterval:function(e,t){var r=this._getExecutingFunction(e,this._timerTypes.interval),i=window.setInterval(r,t);return r.timerId=i,this._timers[i]={type:this._timerTypes.interval,isActive:!0},i},isActiveTimer:function(e){return this._timers[e]&&this._timers[e].isActive},_getExecutingFunction:function(e,t){var r=this;return function(){var i=arguments.callee&&arguments.callee.timerId;i&&t==r._timerTypes.timeout&&r._timers[i]&&(r._timers[i].isActive=!1),e.call(r)}},_clearAllTimers:function(){Object.each(this._timers,function(e,t){t=Number(t),e.type==this._timerTypes.timeout?window.clearTimeout(t):e.type==this._timerTypes.interval&&window.clearInterval(t)},this)}})}),define.Const("EventDispatcher",{Events:{EXTERMINATING:"exterminating"}}),define.experimentPlugin("ExperimentConstantsPlugin",function(e){function t(e,t){var r=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy");t[r.STRATEGY_FLAG]=r.MERGE;var i=r._mergeField_(e,t);return i}function r(e,t){define.Const(e,t)}var i=e;i.init("Const","newConst",t,r)}),define.bootstrapClass("bootstrap.managers.experiments.ExperimentPlugin",function(){function e(){}return e.extendPrototype({init:function(e,t,r,i){return this._modifyNamespace=e,this._newNamespace=t,this._mergeSingleExperiment=r,this.convertNew=i,this},setRunningExperimentsOrder:function(e){this._runningExperiments=e,this._runningExperimentsObj={};for(var t=0;this._runningExperiments.length>t;t++){var r=this._runningExperiments[t];this._runningExperimentsObj[r.id]=r}var i=this.define.getDefinition("experiment",this._newNamespace);i&&nsUtil.forEachLeaf(i,function(e,t){this._experimentDefined(t,e)}.bind(this)),this.define.experiment[this._newNamespace].definitionModifier=this._experimentDefined.bind(this),this.define.experiment[this._newNamespace].nameModifier=this._experimentNameDefined.bind(this),this.define.experiment[this._modifyNamespace].nameModifier=this._experimentNameDefined.bind(this)},_experimentNameDefined:function(e){var t=this._getExperimentInfo(e);return t.definitionName+"."+t.experimentName+"."+t.group},_experimentDefined:function(e,t){var r=this._getExperimentInfo(e),i=r.experimentName.toLowerCase();return this._runningExperimentsObj[i]&&this._runningExperimentsObj[i].group===r.group&&this.convertNew(r.definitionName,t),t},convertNew:function(){throw Error("Invalid ExperimentPlugin: convertNew method not set. Use init to override it",this)},_mergeSingleExperiment:function(){throw Error("Invalid ExperimentPlugin: runExperiment method not set. Use init to override it",this)},applyExperiments:function(e,t){var r=this._modifyNamespace+"."+e,i=this.define.getDefinition("experiment",r);if(i=this.loadedExperimentsToLower(i))for(var n=0;this._runningExperiments.length>n;++n){var s=this._runningExperiments[n];if(i[s.id]&&i[s.id][s.group]){var o=i[s.id][s.group];t=this._mergeSingleExperiment(t,o)}}return t},loadedExperimentsToLower:function(e){var t={};for(var r in e){var i=r.toLowerCase();t[i]={};for(var n in e[r]){var s=n.toLowerCase(),o=e[r][n];t[i][s]=o}}return t},_getExperimentInfo:function(e){var t=e.split("."),r=t.pop(),i=t.pop(),n=t.join(".");return{group:r.toLowerCase(),experimentName:i.toLowerCase(),definitionName:n}}}),e}),define.bootstrapClass("bootstrap.managers.experiments.ExperimentStrategy",function(){function e(){}return e.extendPrototype({init:function(){return this},STRATEGY_FLAG:"experimentStrategy",BEFORE:"before",AFTER:"after",AROUND:"around",MERGE:"merge",DELETE:"delete",CUSTOM:"customField",before:function(e){if("function"!=typeof e)throw Error("before must be on a method");return e[this.STRATEGY_FLAG]=this.BEFORE,e},after:function(e){if("function"!=typeof e)throw Error("after must be on a method");return e[this.STRATEGY_FLAG]=this.AFTER,e},around:function(e){if("function"!=typeof e)throw Error("around must be on a method");return e[this.STRATEGY_FLAG]=this.AROUND,e},merge:function(e){var t=function(){return e};return t[this.STRATEGY_FLAG]=this.MERGE,t},remove:function(e){var t=function(){return e};return t[this.STRATEGY_FLAG]=this.DELETE,t},customizeField:function(e){if("function"!=typeof e)throw Error("custom must be on a method");return e[this.STRATEGY_FLAG]=this.CUSTOM,e},_mergeObjects_:function(e,t){e=e||{};var r=Object.clone(e);for(var i in t){var n=t[i],s=e[i];r[i]=this._mergeSingleObject(n,s),this._isDeleteFieldObj(r[i])&&delete r[i]}return r},_mergeSingleObject:function(e,t){var r;return r="function"==typeof e&&this._isMethodStrategy(e)?this._resolveMethod(t,e):"function"==typeof e&&this._isFieldStrategy(e)?this._mergeField_(t,e):e},_isMethodStrategy:function(e){var t=e[this.STRATEGY_FLAG];return t&&(t===this.AFTER||t===this.BEFORE||t===this.AROUND)},_isFieldStrategy:function(e){var t=e[this.STRATEGY_FLAG];return t&&(t===this.MERGE||t===this.DELETE||t===this.CUSTOM)},_resolveMethod:function(e,t){var r;if(!e){if(t[this.STRATEGY_FLAG])throw Error("cannot "+t[this.STRATEGY_FLAG]+" if original method is not defined");return t}switch(t[this.STRATEGY_FLAG]){case this.BEFORE:r=function(){return t.apply(this,arguments),e.apply(this,arguments)};break;case this.AFTER:r=function(){var r=e.apply(this,arguments);return t.apply(this,arguments),r};break;case this.AROUND:r=function(){var r,i=!1,n=this,s=Array.prototype.splice.call(arguments,0);s.splice(0,0,function(){return i=!0,e.apply(n,s.slice(1))});var r=t.apply(this,s);return i||LOG.reportError(wixErrors.EXPERIMENT_INVALID_MODIFY,""+t,"",s.slice(1)),r};break;default:r=t}return e.$wrapperFunction=r,r},_mergeField_:function(e,t){if(this._isEmpty(e))return t;if(this._isEmpty(t))return e;var r=t[this.STRATEGY_FLAG]==this.MERGE||!1,i=t[this.STRATEGY_FLAG]==this.DELETE||!1,n=t[this.STRATEGY_FLAG]==this.CUSTOM||!1;return n?(delete t[this.STRATEGY_FLAG],t=t(e)):"function"==typeof t&&(t=t()),r?(delete t[this.STRATEGY_FLAG],this._combine(e,t)):i?this._getFieldDeleteObj():t},_getFieldDeleteObj:function(){return{_delete_:!0}},_isDeleteFieldObj:function(e){return e&&e._delete_===!0},_isEmpty:function(e){return e?e instanceof Array&&0===e.length?!0:"object"==typeof e&&0===Object.getLength(e)?!0:!1:!0},_combine:function(e,t){if(e instanceof Array&&t instanceof Array)for(var r=0;t.length>r;++r){var i=t[r];this._elementExistsInArray(i,e)||e.push(i)}else if("object"==typeof e&&"object"==typeof t)for(var n in t)e[n]="object"==typeof e[n]&&"object"==typeof t[n]||e[n]instanceof Array&&t[n]instanceof Array?this._combine(e[n],t[n]):t[n];return e},_elementExistsInArray:function(e,t){for(var r=0;t.length>r;r++)if(this._areEqual(t[r],e))return!0;return!1},_areEqual:function(e,t){return"object"==typeof e&&"object"==typeof t?this._areObjectsEqual(e,t):e instanceof Array&&t instanceof Array?this._areArraysEqual(e,t):e!==t?!1:!0},_areObjectsEqual:function(e,t){var r;for(var i in e)if(r=this._areEqual(e[i],t[i]),!r)return!1;return!0},_areArraysEqual:function(e,t){var r;if(e.length!==t.length)return!1;for(var i=0;e.length>i;i++)if(r=this._areEqual(e[i],t[i]),!r)return!1;return!0}}),e}),define.bootstrapClass("bootstrap.managers.experiments.Experiments",function(){function e(){this._plugins=[],this._pluginsMap={}}return e.extendPrototype({init:function(e,t){var r=this;return this.resource.getResources(["runningExperiments","experimentsOrder"],function(i){var n=r._getRunningExperimentsFromUrl();window.rendererModel&&"preview"===window.viewMode&&window.top&&window.top.hacks&&window.top.hacks.hasNewTextComponent&&(window.rendererModel.runningExperiments.richtext="new"),r._runningExperiments=r._getCombinedNormalizedExperimentList(e||i.runningExperiments,n),r._experimentsOrder=t||i.experimentsOrder,r._buildModelForApps(),r.normalizeExperimentLists(),r._runningExperimentsOrder=r.getOrderedRunningExperiments();var s=this.define.getDefinition("experimentPlugin");for(var o in s)r._addPlugin(o,s[o]);r.define.experimentPlugin.definitionModifier=r._onExperimentPluginDefined.bind(r)}),this},_getCombinedNormalizedExperimentList:function(e,t){var r=Object.clone(e),i=this._experimentsToLowerCase(t),n=this._experimentsToLowerCase(r);return Object.merge(n,i),n},_experimentsToLowerCase:function(e){var t,r={};for(var i in e)t=i.toLowerCase(),r[t]=e[i].toLowerCase();return r},_getRunningExperimentsFromUrl:function(){var e={},t=window.location.search.substring(1);if(!t)return e;t=decodeURIComponent(t);for(var r=t.split("&"),i=0;r.length>i;i++){var n=r[i].split("=");if("experiment"===n[0].toLowerCase()){var s=n[1].split(":"),o=s[0].toLowerCase(),a=s[1].toLowerCase();e[o]=a}}return e},normalizeExperimentLists:function(){var e,t,r,i,n,s,o,a={};for(var l in this._runningExperiments)e=l.toLowerCase(),t=this._runningExperiments[l].toLowerCase(),a[e]=t;this._isInDevMode()&&this._isInEditor()&&(a.dev="new");for(var c=[],d=0;this._experimentsOrder.length>d;d++){o=this._experimentsOrder[d],e=o.id.toLowerCase(),t=o.group.toLowerCase(),r=o.description,s=o.owner,i=[];for(var u=0;o.dependencies.length>u;u++)i.push(o.dependencies[u].toLowerCase());n=[];for(var p=0;o.conflicts.length>p;p++)n.push(o.conflicts[p].toLowerCase());c.push({id:e,group:t,description:r,dependencies:i,conflicts:n,owner:s})}this._runningExperiments=a,this._experimentsOrder=c},_buildModelForApps:function(){var e={},t=this._isInEditor()?editorModel:rendererModel;for(var r in this._runningExperiments)this._isAppsExperiment(r)&&(e[r]=this._runningExperiments[r],delete t.runningExperiments[r]);t.runningApps=e},_isAppsExperiment:function(e){var t=/^App~\w{1,}~\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/i;return t.test(e)},_isLanguageExperiment:function(e){var t=/^Lang_[a-z]{2,}/i;return t.test(e)||"MultiLang"==e},_isFlagExperiment:function(e){var t=/^FLAG_/i;return t.test(e)},_isInDevMode:function(){return"nodebug"!==window.debugMode&&"unit_test"!==window.debugMode},_isInEditor:function(){return"editor"===viewMode},applyExperiments:function(e,t){for(var r=0;this._plugins.length>r;++r)t=this._plugins[r].applyExperiments(e,t);return t},_onExperimentPluginDefined:function(e,t){this._addPlugin(e,t)},_addPlugin:function(e,t){var r=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentPlugin");t(r),r.setRunningExperimentsOrder(this._runningExperimentsOrder),this._pluginsMap[e]=r,this._plugins.push(r)},getOrderedRunningExperiments:function(){for(var e=[],t=0;this._experimentsOrder.length>t;++t){var r=Object.clone(this._experimentsOrder[t]);this._runningExperiments[r.id],this._isExperimentRunningAndValid(r)&&e.push(r)}return e},_isExperimentRunningAndValid:function(e){var t=e.id,r=e.dependencies,i=e.conflicts,n=this._runningExperiments[t];if(n&&e.group===n){for(var s=0;r.length>s;s++){var o=r[s];if(!this._runningExperiments[o])return LOG.reportError(wixErrors.EXPERIMENT_MISSING_DEPENDENCY,"dependency: "+o+" is missing (for experiment: "+t+")"),!1}for(var a=0;i.length>a;a++){var l=i[a];if(this._runningExperiments[l])return LOG.reportError(wixErrors.EXPERIMENT_IN_CONFLICT,"in conflict with: "+l+" (for experiment: "+t+")"),!1}return!0}return!1},isReady:function(){return void 0!==this._runningExperimentsOrder},isDeployed:function(e){var t,r=!1;for(t in e){var i=e[t].toLowerCase();if(t=t.toLowerCase(),!this._runningExperiments.hasOwnProperty(t)||this._runningExperiments[t]!==i){r=!1;break}r=!0}return r},_getExperimentsOrder_:function(){return this._experimentsOrder},_getExperimentInfo_:function(e){if(!this.experimentInfoObj){this.experimentInfoObj={};for(var t=0;this._experimentsOrder.length>t;t++){var r=this._experimentsOrder[t];this.experimentInfoObj[r.id]||(this.experimentInfoObj[r.id]={}),this.experimentInfoObj[r.id][r.group]={description:r.description,dependencies:r.dependencies,conflicts:r.conflicts,owner:r.owner}}}return this.experimentInfoObj[e]},_getRunningExperimentsOrder_:function(){return this._runningExperimentsOrder},clone:function(e){var t=e.createBootstrapClassInstance("bootstrap.managers.experiments.Experiments",[this._runningExperiments,this._experimentsOrder]);return t}}),e}),define.Class("bootstrap.utils.BufferFunction",function(e){var t=e;t.binds(["_wrapperFunction"]),t.methods({initialize:function(e,t){this._isFirstCallDelayed=!1,this._bufferTime=1e3,this._lastCallArguments,this._replaceFunctionAndSaveOriginal(e,t),this._clearBuffer()},setBufferTime:function(e){this._bufferTime=e},getBufferTime:function(){return this._bufferTime},setIsFirstCallDelayed:function(e){this._isFirstCallDelayed=e},getIsFirstCallDelayed:function(){return this._isFirstCallDelayed},_replaceFunctionAndSaveOriginal:function(e,t){this._scope=e,this._originalFunction=e[t],e[t]=this._wrapperFunction},_wrapperFunction:function(){this._lastCallArguments=arguments,this._tryCallingFunction()},_tryCallingFunction:function(){this.isReadyToCall()?(this.callOriginalFunction(),this._delayCall(this._clearBuffer)):this._delayCall(this._clearBufferAndTryCallingFunction)},callOriginalFunction:function(){this._originalFunction.apply(this._scope,this._lastCallArguments)},isReadyToCall:function(){return!this._callTimerId&&this._isFirstCallDelayed===!1},_clearBuffer:function(){this._callTimerId=void 0},_clearBufferAndTryCallingFunction:function(){this._clearBuffer(),this._tryCallingFunction()},_delayCall:function(e){this.injects().Utils.clearCallLater(this._callTimerId),this._callTimerId=this.injects().Utils.callLater(e,[],this,this._bufferTime)}})}),define.Class("bootstrap.utils.Events",function(e){var t=e;t.methods({addEvent:function(e,t){return e=this._removeOn(e),this.$events=this.$events||{},this.$events[e]=(this.$events[e]||[]).include(t),this},addEvents:function(e){for(var t in e)this.addEvent(t,e[t]);return this},fireEvent:function(e,t,r){if(this.$events){e=this._removeOn(e);var i=this.$events[e];if(!i)return this;t=Array.from(t);var n=i.clone();n.each(function(e){e&&(r?e.delay(r,this,t):e.apply(this,t))},this)}return this},removeEvent:function(e,t){if(this.$events){e=this._removeOn(e);var r=this.$events[e];if(r)if(t){var i=r.indexOf(t);-1!=i&&(r.splice(i,1),0===r.length&&delete this.$events[e])}else delete this.$events[e]}return this},removeEvents:function(e){var t;if("object"==typeOf(e)){for(t in e)this.removeEvent(t,e[t]);return this}e&&(e=this._removeOn(e));for(t in this.$events)if(!e||e==t)for(var r=this.$events[t],i=r.length;i--;)this.removeEvent(t,r[i]);return this},_removeOn:function(e){return e.replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})},removeAllEvents:function(){this.$events={}}})}),define.Class("bootstrap.utils.LinkUtils",function(e){var t=e;t.resources(["W.Commands"]),t.statics({linkType:{SMS:"SMS",CALL:"CALL",SKYPE:"SKYPE",MAP:"MAP",EMAIL:"EMAIL",FACEBOOK:"FACEBOOK",FLICKR:"FLICKR",BLOGGER:"BLOGGER",MYSPACE:"MYSPACE",LINKEDIN:"LINKEDIN",TWITTER:"TWITTER",TUMBLR:"TUMBLR",YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",PAGE:"PAGE",FREE_LINK:"FREE_LINK",TEXT:"TEXT",DELICIOUS:"DELICIOUS",WEBSITE:"WEBSITE",DOCUMENT:"DOCUMENT",LOGIN:"LOGIN"},linkTarget:{SAME_WINDOW:"_self",NEW_WINDOW:"_blank"}}),t.methods({linkifyElement:function(e,t,r,i){this._fixTargetBug(r);var n=r.get("href"),s=r.get("target"),o=r.get("linkType");if(n&&s||"LOGIN"===o||"ADMIN_LOGIN"===o){if(this._createLink(e,t,o,n,s),this._setLinkState(e),i===!0&&this._disableLinkClickPropagation(t),"LOGIN"===o||"ADMIN_LOGIN"===o){var a=e._highlightedDisplayer.getLogic();this._handleSpecialCases(a,o,t)}}else this._removeLinkstate(e),t.set("href",""),t.setStyle("cursor","default"),t.set("target",""),t.removeEvents("click")},_createLink:function(e,t,r,i,n){var s="PREVIEW"==W.Viewer.getEditorMode(),o="_self"===n&&"WEBSITE"===r;s&&o?this._bindPageLeaveWarningToLink(e,t):(t.set("href",i),t.setStyle("cursor","pointer"),t.set("target",n),t.removeEvents("click"))},_setLinkState:function(e){e.hasState("noLink","linkableComponent")&&e.removeState("noLink","linkableComponent")},_removeLinkstate:function(e){e.hasState("noLink","linkableComponent")&&e.setState("noLink","linkableComponent")},_fixTargetBug:function(e){var t=e.get("target");("same"==t||"self"==t)&&(t="_self",e.set("target","_self"))},_disableLinkClickPropagation:function(e){e.addEvent("click",function(e){e.stopPropagation()})},_bindPageLeaveWarningToLink:function(e,t){t.erase("href"),t.erase("target"),t.addEvent("click",function(t){t.preventDefault(),this._showNavigationDisabledTooltip(e)}.bind(this))},_showNavigationDisabledTooltip:function(e){var t={component:e};
this.resources.W.Commands.executeCommand("linkableComponent.navigateSameWindow",t,e)},_handleSpecialCases:function(e,t,r){switch(r.removeEvents("click"),t){case this.linkType.LOGIN:r.addEvent("click",function(){if(window.animateForm){var e=this.getDataItem(),t=e.get("text");if(t){t=JSON.parse(t);var r=t.postLoginUrl,i=t.postSignupUrl,n=t.type,s="HTML",o=window.userApi?window.userApi.isSessionValid():!1;o?r&&(window.location.href=r):window.animateForm.callOnContent([i,r,n,s])}}}.bind(e));break;case this.linkType.ADMIN_LOGIN:r.setStyle("cursor","pointer"),r.addEvent("click",function(){this.resources.W.Commands.executeCommand("WViewerCommands.AdminLogin.Open")}.bind(e))}}})}),define.Class("bootstrap.utils.Que",function(e){"use strict";e.binds(["_next"]),e.methods({initialize:function(e){e=e||{},this.processContext=e.processContext||this,this.active=!1,this.timeoutTicket=null,this.items=e.items||[],this.outputRate=e.outputRate||100,this.outputChunkSize=e.outputChunkSize||1,this.onprocess=null,this.setProcess(e.onprocess)},_next:function(){for(var e=Math.min(this.outputChunkSize,this.size()),t=0;e>t;t++)this.onprocess.call(this.processContext,this.items.shift(),t);this.size()?this.timeoutTicket=setTimeout(this._next,this.outputRate):this.stop()},size:function(){return this.items.length},start:function(){this.active||(this.stop(),this.active=!0,this.timeoutTicket=setTimeout(this._next,this.outputRate))},stop:function(){this.active&&(this.active=!1,clearTimeout(this.timeoutTicket))},clear:function(){this.stop(),this.items.length=0},add:function(){var e=this.items.push;e.apply(this.items,arguments),this.start()},silentAdd:function(){var e=this.items.push;e.apply(this.items,arguments)},addArray:function(){},setProcess:function(e){this.onprocess=e||function(){}}})}),define.Class("bootstrap.utils.Queue",function(e){var t=e;t.methods({initialize:function(){this.map={}},add:function(e,t){this.map[e]=this.map[e]||[],this.map[e].push(t)},addUnique:function(e,t){this.map[e]=this.map[e]||[];for(var r=!0,i=0;this.map[e].length>i;i++)if(this.map[e][i]===t){r=!1;break}r&&this.map[e].push(t)},remove:function(e,t){this.map[e]&&this.map[e].erase(t)},removeKey:function(e){delete this.map[e]},removeAll:function(){this.map={}},getQueue:function(e){return this.map[e]||[]},getQueueKeys:function(){return Object.keys(this.map)},hasQueue:function(e){return e?Object.some(this.map,function(t,r){return r===e})||!1:Object.some(this.map,function(){return!0})},popQueue:function(e){var t=this.getQueue(e);return this.removeKey(e),t},isReady:function(){return!0},clone:function(){return this}})}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),define.oldClass({name:"bootstrap.utils.Tween",Class:{Static:{_activeTweens:[],killAll:function(){for(;this._activeTweens.length>0;)this.killTween(this._activeTweens[0])},killTweensOf:function(e){var t=[];this._activeTweens.forEach(function(r){r._target===e&&t.push(r)}),t.forEach(function(e){"function"==typeof this.killTween&&this.killTween(e)})},killTween:function(e){var t;e.dispose(),t=this._activeTweens.indexOf(e),-1!=t&&this._activeTweens.splice(t,1)},_startTween:function(){this.killTweensOf(this._target),this._activeTweens.push(this),this._t0=this._getCurrentTime(),window.requestAnimFrame(this._render.bind(this))},debugMode:!1,log:function(){},to:function(e,t,r){var i=this;new i(e,t,r)},execute:function(e,t,r,i){i.myProp=t;var n=this;new n({myProp:e},r,i)}},initialize:function(e,t,r){var i,n;this._target=e,this._duration=Math.floor(1e3*t),this._easeParams=[],this._t=0,this._tStep=null,this._isAlive=!0;var s="element"==typeOf(e);this._setValueFunc=s?this._setStyle:this._setTargetProperty,this._easeFunc=this.linear;var o=this._parseParameter(r,"ease","linear");void 0!==this[o]&&"function"==typeOf(this[o])&&(this._easeFunc=this[o]),this._onCompleteCallback=this._parseParameter(r,"onComplete",null),this._onUpdateCallback=this._parseParameter(r,"onUpdate",null);var a=this._parseParameter(r,"delay",0);for(var l in r)(s||void 0!==e[l])&&(i={},i.propName=l,s?(n=e.getStyle(l),i.origValue=parseFloat(n),i.unit=this._parseUnit(n),isNaN(i.origValue)&&(i.origValue=0,i.unit="px")):i.origValue=parseFloat(e[l]),i.targetValue=parseFloat(r[l]),this._easeParams.push(i));0===a?this._startTween():(a=parseInt(1e3*a,10),setTimeout(this._startTween.bind(this),a))},_parseUnit:function(e){var t=/[^0-9-]+$/;return t.test(e)===!0?(e+"").match(t)[0]+"":""},_parseParameter:function(e,t,r){var i;return void 0!==e[t]?(i=e[t],delete e[t]):i=r,i},_render:function(){var e,t;if(this._isAlive){var r=this._getCurrentTime();this._tStep=r-this._t0,this._t0=r,this._t+=this._tStep;for(var i=0;this._easeParams.length>i;i++)e=this._easeParams[i],t=this._t<this._duration?this._easeFunc(this._t,0,1,this._duration)*(e.targetValue-e.origValue)+e.origValue:e.targetValue,this.debugMode===!0&&this.log(this._tStep,this._t,t),e.unit&&"px"==e.unit&&(t=Math.round(t)),this._setValueFunc(e.propName,t,e.unit),null!==this._onUpdateCallback&&this._onUpdateCallback(t,this._target,e.propName);this._t<this._duration?window.requestAnimFrame(this._render.bind(this)):(null!==this._onCompleteCallback&&this._onCompleteCallback(this),this.killTween(this))}},_getCurrentTime:function(){return(new Date).getTime()},_setStyle:function(e,t,r){this._target.setStyle(e,t+""+r)},_setTargetProperty:function(e,t){this._target[e]=t},dispose:function(){this._isAlive=!1,this._target=null,this._onCompleteCallback=null,this._onUpdateCallback=null},linear:function(e,t,r,i){return r*e/i+t},strong_easeIn:function(e,t,r,i){return r*(e/=i)*e*e*e*e+t},strong_easeOut:function(e,t,r,i){return r*((e=e/i-1)*e*e*e*e+1)+t},strong_easeInOut:function(e,t,r,i){return 1>(e/=.5*i)?.5*r*e*e*e*e*e+t:.5*r*((e-=2)*e*e*e*e+2)+t},swing:function(e,t,r,i){return-Math.cos(this.linear(e,t,r,i)*Math.PI)/2+.5}}}),define.bootstrapClass("bootstrap.utils.Utils",function(){function e(){}return e.extendPrototype({init:function(){var e=this;this._mergeDefinitions(),this.define.utils.definitionModifier=function(t,r){e._mergeDefinition(t,r)},this._prefixCounterMap={}},_mergeDefinitions:function(){var e=this.define.getDefinition("utils");for(var t in e)this._mergeDefinition(t,e[t])},_mergeDefinition:function(t,r){"this"===t.split(":").pop()?e.extendPrototype(r()):this._mergeToUtils(t,r)},_mergeToUtils:function(t,r){var i=r(),n={};n[t]=i,e.extendPrototype(n)},clone:function(){return this},isReady:function(){return!0}}),e}),define.bootstrapClass("bootstrap.utils.async.Async",function(){var e=define.getBootstrapClass("bootstrap.bootstrap.WClass"),t=new e({className:"Async",initialize:function(){}});return t.Bulk=new e({className:"Async.Bulk",Implements:[Options,Events],Binds:["run"],options:{completeEvent:"complete",errorEvent:"error",completeCallback:null,errorCallback:null,parallel:!0,specialTargets:[{target:null,method:null,completeEvent:null,errorEvent:null}],executeDelay:!1,keepAlive:!1,stopOnErrors:!0,timeout:0},_method:null,_pending:[],_running:!1,_error:[],_complete:[],_done:[],initialize:function(e,t,r){if(!e||void 0===e.length)return LOG.reportError(wixErrors.BULK_INVALID_TARGET,"Async.Bulk","initialize",e)(),this;this.$events={},this.setOptions(r),this._targets=e,this._method=t;var i=this,n=window;this.options.timeout>0&&(this._timeoutInterval=n.setTimeout(this._bulkOperationTimeout.bind(this),this.options.timeout)),this._onTargetComplete=function(){this.removeEvent(i._getTargetDetails(this).completeEvent,i._onTargetComplete),i._pending.erase(this),i._complete.push(this),i._done.push(this),i._checkProgress()},this._onTargetFailed=function(){this.removeEvent(i._getTargetDetails(this).errorEvent,i._onTargetFailed),i._pending.erase(this),i._error.push(this),i._done.push(this),i._checkProgress()},this.options.executeDelay?instanceOf(this.options.executeDelay,Number)&&this.options.executeDelay>0&&n.setTimeout(this.run,this.options.executeDelay):this.run()},_bulkOperationTimeout:function(){LOG.reportError(wixErrors.BULK_TIMEOUT,"Async.Bulk","_bulkOperationTimeout",this.options.timeout+""+" ms | Pending Operations:"+this._pending)()},run:function(){return void 0!==this._targets.length&&null!==this._targets.length&&0===this._targets.length?(this._clearInterval(),this._handleBulkComplete(),void 0):(this._targets.each(function(e,t){this._addToQue(e,t)},this),this.options.parallel?this._targets.each(this._runMethodOnTarget,this):this._runNextTarget(),void 0)},_runNextTarget:function(){var e=this._targets.length-this._pending.length,t=this._targets[e];this._runMethodOnTarget.apply(this,[t])},_clearInterval:function(){this._timeoutInterval&&(clearInterval(this._timeoutInterval),delete this._timeoutInterval)},_runMethodOnTarget:function(e){instanceOf(this._method,Function)&&this._method.call(e),instanceOf(this._method,String)&&(instanceOf(e[this._method],Function)?e[this._method].call(e):LOG.reportError(wixErrors.BULK_NO_METHOD,"Async.Bulk","_runMethodOnTarget",e)())},stop:function(){},destroy:function(){this._targets&&this._targets.each(function(e){e.removeEvent(this._getTargetDetails(this).completeEvent,this._onTargetComplete),e.removeEvent(this._getTargetDetails(this).errorEvent,this._onTargetFailed)},this),this._targets=null},progress:function(){return{complete:this._complete.slice(),error:this._error.slice(),total:this._targets.slice()}},_addToQue:function(e,t){var r=this._getTargetDetails(e);this._pending[t]=e,e.addEvent(r.completeEvent,this._onTargetComplete),e.addEvent(r.errorEvent,this._onTargetFailed)},_onTargetComplete:void 0,_onTargetFailed:void 0,_getTargetDetails:function(e){var t,r,i={method:this._method,completeEvent:this.options.completeEvent,errorEvent:this.options.errorEvent};for(t=0,r=this.options.specialTargets.length;r>t;t++)if(this.options.specialTargets[t].target===e)return this.options.specialTargets[t].target.implement(i);return i},_checkProgress:function(){this._pending.length>0?this.options.parallel||this._runNextTarget():(this.options.stopOnErrors&&this._error.length>0?this._handleBulkError():this._handleBulkComplete(),this._clearInterval(),this.options.keepAlive||this.destroy())},_handleBulkError:function(e){e?(this.fireEvent("error",[this._complete,this._error]),instanceOf(this.options.errorCallback,Function)&&this.options.errorCallback(this._complete,this._error)):window.setTimeout(this._handleBulkError.bind(this,!0),1)},_handleBulkComplete:function(e){e?(this.fireEvent("complete",[this._complete,this._error]),instanceOf(this.options.completeCallback,Function)&&this.options.completeCallback(this._complete,this._error)):window.setTimeout(this._handleBulkComplete.bind(this,!0),1)}}),t}),define.utils("analytics:this",function(){return{_sendURLtoGoogleAnalytics:function(e,t){e._trackPageview(t)},_getGoogleAnalyticsTracker:function(e){return window._gat?(pageTracker=_gat._getTracker(e),pageTracker._initData(),pageTracker):void 0},reportSiteAnalytics:function(e,t){var r="UA-2117194-25",i="site",n=i+"/"+e;t&&(n=n+"/"+t),this.sendToGoogleAnalytics(n,r)},reportEditorAnalytics:function(e,t){var r="UA-2117194-23",i="editor",n=i+"/"+e;t&&(n=n+"/"+t),window.siteHeader&&(window.siteHeader.username&&(n=n+"/"+siteHeader.username),window.siteHeader.siteName&&(n=n+"/"+siteHeader.siteName)),this.sendToGoogleAnalytics(n,r)},sendToGoogleAnalytics:function(e,t){try{if(window._gat){var r=this._getGoogleAnalyticsTracker(t);return this._sendURLtoGoogleAnalytics(r,e,t),void 0}var i="https:"==document.location.protocol?"https://ssl.":"http://www.",n=new Element("script",{id:"googleAnalyticsScript"}),s=document.getElementsByTagName("script")[0];n.type="text/javascript",s.parentNode.insertBefore(n,s),n.src=i+"google-analytics.com/ga.js",this.gaCheck(e,t)}catch(o){}},gaCheck:function(e,t){try{if(window._gat){var r=this._getGoogleAnalyticsTracker(t);this._sendURLtoGoogleAnalytics(r,e)}else setTimeout(this.gaCheck.bind(this,e,t),1e3)}catch(i){}}}}),define.utils("browser:this",function(){return{show:function(e){$(e).uncollapse()},hide:function(e){$(e).collapse()},setChildIndex:function(e,t,r){var i=e.getChildren(),n=i[t],s=i[r];n==s&&n.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM),n&&s&&(n.inject(s,t>r?"before":"after"),n.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM),s.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM))},waitForElement:function(e,t,r,i){var n=0,s=r/t,o=setInterval(function(){n++,n>s&&(clearInterval(o),i(!1));var t=$$(e).length;t>0&&(clearInterval(o),i(!0))},t)},getComputedStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle},_htmlTextReplacements:[["<","&lt;"],[">","&gt;"]],convertToHtmlText:function(e){e=""+e;for(var t=0;this._htmlTextReplacements.length>t;++t)for(var r=this._htmlTextReplacements[t][0],i=this._htmlTextReplacements[t][1];-1!=e.indexOf(r);)e=e.replace(r,i);return e},convertFromHtmlText:function(e){for(var t=0;this._htmlTextReplacements.length>t;++t)for(var r=this._htmlTextReplacements[t][0],i=this._htmlTextReplacements[t][1];-1!=e.indexOf(i);)e=e.replace(i,r);return e},getWindowSize:function(){var e,t;if(window.innerWidth!==void 0)e=window.innerWidth,t=window.innerHeight;else if(document.documentElement!==void 0&&document.documentElement.clientWidth!==void 0&&0!==document.documentElement.clientWidth)e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;else{var r=document.getElementsByTagName("body")[0];e=r.clientWidth,t=r.clientHeight}return{width:e,height:t}},getPositionRelativeToWindow:function(e){if(!$$(e).length)return{x:0,y:0};var t=$$(e)[0],r=t.getPosition(),i=window.getScroll();return r.x-=i.x,r.y-=i.y,r},getMidPos:function(e,t,r){var i,n,s,o,a=window.getSize(),l=a.x,c=a.y;r.page?(i=r.page.x,n=r.page.y,s=r.client.x+e,o=r.client.y+t):(i=r.pageX,n=r.pageY,s=r.clientX+e,o=r.clientY+t);var d=s>=l?i-(s-l):i,u=o>=c?n-(o-c):n;return{x:d,y:u}},getCSSBrowserFeature:function(e){var t=Modernizr.prefixed(e.camelCase());return t?t.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"):!1},getIsSibling:function(e,t){return e&&t&&e.getParent()===t.getParent()},iframeCallback:0,prepareIFrameForWrite:function(e,t){try{var r=e.contentWindow.document||e.contentWindow.document;t(e,r)}catch(i){var n="tmp"+this.iframeCallback++;W[n]=function(){var r=e.contentDocument||e.contentWindow.document;t(e,r)},e.src=W.Config.getServiceTopologyProperty("scriptsRoot")+"/html/sameDomainIFrame.html?d="+encodeURIComponent(document.domain)+"&c="+encodeURIComponent(n)}},forceBrowserRepaint:function(e,t,r){r=r||["safari"];var i=!1,n=0;for(n;r.length>n;n++)if(Browser[r[n]]){i=!0;break}i&&(e=e||$$("body"),t=t||150,e.setStyle("opacity",.99),setTimeout(function(){e.setStyle("opacity",1)},t))},forceBrowserRepaintOnScroll:function(e){Browser.safari&&(e=e||$$("body"),this._op=1===this._op?.99:1,e.setStyle("opacity",this._op))},stopMouseWheelPropagation:function(e){e=e||{};var t=this.getSize().y;(this.scrollTop===this.scrollHeight-t&&0>e.wheel||0===this.scrollTop&&e.wheel>0)&&e.preventDefault()},printNodesWithStyle:function(e,t){var r=this.getComputedStyle(e);if(r&&r[t]&&"auto"!=r[t]&&console.log(r[t],e),e.childNodes)for(var i=e.childNodes,n=0;i.length>n;n++)this.printNodesWithStyle(i[n],t)},requestAnimFrame:function(){},isInputKey:function(e){return e?48>e?13==e||32==e||8==e||46==e:e>=112&&145>=e?!1:e>90&&93>=e?!1:!0:!1},numberToPageId:function(e){var t=e.toString(36),r=t.length;return 3>r&&(t="0000".substr(0,3-r)+t),t},serverRequest:function(e,t,r,i,n){var s="",o=new Request.JSON({url:s+e,onSuccess:i,onFailure:n});"post"==t?o.post(r):o.get(r)},freezeScroll:function(e){if(!window.isScrollFrozen){var t=window.getScroll().y,r=document.onscroll;this.callLater(function(){document.onscroll=r,window.isScrollFrozen=!1},null,null,e||500),window.isScrollFrozen=!0,document.onscroll=function(e){var r=window.getScroll().y;return t!=r&&window.scrollTo(0,t),e.preventDefault(),!1}}}}}),function(){var e="undefined"!=typeof window?window:exports,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=function(){try{document.createElement("$")}catch(e){return e}}();e.btoa||(e.btoa=function(e){for(var i,n,s=0,o=t,a="";e.charAt(0|s)||(o="=")&&s%1;a+=o.charAt(63&i>>8-8*(s%1))){if(n=e.charCodeAt(s+=.75),n>255)throw r;i=i<<8|n}return a}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),1==e.length%4)throw r;for(var i,n,s=0,o=0,a="";n=e.charAt(o++);~n&&(i=s%4?64*i+n:n,s++%4)?a+=String.fromCharCode(255&i>>(6&-2*s)):0)n=t.indexOf(n);return a})}(),define.utils("cookies",function(){"use strict";return{createCookie:function(e,t,r){var i="";if(r){var n=new Date;n.setTime(n.getTime()+r),i="; expires="+n.toGMTString()}document.cookie=e+"="+t+i+"; path=/"},deleteCookie:function(e){document.cookie=e+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/"},hasCookie:function(e){return null!==this.readCookie(e)},readCookie:function(e){var t=document.cookie.match(RegExp("\\b"+e+"=(.*?)(;|$)"));return t?t[1]:null}}}),define.utils("debug:this",function(){return{errorPopup:function(e,t,r){W.EditorDialogs&&(window.debugMode&&"nodebug"!==window.debugMode?W.EditorDialogs.openErrorDialog(e,t,r):W.EditorDialogs.openErrorDialog(e,t))},debugTrace:function(){"nodebug"!==window.debugMode&&window.console&&(console.log.apply?console.log.apply(console,arguments):console.log(arguments))},reportWixifyTimeOut:function(e,t,r,i){this.debugTrace(["* Wixify timeout id:"+e.get("id")+" comp:"+e.get("comp"),{node:e,logic:t,skin:r,data:i},{pendingClasses:W.Classes._pendingNewClassesQueue.map,pendingSkins:W.Skins._skinQue.map}])},alertError:function(e,t,r,i,n){return n||LOG.reportError(e,t,r,i),this.errorPopup("Error",i,t+"."+r+"\n\n"+i),"debug"!=window.debugMode?function(){}:null},getStackTrace:function(e){e=!isNaN(e)&&e>0?e:1;var t=Error(),r="(no stack)";t.stack?r=t.stack:window.opera&&t.message&&(r=t.message),r=r.split("[object Object]").join("{}"),r=r.split("[object Array]").join("[]"),r=r.replace(/at/g,""),r=r.split(window.serviceTopology.scriptsLocationMap.web+"/javascript/").join("");var i=r.split("\n");return"error"==i[0].toLowerCase()&&e++,i=i.splice(e),i.join("<<").replace(/\s{2,}/g," ")}}}),define.utils("Validation:this",function(){return{isObjectEmpty:function(e){return Object.some(e,function(){return!0})},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isURLPartValid:function(e){return/[^a-z_0-9]/.test(e)===!1&&e.length>=4},convertToValidUrlPart:function(e){return e.replace(/[ ]/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase()},isValidUrl:function(e){return 0===e.indexOf(".")&&(e=this._rel_to_abs(e)),this._RegEx.validUrlReg.test(e)},_rel_to_abs:function(e){if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(e))return e;var t=location.href.match(/^(.+)\/?(?:#.+)?$/)[0]+"/";if("//"==e.substring(0,2))return location.protocol+e;if("/"==e.charAt(0))return location.protocol+"//"+location.host+e;if("./"==e.substring(0,2))e="."+e;else{if(/^\s*$/.test(e))return"";e="../"+e}for(e=t+e;/\/\.\.\//.test(e=e.replace(/[^\/]+\/+\.\.\//g,"")););return e=e.replace(/\.$/,"").replace(/\/\./g,"").replace(/"/g,"%22").replace(/'/g,"%27").replace(/</g,"%3C").replace(/>/g,"%3E")},isValidUrlNoProtocol:function(e){return this._RegEx.validUrlNoProtocolReg.test(e)},isValidEmail:function(e){return this._RegEx.validEmailReg.test(e)},isValidTwitterUser:function(e){return this._RegEx.ValidTwitterUserReg.test(e)},validatePageTitle:function(e){var t=e;if(t=t.replace(/[^A-Za-z0-9_ ]/g,""),0===t.indexOf(" "))for(;0===t.indexOf(" ");)t=t.substr(1);if(t.indexOf("  ")>-1)for(;t.indexOf("  ")>-1;)t=t.replace("  "," ");return t=t.substr(0,Constants.Page.NAME_MAX_LENGTH),""===t&&(t="untitled"),t},isInputKey:function(e){return e?48>e?13==e||32==e||8==e||46==e:e>=112&&145>=e?!1:e>90&&93>=e?!1:!0:!1},isEquivalent:function(e,t){if(typeof e!=typeof t)return!1;if(e instanceof Array&&!(t instanceof Array))return!1;if("function"===(typeof e&&typeof t))return!0;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e===t;var r=0,i=e instanceof Array;if(i){var n=function(e,r){return W.Utils.isEquivalent(e,t[r])};return e.length==t.length&&e.every(n,t)}for(var s in e){if(e.hasOwnProperty(s)&&!t.hasOwnProperty(s))return!1;++r}for(s in t)t.hasOwnProperty(s)&&r--;if(0!==r)return!1;for(s in e)if(e.hasOwnProperty(s)&&!this.isEquivalent(e[s],t[s]))return!1;return!0},_RegEx:{validUrlReg:RegExp("^(ftps|ftp|http|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&*;:/~\\+#!|]*[\\w\\-\\@?^=%&*;/~\\+#!|])?$"),validUrlNoProtocolReg:RegExp("^[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&*;:/~\\+#!|]*[\\w\\-\\@?^=%&*;/~\\+#!|])?$"),validEmailReg:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ValidTwitterUserReg:/^@?[a-zA-Z0-9_%]+$/}}}),define.utils("editorUtils:this",function(){return{getAddPageTemplateFromMainPage:function(e,t,r){return this.getAddPageTemplateFromPage("mainPage",e,t,r)},getAddPageTemplateFromCurrentPage:function(e,t,r){return this.getAddPageTemplateFromPage(W.Preview.getPreviewManagers().Viewer.getCurrentPageId(),e,t,r)},getAddPageTemplateFromPage:function(e,t,r,i){r=r||"";var n=W.Preview.getHtmlElement(e).getLogic(),s="ADD_PAGE_"+t.toUpperCase()+"_GROUPNAME",o="ADD_PAGE_"+t.toUpperCase()+r+"_NAME",a="ADD_PAGE_"+t.toUpperCase()+r+"_DESCRIPTION",l=W.ClipBoard.copyComponent(n);l=this._handleWixAppsComponents(l);var c={group:s,name:o,applicationType:i||Constants.WEditManager.SITE_TYPE_WEB,previewPic:t.toLowerCase()+r+".png",pageDescription:a,serializedPageData:l},d=JSON.encode(c);return d=d.replace(/\\\"/g,"\\'")},_handleWixAppsComponents:function(e){var t=W.Preview.getPreviewManagers().Viewer.getAppDataHandler();return e.components&&e.components.each(function(e){if("wixapps.integration.components.AppPart"==e.componentType){var r=e.data,i=r.appInnerID,n=t.getAppData(i);r.appInnerID=n.appDefinitionId;var s=r.appLogicParams;s&&s.hasOwnProperty("categoryId")&&(s.categoryId.value="defaultCategory")}else e.hasOwnProperty("components")&&this._handleWixAppsComponents(e)}.bind(this)),e},openSidePanel:function(e,t){var r=window.$$('[comp="'+e+'"]')[0],i=r&&r.getLogic().getIsDisplayed();if(i)return!1;var n=W.Editor.getEditorUI(),s=n._history;return s.pop(),n._updateBreadcrumbState(),W.Commands.executeCommand(t),!0}}}),define.Class("bootstrap.utils.Hash",function(e){var t=e;t.inherits("bootstrap.utils.Events"),t.fields({intervalId:0}),t.methods({initialize:function(){this._storedExtData="","onhashchange"in window&&!Browser.ie8?window.onhashchange=function(){this._onHashChange()}.bind(this):(this._storedObjectId=window.location.hash,clearInterval(this.intervalId),this.intervalId=window.setInterval(function(){this._onHashChange()}.bind(this),100))},fireHashChangeEvent:function(){Browser&&Browser.ie8?this._onHashChange("force change"):this._onHashChange()},_onHashChange:function(e){var t=this.getHashParts(),r=this._storedObjectId!=t.id;"force change"===e&&(r=!0);var i=this._storedExtData!=t.extData;if(r||i){this._storedObjectId=t.id,this._storedExtData=t.extData;var n=!1;this._silencedExtData&&this._silencedExtData==t.extData&&(delete this._silencedExtData,n=!0),this.fireEvent("change",{newHash:t.id,isForSureAfterChange:!0,extData:t.extData,isIdChanged:r,isExtDataChanged:i,silent:n})}this._cleanHomePageURL()},getHash:function(){var e=window.location.hash;e=unescape(e);var t=this.getHashParts(e);return t.id},getHashParts:function(e){e=e||window.location.hash;var t="|",r="/",i="/",n=e,s="",o="";e.length>1&&"#!"==e.substr(0,2)?n=e.substr(2):"#"==e.charAt(0)&&(n=e.substr(1));var a=n.indexOf(r),l=n.indexOf(t),c=r;(-1!=l&&a>l||l>-1&&-1==a)&&(c=t);var d=n.indexOf(c);return d>-1&&(s=n.substr(0,d),n=n.substr(d+1)),d=n.indexOf(i),d>-1&&(o=n.substr(d+1),n=n.substr(0,d)),{id:n?n:"",title:s?s:"",extData:o?o:""}},getHashPartsString:function(e,t,r){var i="/",n="";return t&&(n=t.replace(/([^\s\w\d_-])/g,"").replace(/\s+/g,"-")),n+=i+e,r&&(n+=i+r),n},setHash:function(e,t,r,i){t=t||"untitled";var n=this.getHashPartsString(e,t,r),s=this._storedObjectId!==e,o=this._storedExtData!=r;(s||o)&&(i&&(this._silencedExtData=r),this.fireEvent("change",{newHash:e,isForSureAfterChange:!1,extData:r,isExtDataChanged:o,isIdChanged:s,silent:i===!0}),W.Utils.callLater(function(){var e=window.location.hash;e!=="#!"+n&&(window.location.hash="!"+n)}.bind(this)))},setHashExtData:function(e){var t=this.getHashParts();this.setHash(t.id,t.title,e,!0)},_cleanHomePageURL:function(){var e,t,r=this.getHashParts(e);if(!r.extData&&W.Viewer.getHomePageId()===r.id)if(window.history&&window.history.replaceState){e=window.location.hash,t=window.location.href;var i=t.substr(0,t.length-e.length);window.history.replaceState(null,null,i)}else window.location.hash=""}})}),define.utils("hashing",function(){return{SHA256:function(){function e(e){return a(y(o(e),8*e.length))}function t(e,t){var r=o(e);r.length>16&&(r=y(r,8*e.length));for(var i=[],n=[],s=0;16>s;s++)i[s]=909522486^r[s],n[s]=1549556828^r[s];var l=y(i.concat(o(t)),512+8*t.length);return a(y(n.concat(l),768))}function r(e){try{}catch(t){_=0}for(var r,i=_?"0123456789ABCDEF":"0123456789abcdef",n="",s=0;e.length>s;s++)r=e.charCodeAt(s),n+=i.charAt(15&r>>>4)+i.charAt(15&r);return n}function i(e){try{}catch(t){v=""}for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",n=e.length,s=0;n>s;s+=3)for(var o=e.charCodeAt(s)<<16|(n>s+1?e.charCodeAt(s+1)<<8:0)|(n>s+2?e.charCodeAt(s+2):0),a=0;4>a;a++)i+=8*s+6*a>8*e.length?v:r.charAt(63&o>>>6*(3-a));return i}function n(e,t){var r,i,n,s,o=t.length,a=[],l=[],c=Math.ceil(e.length/2);for(r=0;c>r;r++)l[r]=e.charCodeAt(2*r)<<8|e.charCodeAt(2*r+1);for(;l.length>0;){for(s=[],n=0,r=0;l.length>r;r++)n=(n<<16)+l[r],i=Math.floor(n/o),n-=i*o,(s.length>0||i>0)&&(s[s.length]=i);a[a.length]=n,l=s}var d="";for(r=a.length-1;r>=0;r--)d+=t.charAt(a[r]);var u=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2)));for(r=d.length;u>r;r++)d=t[0]+d;return d}function s(e){for(var t,r,i="",n=-1;++n<e.length;)t=e.charCodeAt(n),r=e.length>n+1?e.charCodeAt(n+1):0,t>=55296&&56319>=t&&r>=56320&&57343>=r&&(t=65536+((1023&t)<<10)+(1023&r),n++),127>=t?i+=String.fromCharCode(t):2047>=t?i+=String.fromCharCode(192|31&t>>>6,128|63&t):65535>=t?i+=String.fromCharCode(224|15&t>>>12,128|63&t>>>6,128|63&t):2097151>=t&&(i+=String.fromCharCode(240|7&t>>>18,128|63&t>>>12,128|63&t>>>6,128|63&t));return i}function o(e){for(var t=[],r=e.length>>2,i=0;r>i;i++)t[i]=0;for(var n=0;8*e.length>n;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function a(e){for(var t="",r=0;32*e.length>r;r+=8)t+=String.fromCharCode(255&e[r>>5]>>>24-r%32);return t}function l(e,t){return e>>>t|e<<32-t}function c(e,t){return e>>>t}function d(e,t,r){return e&t^~e&r}function u(e,t,r){return e&t^e&r^t&r}function p(e){return l(e,2)^l(e,13)^l(e,22)}function h(e){return l(e,6)^l(e,11)^l(e,25)}function f(e){return l(e,7)^l(e,18)^c(e,3)}function g(e){return l(e,17)^l(e,19)^c(e,10)}function y(e,t){var r,i,n,s,o,a,l,c,y,_,v,C,b=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],A=[];for(e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t,y=0;e.length>y;y+=16){for(r=b[0],i=b[1],n=b[2],s=b[3],o=b[4],a=b[5],l=b[6],c=b[7],_=0;64>_;_++)A[_]=16>_?e[_+y]:m(m(m(g(A[_-2]),A[_-7]),f(A[_-15])),A[_-16]),v=m(m(m(m(c,h(o)),d(o,a,l)),E[_]),A[_]),C=m(p(r),u(r,i,n)),c=l,l=a,a=o,o=m(s,v),s=n,n=i,i=r,r=m(v,C);b[0]=m(r,b[0]),b[1]=m(i,b[1]),b[2]=m(n,b[2]),b[3]=m(s,b[3]),b[4]=m(o,b[4]),b[5]=m(a,b[5]),b[6]=m(l,b[6]),b[7]=m(c,b[7])}return b}function m(e,t){var r=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(r>>16);return i<<16|65535&r}var _=0,v="",E=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];return{hex_sha256:function(t){return r(e(s(t)))},b64_sha256:function(t){return i(e(s(t)))},any_sha256:function(t,r){return n(e(s(t)),r)},hex_hmac_sha256:function(e,i){return r(t(s(e),s(i)))},b64_hmac_sha256:function(e,r){return i(t(s(e),s(r)))},any_hmac_sha256:function(e,r,i){return n(t(s(e),s(r)),i)}}}()}}),define.utils("helpers:this",function(){return{log:function(){},_fixPrefix:function(e){return e=e?e.replace(/[^A-Za-z0-9_-]/g,""):"",e.length>3&&(e=e?e.replace(/[aeiou]/gi,""):""),e=e?e:Constants.components.DEFAULT_PREFIX},_calcNewIndex:function(e){var t=this._prefixCounterMap;for(t[e]=void 0===t[e]?0:++t[e];$(e+t[e].toString(36));)t[e]++;var r=e+t[e].toString(36);return this.isExperimentOpen("GuidId","New")?r+"-"+Math.floor(65535*Math.random()).toString(36):r},getUniqueId:function(e){return e=this._fixPrefix(e),this._calcNewIndex(e)},getGUID:function(){var e=function(){return Math.floor(65536*Math.random()).toString(16)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getAntiCacheSuffix:function(){var e,t=W.Utils.getQueryParam("nocache"),r=W.Utils;return"file:"===window.location.protocol||"false"==t||"nodebug"===window.debugMode?e="":(r._antiCacheSuffix||(r._antiCacheSuffix=(new Date).getTime().toString(36)),e="?noCache="+r._antiCacheSuffix),e},setUrlParam:function(e,t,r){var i=e.split("?"),n=[],s=!1;if(2==i.length){n=i[1].split("&");for(var o=0;n.length>o;o++)if(0===n[o].indexOf(t+"=")){n[o]=t+"="+(r+""),s=!0;break}}return s||n.push(t+"="+(r+"")),i[1]=n.join("&"),e=i.join("?")},getQueryStringAsObject:function(e){var t={},r=e?e:window.location.href;return r.replace(RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,r,i,n){t[r]=n}),t},getQueryStringParamsAsObject:function(e){var t={},r=e?e:window.location.href;return r.substr(r.indexOf("?")).replace(RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,r,i,n){t[r]=n}),t},getMailFromMailtoURL:function(e){var t="mailto:",r=t.length;e.substr(0,r)==t&&(e=e.substr(r));var i="?subject=",n=e.indexOf(i);return n>-1&&(e=e.substr(0,n)),e},getQueryParam:function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+e+"=([^&#]*)",i=RegExp(r),n=t||window.location.href,s=i.exec(n);return null===s?"":s[1]},callLater:function(e,t,r,i){if(e&&"function"===typeOf(e)){t=t||[],r=r||window,i=i||1;var n="true"===this.getQueryParam("stack")?this.getStackTrace():"";return setTimeout(function(){e.callLaterStack=n,e.apply(r,t),delete e.callLaterStack},i)}},clearCallLater:function(e){clearTimeout(e)},callOnNextRender:function(e,t){t=t||60;var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,t)};return r(e)},clearOnNextRender:function(e){var t=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;t(e)},objectSizeDelta:function(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&t++;return t},getTimestamp:function(){var e=[W.Resources.get("EDITOR_LANGUAGE","DAY_SUNDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_MONDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_TUESDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_WEDNESDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_THURSDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_FRIDAY"),W.Resources.get("EDITOR_LANGUAGE","DAY_SATURDAY")],t=new Date,r=t.getDate(),i=t.getMonth()+1,n=W.Resources.get("EDITOR_LANGUAGE","MONTH_"+i),s=t.getHours();
10>s&&(s="0"+s);var o=t.getMinutes();10>o&&(o="0"+o);var a=t.getDay(),l=t.getYear()+1900;return e[a]+", "+r+" "+n+" "+l+", "+s+":"+o},sanitizeUnicode:function(e){return"string"==typeof e?e.replace(/[\u2028\u2029]/g,"\n"):e},getUniqueArray:function(e){for(var t=[],r=e.length,i=0;r>i;i++){for(var n=i+1;r>n;n++)e[i]===e[n]&&(n=++i);t.push(e[i])}return t},areArraysContainSameElements:function(e,t){var r=e.filter(function(e){return-1==t.indexOf(e)}),i=t.filter(function(t){return-1==e.indexOf(t)});return i&&i.length>0||r&&r.length>0?!1:!0},areObjectsEqual:function(e,t){var r;if(e&&!t||!e&&t)return!1;for(r in e)if(e.hasOwnProperty(r)&&t[r]===void 0&&e[r]!==void 0)return!1;for(r in e)if(e.hasOwnProperty(r))if(e[r])switch(typeof e[r]){case"object":if(!this.areObjectsEqual(e[r],t[r]))return!1;break;case"function":if(t[r]===void 0||""+e[r]!=""+t[r])return!1;break;default:if(e[r]!=t[r])return!1}else if(t[r])return!1;for(r in t)if(t.hasOwnProperty(r)&&e[r]===void 0&&t[r]!==void 0)return!1;return!0},stringToBoolean:function(e){return e?"true"==e.toLowerCase():!1},strEndsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},getParentByTagName:function(e,t){var r=e.parentNode;return r?r.tagName.toLowerCase()==t?r:this.getParentByTagName(r,t):!1},getComponentLogicFromDom:function(e){return this.getComponentLogicFromDomByAttribute("id",e)},getComponentLogicFromDomByAttribute:function(e,t){var r=W.Preview?W.Preview.getPreviewSite():window,i=r.$$("["+e+'="'+t+'"]')[0];return i?i.getLogic():null},moveItemInArray:function(e,t,r){if(r>=e.length)for(var i=r-e.length;i--+1;)e.push(void 0);return e.splice(r,0,e.splice(t,1)[0]),e},isExperimentOpen:function(e,t){var r=this._getRunningExperiments(),i=r[e]||r[e.toLowerCase()];return i&&i.toLowerCase()===t.toLowerCase()},_getRunningExperiments:function(){var e=window.editorModel||window.rendererModel||{};return e.runningExperiments||[]}}}),function(){var e,t,r,i,n,s,o,a;e=document.createElement("style"),e.id="testCss",document.getElementsByTagName("head")[0].appendChild(e),i=e.sheet?"sheet":"styleSheet",t=e[i],t||LOG.reportError(wixErrors.UTILS_STYLE_NOT_FOUND,"Styles","feature detection"),n=t.ownerNode?"ownerNode":"owningElement",o=t.deleteRule?"deleteRule":"removeRule",s=t.cssRules?"cssRules":"rules";var l,c=function(e){return e.replace(/[\s]+/g," ").replace(/'/g,'"').replace(/^\s+/,"").replace(/\s*$/,"")};l=t.insertRule?function(e,t){if(e=c(e),this._rulesMap[e])return LOG.reportError(wixErrors.UTILS_RULE_ALREADY_EXIST,"Styles","createRule",e+""),void 0;var r=this.insertRule(e+"{"+t+"}",this.cssRules.length),i=this.cssRules[r];return this._rulesMap[e]=i,this._browserSelectorMapping[e]=i.selectorText,i}:function(e,t){if(e=c(e),this._rulesMap[e])return LOG.reportError(wixErrors.UTILS_RULE_ALREADY_EXIST,"Styles","createRule",e+""),void 0;var r,i=this.addRule(e,t);if(-1!=i)r=this.rules[i];else for(var n=0;this.rules.length>n;++n)if(this.rules[n].selectorText==e){r=this.rules[n];break}return this._rulesMap[e]=r,this._browserSelectorMapping[e]=r.selectorText,r},t._rulesMap={},t._browserSelectorMapping={},r=l.apply(t,["#tempSelector","color:black;"]),a=r.cssText?"cssText":"no_support";var d,u=function(){return this[i]},p=function(){return this[s]},h=function(){this._rulesMap=void 0,this.styleNode.dispose()},f=function(){this._rulesMap=[];for(var e=this[s].length-1;e>=0;--e)this[o](e)},g=function(e){return e=c(e),this._rulesMap[e]?this._rulesMap[e]:null},y=function(e){e=c(e);var t=!1;if(this._rulesMap[e]){for(var r=this._browserSelectorMapping[e],i=this[s].length-1,n=i;n>=0;--n)this[s][n].selectorText==r&&(this[o](n),t=!0);delete this._rulesMap[e]}return t};d=t.cssRules?function(e,t){e=c(e);var r=this._rulesMap[e];return r?r.style[a]=t:(r=this.createRule(e,t),this._rulesMap[e]=r),r}:function(e,t){return e=c(e),this._rulesMap[e]&&(this.removeRuleBySelector(e),delete this._rulesMap[e]),this.createRule(e,t)},define.utils("createStyleSheet:this",function(){function e(e){var t=W.Utils.getUniqueId(e),r=new Element("style",{id:t}).inject(document.head),s=r[i];if(!s)for(var o=document.styleSheets,a=0;o.length>a;++a)if(o[a][n]===r){s=o[a];break}return s?(s._rulesMap={},s._browserSelectorMapping={},s.styleNode=r,s.getRuleList=p,s.removeStyleSheet=h,s.clearRules=f,s.getRuleBySelector=g,s.removeRuleBySelector=y,s.updateRule=d,s.createRule=l,r.getStyleSheet=u,s):(LOG.reportError(wixErrors.UTILS_ERR_CREATE_STYLE,"Styles","createStyleSheet",""),void 0)}return{createStyleSheet:function(e){return this._styles.createStyleSheet(e)},_styles:{createStyleSheet:e}}})}(),define.utils("testUtils:this",function(){return{instanceIndex:0,_$getUniqeId:function(e){var t=this.instanceIndex,r=Utils.getUniqueId(e);return this.instanceIndex=t,r}}});