define.Class("core.utils.BeatStatisticsAndKeepAlive",function(t){var e=t;e.resources["W.Editor"],e.statics({BeatStatisticsAndKeepAliveInstances:[]}),e.fields({beatDefaultPulseTime:900,timeoutTimeMillis:1e3,_JSONPScriptId:"BeatStatisticsAndKeepAliveJSONP",_InstanceId:-1,beatUrl:"http://beat.wix.com/alive/jsonp"}),e.methods({initialize:function(t,e,i,n,s,a,r){if(this.isEmpty(t)||this.isEmpty(e)||this.isEmpty(i))throw"the appId, pageId and siteId are mandatory";"preview"!==window.viewMode&&(this._initialize(t,e,i,n,s,a,r),this._gotResponse=!1,this._timeoutCount=0,this._sendRequestToBeatJSONP())},_initialize:function(t,e,i,n,s,a,r){this._InstanceId=this.BeatStatisticsAndKeepAliveInstances.push(this)-1,this._properties={isKeepAlive:s?s:!1,callback:r},this._requestData={app:t,siteId:e,metaSiteId:a,isTemplate:n?n:0,pageFileName:i,firstTimeInDocPage:!0,etag:this._getEtag()}},_getEtag:function(){return $$("meta[http-equiv=etag]")[0]&&$$("meta[http-equiv=etag]")[0].getAttribute?$$("meta[http-equiv=etag]")[0].getAttribute("content"):null},_addJSONPScriptElement:function(){if(!document.getElementById(this._JSONPScriptId)){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");return e.id=this._JSONPScriptId,e.type="text/javascript",e.async=!0,t.parentNode.insertBefore(e,t),e}},_sendRequestToBeatJSONP:function(){this._gotResponse=!1;var t=this._getRequestUrl(),e=document.getElementById(this._JSONPScriptId);e&&e.parentNode.removeChild(e);var i=this._addJSONPScriptElement();i.src=t},_processJsonResponse:function(t){this._gotResponse=!0,this._timeoutCount=0,this._requestData.firstTimeInDocPage=!1;var e=t&&t.payload&&t.payload.wixBeat?t.payload.wixBeat:this.beatDefaultPulseTime;if(this._properties.isKeepAlive){var i=this;window.setTimeout(function(){i._sendRequestToBeatJSONP()},1e3*e)}this._properties.callback&&this._properties.callback(t)},_timeoutJsonP:function(){if(!this._gotResponse&&this._properties.callback){if(this._properties.callback({errorCode:1,errorDescription:"timeout: there is no response after "+this.timeoutTimeMillis+"millis",success:!1}),2>this._timeoutCount){var t=this;window.setTimeout(function(){t._sendRequestToBeatJSONP()},1e4)}this._timeoutCount++}},_getRequestUrl:function(){var t=this.beatUrl+"?";for(var e in this._requestData)t+=e+"="+this._requestData[e]+"&";return t=t.slice(0,-1)},isEmpty:function(t){return void 0===t||null===t}})}),define.utils("ColorValidations:this",function(){return{isValidColor:function(t){return instanceOf(t,String)&&(0===t.indexOf("#")&&(4===t.length||7===t.length)&&!isNaN(t.replace("#","0x"))||Constants.CSS.COLORS.contains(t.toLowerCase()))}}}),define.utils("linkUtils",function(){var t={linkType:{SMS:"SMS",CALL:"CALL",SKYPE:"SKYPE",MAP:"MAP",EMAIL:"EMAIL",FACEBOOK:"FACEBOOK",FLICKR:"FLICKR",BLOGGER:"BLOGGER",MYSPACE:"MYSPACE",LINKEDIN:"LINKEDIN",TWITTER:"TWITTER",TUMBLR:"TUMBLR",YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",PAGE:"PAGE",FREE_LINK:"FREE_LINK",TEXT:"TEXT",DELICIOUS:"DELICIOUS",WEBSITE:"WEBSITE",DOCUMENT:"DOCUMENT",LOGIN:"LOGIN"},linkTarget:{SAME_WINDOW:"_self",NEW_WINDOW:"_blank"}};return{linkify:function(t,e,i,n){e&&(i&&""!==i?(e.set("href",i),e.setStyle("cursor","pointer"),this._setTarget(e,n),this.hasState("noLink","linkableComponent")&&this.removeState("noLink","linkableComponent")):(e.setStyle("cursor","default"),e.erase("href"),e.erase("target"),this.hasState("noLink","linkableComponent")&&this.setState("noLink","linkableComponent")),this._handleSpecialCases(t,e))},renderLinks:function(t,e){var i=t.getData(),n=i.href,s=i.target,a=i.linkType,r=e?e:this._skinParts.link;("same"===s||"self"===s)&&(s="_self",t.set("target","_self")),W.Utils.linkUtils.linkify.call(this,a,r,n,s),this._NO_LINK_PROPAGATION&&W.Utils.linkUtils.disableLinkClickPropagation(r)},disableLinkClickPropagation:function(t){t.addEvent("click",function(t){t.stopPropagation()})},_setTarget:function(t,e){t.set("target",e)},_bindPageLeaveWarningToLink:function(t,e){e.erase("href"),e.erase("target"),e.addEvent("click",function(e){e.preventDefault(),this._showNavigationDisabledTooltip(t)}.bind(this))},_showNavigationDisabledTooltip:function(t){this.injects().Commands.executeCommand("linkableComponent.navigateSameWindow",{component:t},t)},linkableComponentEditModeChanged:function(e,i,n){if(!this._isDisposed){var s=n?n:this._skinParts.link,a=!1,r=!1,o=this.getDataItem?this.getDataItem():i,h=o.get("linkType"),l=o.get("target"),c=t.linkTarget.SAME_WINDOW,d=t.linkType.WEBSITE,u=t.linkType.EMAIL;l===c&&h===d&&(a=!0),h===u&&(r=!0),"PREVIEW"==e?a?this._bindPageLeaveWarningToLink(s):r&&(this._bindMailtoLinks(s),this.renderLinks(i)):(s.removeEvents("click"),this.renderLinks(i))}},_bindMailtoLinks:function(t){t=this._skinParts.link,t.addEvent("click",this._temporaryDisableNavigationWarning)},_temporaryDisableNavigationWarning:function(){window.enableNavigationConfirmation=!1,setTimeout(function(){window.enableNavigationConfirmation=!0},50)},_handleSpecialCases:function(e,i){switch(i.removeEvents("click"),e){case t.linkType.LOGIN:i.addEvent("click",function(){if(window.animateForm){var t=this.getDataItem(),e=t.get("text");if(e){e=JSON.parse(e);var i=e.postLoginUrl,n=e.postSignupUrl,s=e.type,a="HTML",r=window.userApi?window.userApi.isSessionValid():!1;r?i&&(window.location.href=i):window.animateForm.callOnContent([n,i,s,a])}}}.bind(this));break;case t.linkType.ADMIN_LOGIN:i.setStyle("cursor","pointer"),i.addEvent("click",function(){this.injects().Commands.executeCommand("WViewerCommands.AdminLogin.Open")}.bind(this))}}}}),define.Class("core.utils.css.Background",function(t){var e=t;e.utilize(["core.utils.css.Color"]),e.methods({initialize:function(t,e){if(this.setThemeManager(e),t){t.getThemeString&&(t=t.getThemeString());var i=t.split(" ").filter(function(t){return!!t});if(1===i.length){var n="^#[\\dA-Fa-f]{3,8}$",s="^rgba?\\([\\d,]+\\)$",a="^[\\[\\{][\\w\\d_]+[\\]\\}]$",r=RegExp(n+"|"+s+"|"+a),o=i[0];"none"==o?i=["none",0,0,"center","center","auto","repeat","repeat","scroll","none"]:o.test(r)&&(i=["none",0,0,"center","center","auto","repeat","repeat","scroll",o])}this.set.apply(this,i)}},setThemeManager:function(t){this._themeManager=t},set:function(t,e,i,n,s,a,r,o,h,l){this._setColor(l),this.setImage(t,e,i),this.setRepeat(r,o),this.setAttachment(h),this.setPosition(n,s),this.setWidth(a)},setWidth:function(t){var e=parseInt(t,10),i=Constants.Background.VALID_WIDTH;this._width=i.contains(t)||!isNaN(e)?t:this._width||i[0]},setPosition:function(t,e){if(e===void 0){var i=t.split(" ");2===i.length&&(t=i[0],e=i[1])}var n=Constants.Background.VALID_POSITION_X,s=Constants.Background.VALID_POSITION_Y;this._x=n.contains(t)?t:this._x||n[0],this._y=s.contains(e)?e:this._y||s[0]},setAttachment:function(t){var e=Constants.Background.VALID_ATTACHMENT;this._attachment=e.contains(t)?t:this._attachment||e[0]},setColorReference:function(t){this._colorSource="theme",this._colorName=t,this._color=new this.imports.Color(this._themeManager&&this._themeManager.getProperty(t))},setColor:function(t){("transparent"==t||"none"==t)&&(t="0,0,0,0"),this._colorSource="value",this._colorName="",this._color=new this.imports.Color(t)},_setColor:function(t){var e="",i=t&&(t.test(/\{.+\}/)||t.test(/\[.+\]/));t&&i?(e=i&&t.substring(1,t.length-1)||t,this.setColorReference(e)):this.setColor(t)},setImage:function(t,e,i){this._imageId=t||"none",this._imageW=e||0,this._imageH=i||0},setPyramidSize:function(t){this._pyramid=t},setRepeat:function(t,e){if(e===void 0){var i=t.split(" ");switch(i.length){case 1:e=t;break;case 2:t=i[0],e=i[1]}}var n=Constants.Background.VALID_REPEAT;this._repeatX=n.contains(t)?t:this._repeatX||n[0],this._repeatY=n.contains(e)?e:this._repeatY||n[0]},getCssValue:function(t){var e=t?"background:":"";return this.getImageId()&&(e+=[this.getUrl(),this.getPosition(),this.getRepeatUnified(),this.getAttachment()].join(" ")+" "),e+=this.getColor()},getCssSizeValue:function(t){return this.getWidth(t)},getCssRule:function(t){var e=this.getCssValue(!0);return t&&(e+=";"+this.getCssSizeValue(!0)),e},getCssRules:function(){return[this.getUrl(!0),this.getPosition(!0),this.getWidth(!0),this.getRepeat(!0),this.getAttachment(!0),this.getColor(!0)].join(";")},getThemeString:function(){var t="theme"===this._colorSource?"{"+this.getColorReference()+"}":this.getColor();return[this.getImageId(),this.getImageSize()[0],this.getImageSize()[1],this.getPosition(),this.getWidth(),this.getRepeat(),this.getAttachment(),t].join(" ")},getWidth:function(t){var e=t?"background-size:":"";return e+=this._width},getWidthInline:function(t){return Modernizr&&Modernizr.backgroundsize||t?"/"+this.getWidth():""},getPosition:function(t){var e=t?"background-position:":"";return e+=this.getPositionX()+" "+this.getPositionY()},getPositionX:function(t){var e=t?"background-position-x:":"";return e+=this._x},getPositionY:function(t){var e=t?"background-position-y:":"";return e+=this._y},getAttachment:function(t){var e=t?"background-attachment:":"";return e+=this._attachment},getColor:function(t){var e=t?"background-color:":"";return e+=0==this._color.getAlpha()?"transparent":this._color.getHex()},getColorReference:function(){return this._colorName},getUrl:function(t){var e=W.Config.getServiceTopologyProperty("staticMediaUrl")+"/",i=t?"background-image:":"";return i+="none"==this._imageId?this._imageId:"url("+e+this._imageId+this._getPyramidSuffix()+")"},getImageSize:function(){return[this._imageW,this._imageH]},getImageId:function(){return this._imageId||"none"},_getPyramidSuffix:function(){var t,e,i="",n=this._pyramid||Constants.Background.DEFAULT_PYRAMID_SIZE,s=[],a=1;return s[0]=parseInt(this.getImageSize()[0],10),s[1]=parseInt(this.getImageSize()[1],10),a=s[0]/s[1],t=s[0],e=s[1],(s[0]>n||s[1]>n)&&(t=s[0]>=s[1]?n:Math.round(a*n),e=s[1]>=s[0]?n:Math.round(1/a*n)),i="_crp_0_0_"+s[0]+"_"+s[1]+"_"+t+"_"+e+"_crp"},getRepeat:function(t){var e=t?"background-repeat:":"";return e+=this._repeatX+" "+this._repeatY},getRepeatUnified:function(t){var e=t?"background-repeat:":"";return e+=this._repeatX==this._repeatY?"no-repeat"==this._repeatX?"no-repeat":"repeat":"repeat"==this._repeatX?"repeat-x":"repeat-y"},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.BorderRadius",function(t){var e=t;e.methods({initialize:function(t){t=t.getThemeString?t.getThemeString():Array.isArray(t)?t.join(" "):""+t;var e=t.split(" ").filter(function(t){return!!t});this.set.apply(this,e)},square:function(){this._isLocked=!1;for(var t=0;arguments.length>t;++t)switch(arguments[t].toLowerCase()){case"tr":this._topRightRadius=0;break;case"tl":this._topLeftRadius=0;break;case"br":this._bottomRightRadius=0;break;case"bl":this._bottomLeftRadius=0}return this},set:function(t,e,i,n){this._isLocked=!1,t===void 0&&(t=0),e===void 0&&(e=t,this._isLocked=!0),i===void 0&&(i=t),n===void 0&&(n=e),this.setTopLeft(t,this._isLocked),this.setTopRight(e,this._isLocked),this.setBottomRight(i,this._isLocked),this.setBottomLeft(n,this._isLocked)},setTopLeft:function(t,e){this._isLocked=!!e;var i=this._seperateSizeFromUnit(t,this._topLeftUnits);this._topLeftRadius=i.size,this._topLeftUnits=i.unit},setTopRight:function(t,e){this._isLocked=!!e;var i=this._seperateSizeFromUnit(t,this._topRightUnits);this._topRightRadius=i.size,this._topRightUnits=i.unit},setBottomRight:function(t,e){this._isLocked=!!e;var i=this._seperateSizeFromUnit(t,this._bottomRightUnits);this._bottomRightRadius=i.size,this._bottomRightUnits=i.unit},setBottomLeft:function(t,e){this._isLocked=!!e;var i=this._seperateSizeFromUnit(t,this._bottomLeftUnits);this._bottomLeftRadius=i.size,this._bottomLeftUnits=i.unit},_seperateSizeFromUnit:function(t,e){t+="";var i=parseFloat(t),n=t.split(i+"").join("");return i=isNaN(i)?0:i,n=Constants.BorderRadius.VALID_UNITS.contains(n)?n:e||Constants.BorderRadius.VALID_UNITS[0],{unit:n,size:i}},getCssValue:function(){return this._isLocked?this.getTopLeft():[this.getTopLeft(),this.getTopRight(),this.getBottomRight(),this.getBottomLeft()].join(" ")},getCssRule:function(){return"border-radius:"+this.getCssValue()},getThemeString:function(){return this.getCssValue()},getTopLeft:function(){return this._topLeftRadius+this._topLeftUnits},getTopRight:function(){return this._topRightRadius+this._topRightUnits},getBottomRight:function(){return this._bottomRightRadius+this._bottomRightUnits},getBottomLeft:function(){return this._bottomLeftRadius+this._bottomLeftUnits},getIsLocked:function(){return this._isLocked},getUnits:function(){return[this._topLeftUnits,this._topRightUnits,this._bottomRightUnits,this._bottomLeftUnits]},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.BoxShadow",function(t){var e=t;e.utilize(["core.utils.css.Color"]),e.methods({initialize:function(t,e){this._shadow=[];var i="",n=!1;t&&"none"!==t&&(i=t),e!==!1&&i&&(n=!0),i.getThemeString&&(i=i.getThemeString()),this._parseShadowString(i||"0 0 0 0 #000000"),this.setToggleOn(n)},setToggleOn:function(t){this._toggleOn=t},setColor:function(t,e){e=e||0,this._shadow[e].color=new this.imports.Color(t)},setBlurRadius:function(t,e){e=e||0,this._shadow[e].blur=this._getSizeFromUnit(t)},setSpreadRadius:function(t,e){e=e||0,this._shadow[e].spread=this._getSizeFromUnit(t)},setOffset:function(t,e,i){e=e!==void 0?e:t,this.setOffsetX(t,i),this.setOffsetY(e,i)},setOffsetX:function(t,e){e=e||0,this._shadow[e].x=this._getSizeFromUnit(t),this._shadow[e].angle=this._calcAngle(e),this._shadow[e].distance=this._calcDistance(e)},setOffsetY:function(t,e){e=e||0,this._shadow[e].y=this._getSizeFromUnit(t),this._shadow[e].angle=this._calcAngle(e),this._shadow[e].distance=this._calcDistance(e)},setInset:function(t,e){this._shadow[e||0].inset=t?"inset":""},setDistance:function(t,e){e=e||0,this._shadow[e].distance=this._getSizeFromUnit(t),this._shadow[e].x=this._shadow[e].distance*Math.sin(this._shadow[e].angle),this._shadow[e].y=this._shadow[e].distance*Math.cos(this._shadow[e].angle)},setAngle:function(t,e,i){var n=e?Math.PI/180:1;i=i||0,this._shadow[i].angle=t*n||0,this._shadow[i].x=this._shadow[i].distance*Math.sin(this._shadow[i].angle),this._shadow[i].y=this._shadow[i].distance*Math.cos(this._shadow[i].angle)},setUnit:function(t,e){e=e||0,this._shadow[e].unit=Constants.BoxShadow.VALID_UNITS.contains(t)?t:Constants.BoxShadow.VALID_UNITS[0]},getDistance:function(t){return t=t||0,this._shadow[t].distance},getAngle:function(t,e){e=e||0;var i=t?180/Math.PI:1,n=this._modulo(this._shadow[e].angle,2*Math.PI)*i;return t?Math.round(n):n},getColor:function(t){t=t||0;var e=this._shadow[t].color;return Modernizr&&Modernizr.rgba?"rgba("+e.getRgba()+")":e.getHex()},getBlurRadius:function(t){return t=t||0,this._shadow[t].blur},getSpreadRadius:function(t){return t=t||0,this._shadow[t].spread},getOffsetX:function(t){return t=t||0,this._shadow[t].x.toFixed(3)},getOffsetY:function(t){return t=t||0,this._shadow[t].y.toFixed(3)},getInset:function(t){return t=t||0,this._shadow[t].inset},getToggleOn:function(){return this._toggleOn},getThemeString:function(){var t=!0;return this._getCssValueFromShadowObject(t)},getUnit:function(t){return t=t||0,this._shadow[t].unit},getCssValue:function(){return this._toggleOn?this._getCssValueFromShadowObject():""},_calcAngle:function(t){t=t||0;var e={x:this._shadow[t].x,y:this._shadow[t].y},i={x:0,y:0},n={x:i.x,y:i.y-Math.sqrt((e.x-i.x)*(e.x-i.x)+(e.y-i.y)*(e.y-i.y))};return 2*Math.atan2(e.x-n.x,e.y-n.y)},_calcDistance:function(t){t=t||0;var e=this._shadow[t].x||0,i=this._shadow[t].y||0;return Math.sqrt(e*e+i*i)},_getSizeFromUnit:function(t){t+="";var e=parseFloat(t);return e=isNaN(e)?0:e},_parseShadowString:function(t){var e,i,n=[],s=0;if("string"==typeof t){if(e=t.trim().replace(/\s*([\(\)\}\s,])\s*/g,"$1").replace(/([\)\}]|#\w{3,6}),/g,"$1, ").replace(/[,;]$/,""),!e)return"";for(n=e.split(", "),s=0;n.length>s;s++)i=n[s].split(" "),"inset"!=i[0]&&i.unshift(""),this._shadow[s]=[],this.setUnit("px",s),this.setInset(i[0],s),this.setOffset(i[1],i[2],s),this.setBlurRadius(i[3],s),this.setSpreadRadius(i.length>5?i[4]:0,s),this.setColor(i.getLast(),s)}},_getCssValueFromShadowObject:function(t){var e,i=[];for(e=0;this._shadow.length>e;e++)t?i.push([this.getInset(e),this.getOffsetX(e),this.getOffsetY(e),this.getBlurRadius(e),this.getSpreadRadius(e),this.getColor(e)].join(" ").trim()):i.push([this.getInset(e),Math.round(this.getOffsetX(e))+this._shadow[e].unit,Math.round(this.getOffsetY(e))+this._shadow[e].unit,Math.round(this.getBlurRadius(e))+this._shadow[e].unit,Math.round(this.getSpreadRadius(e))+this._shadow[e].unit,this.getColor(e)].join(" ").trim());return i.join(",")},_modulo:function(t,e){return(t%e+e)%e},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.Color",function(t){function e(t,e,i){var n,s,a,r,o,h,l,c;return t%=360,0===i?{r:0,g:0,b:0}:(e/=100,i/=100,t/=60,r=Math.floor(t),o=t-r,h=i*(1-e),l=i*(1-e*o),c=i*(1-e*(1-o)),0===r?(n=i,s=c,a=h):1==r?(n=l,s=i,a=h):2==r?(n=h,s=i,a=c):3==r?(n=h,s=l,a=i):4==r?(n=c,s=h,a=i):5==r&&(n=i,s=h,a=l),n=Math.floor(255*n),s=Math.floor(255*s),a=Math.floor(255*a),{r:n,g:s,b:a})}function i(t,e,i){var n,s,a,r,o,h;return t/=255,e/=255,i/=255,n=Math.min(Math.min(t,e),i),s=Math.max(Math.max(t,e),i),n==s?{h:void 0,s:0,l:100*s}:(a=t==n?e-i:e==n?i-t:t-e,r=t==n?3:e==n?5:1,o=Math.floor(60*(r-a/(s-n)))%360,h=Math.floor(100*((s-n)/s)),s=Math.floor(100*s),{h:o,s:h,l:s})}var n=t;n.methods({initialize:function(t,e,i,n){if("number"==typeOf(i)&&"number"==typeOf(e)&&"number"==typeOf(t))this.setRed(t),this.setGreen(e),this.setBlue(i),this.setAlpha(n);else if("string"==typeOf(t))if(0===t.indexOf("#"))this.setHex(t);else{var s=t.replace(/[rgba\(\)]/g,"");this.setRgba(s)}else this._isUpdateDisabled=!0,t=t||{},this.setRed(t.getRed&&"function"==typeOf(t.getRed)?t.getRed():0),this.setGreen(t.getGreen&&"function"==typeOf(t.getGreen)?t.getGreen():0),this.setBlue(t.getBlue&&"function"==typeOf(t.getBlue)?t.getBlue():0),this.setAlpha(t.getAlpha&&"function"==typeOf(t.getAlpha)?t.getAlpha():1),this._isUpdateDisabled=!1,this._updateHsb()},invert:function(){return this.getInvertColor()},saturation:function(t){return this.setSaturation(t*(this._s/100)),this},luminous:function(t){return this.setLuminous(t*(this._l/100)),this},alpha:function(t){return this.setAlpha(t*(this._a/100)),this},maxSaturation:function(t){return this._s>t&&this.setSaturation(t),this},minSaturation:function(t){return t>this._s&&this.setSaturation(t),this},maxLuminous:function(t){return this._l>t&&this.setLuminous(t),this},minLuminous:function(t){return t>this._l&&this.setLuminous(t),this},getHex:function(t){var e="#"+this._formatHexColor(this._r)+this._formatHexColor(this._g)+this._formatHexColor(this._b);return t&&(e+=this._formatHexColor(255*this._a)),e},getRgb:function(){return this._r+","+this._g+","+this._b},getRgba:function(){return this.getRgb()+","+this.getAlpha()},getRed:function(){return this._getValue(this._r,0)},getGreen:function(){return this._getValue(this._g,0)},getBlue:function(){return this._getValue(this._b,0)},getAlpha:function(){return this._getValue(this._a,1,2)},getHue:function(){return this._getValue(this._h,0)},getSaturation:function(){return this._getValue(this._s,100)},getLuminous:function(){return this._getValue(this._l,100)},getInvertColor:function(){return new this.$class([255-this._r,255-this._g,255-this._b].join(","))},_getValue:function(t,e,i){var n=t||0===t?t:e;return 0!==n&&1!==n&&"number"==typeof i&&"number"==typeof n&&(n=n.toFixed(i),n=Number(n)),n},setRed:function(t){this._r=this._validateValue(t,0,255,0),this._updateHsb()},setGreen:function(t){this._g=this._validateValue(t,0,255,0),this._updateHsb()},setBlue:function(t){this._b=this._validateValue(t,0,255,0),this._updateHsb()},setAlpha:function(t){this._a=this._validateValue(t,0,1,1)},setHue:function(t){this._h=this._validateValue(t,0,360,0),this._updateRgb()},setSaturation:function(t){this._s=this._validateValue(t,0,100,100),this._updateRgb()},setLuminous:function(t){this._l=this._validateValue(t,0,100,100),this._updateRgb()},setHex:function(t){"#"==t.charAt(0)&&(t=t.substr(1)),this._isUpdateDisabled=!0,this.setRed(parseInt(t.substr(0,2),16)),this.setGreen(parseInt(t.substr(2,2),16)),this.setBlue(parseInt(t.substr(4,2),16));var e=parseInt(t.substr(6,2),16);isNaN(e)&&this._a||this.setAlpha(0===e?0:e/255),this._isUpdateDisabled=!1,this._updateHsb()},setRgba:function(t){this._isUpdateDisabled=!0;var e=this._formatSplitValue(t,["r","g","b","a"]);this.setRed(e.r),this.setGreen(e.g),this.setBlue(e.b),this.setAlpha(e.a),this._isUpdateDisabled=!1,this._updateHsb()},setHsl:function(t){this._isUpdateDisabled=!0;var e=this._formatSplitValue(t,["h","s","l"]);this.setHue(e.h),this.setSaturation(e.s),this.setLuminous(e.l),this._isUpdateDisabled=!1,this._updateRgb()},_formatSplitValue:function(t,e){var i={};if("string"==typeOf(t)&&(t=t.split(",")),"array"==typeOf(t))for(var n=0;e.length>n;++n)i[e[n]]=t[n];return i},_validateValue:function(t,e,i,n){return t=isNaN(t)?parseFloat(t):t,0!==t&&(t=t||n||e),t=isNaN(t)?t:Number((t+"").trim()),(isNaN(t)||t>i)&&(t=i),e>t&&(t=e),t},_formatHexColor:function(t){for(t=t||"00","number"==typeOf(t)&&(t=Math.round(t),t=t.toString(16));2>t.length;)t="0"+t;return t.toUpperCase()},_updateHsb:function(){if(this._isUpdateDisabled!==!0){var t=i(this._r,this._g,this._b);this._h=t.h||0,this._s=t.s||0,this._l=t.l||0}},_updateRgb:function(){if(this._isUpdateDisabled!==!0){var t=e(this._h,this._s,this._l);this._r=t.r,this._g=t.g,this._b=t.b}},toString:function(){return this.getHex(!1)}})}),define.Class("core.utils.css.Font",function(t){var e=t;e.utilize(["core.utils.css.Color"]),e.methods({initialize:function(t,e){if(this.setThemeManager(e),"string"==typeOf(t))this._parseFontString(t);else{var i=t||{};if(this.setStyle(i.getStyle&&"function"==typeOf(i.getStyle)?i.getStyle():void 0),this.setVariant(i.getVariant&&"function"==typeOf(i.getVariant)?i.getVariant():void 0),this.setWeight(i.getWeight&&"function"==typeOf(i.getWeight)?i.getWeight():void 0),this.setSize(i.getSize&&"function"==typeOf(i.getSize)?i.getSize():void 0),this.setLineHeight(i.getLineHeight&&"function"==typeOf(i.getLineHeight)?i.getLineHeight():void 0),this.setFontFamily(i.getFontFamily&&"function"==typeOf(i.getFontFamily)?i.getFontFamily():void 0),i.getColorReference&&"function"==typeOf(i.getColorReference)&&""!==i.getColorReference())this.setColorReference(i.getColorReference());else{var n=i.getColor&&"function"==typeOf(i.getColor)?i.getColor():"#000000";this.setColor(n)}}},getThemeString:function(){var t="theme"===this._colorSource?"{"+this.getColorReference()+"}":this.getColor();return[this._style,this._variant,this._weight,this.getSize()+"/"+this.getLineHeight(),this.getFontFamilyWithNoSpaces(),t].join(" ")},getCssRule:function(){return["font:",this.getCssValue(),"; color:",this.getColor()].join(" ")},getCssValue:function(){var t=this.getFontFamilyWithFallbacks();return[this._style,this._variant,this._weight,this.getSize()+"/"+this.getLineHeight(),t].join(" ")},getStyle:function(){return this._style},getVariant:function(){return this._variant},getWeight:function(){return this._weight},getSize:function(){return this._fontSize+this._fontUnit},getLineHeight:function(){return this._lineHeightSize+this._lineHeightUnit},getFontFamily:function(){return this._fontFamily},getFontFamilyWithNoSpaces:function(){return this._fontFamily.replace(/\s/g,"+")},getFontFamilyWithFallbacks:function(){return W.Css.getFontFallbacksCss(this._fontFamily)},getColorReference:function(){return this._colorName},getColor:function(){return this._color},_parseFontString:function(t){var e=t.split(" "),i=e[3]?e[3].split("/"):[];this.setStyle(e[0]),this.setVariant(e[1]),this.setWeight(e[2]),this.setSize(i[0]),this.setLineHeight(i[1]),this.setFontFamily(e[4]),this._setColor(e[5])},setThemeManager:function(t){this._themeManager=t},setStyle:function(t){t=Constants.FONT.STYLE.contains(t)?t:Constants.FONT.STYLE[0],this._style=t},setVariant:function(t){t=Constants.FONT.VARIANT.contains(t)?t:Constants.FONT.VARIANT[0],this._variant=t},setWeight:function(t){t=Constants.FONT.WEIGHT.contains(t)?t:Constants.FONT.WEIGHT[0],this._weight=t},setSize:function(t){var e=this._seperateSizeFromUnit(t);this._fontSize=e.size,this._fontUnit=e.unit},setLineHeight:function(t){var e=this._seperateSizeFromUnit(t);this._lineHeightSize=e.size,this._lineHeightUnit=e.unit},setFontFamily:function(t){t=t&&t.replace(/\+/g," ");var e=W.Css.getFontType(t);e||(t=W.Css.getDefaultFont(),e="system"),this._fontFamily=t},setColorReference:function(t){this._colorSource="theme",this._colorName=t,this._color=new this.imports.Color(this._themeManager&&this._themeManager.getProperty(t)).getHex()},setColor:function(t){this._colorSource="value",this._colorName="",this._color=new this.imports.Color(t).getHex()},_setColor:function(t){var e="",i=t&&(t.test(/\{.+\}/)||t.test(/\[.+\]/));t&&i?(e=i&&t.substring(1,t.length-1)||t,this.setColorReference(e)):this.setColor(t)},_seperateSizeFromUnit:function(t){t+="";var e=parseFloat(t),i=t.split(e+"").join("");return e=isNaN(e)?this._getDefaultFontSize():e,i=Constants.FONT.UNITS.contains(i)?i:this._getDefaultFontUnit(),{unit:i,size:e}},_getDefaultFontSize:function(){return this._fontSize?this._fontSize:12},_getDefaultFontUnit:function(){return this._fontUnit?this._fontUnit:Constants.FONT.UNITS[0]},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.Size",function(t){var e=t;e.statics({UNITS:["px","%","em"],DEFAULT_AMOUNT_FOR_UNIT:{px:12,"%":100,em:1}}),e.methods({initialize:function(t){if("string"==typeOf(t))this._parseSizeString(t);else{var e=t||{};this.setUnit(e.getUnit&&"function"==typeOf(e.getUnit)?e.getUnit():void 0),this.setAmount(e.getAmount&&"function"==typeOf(e.getAmount)?e.getAmount():void 0)}},multiply:function(t){return this._amount*=t,this},decrease:function(t){return this._amount-=t,this},increase:function(t){return this._amount+=t,this},getThemeString:function(){return this.getCssValue()},getCssRule:function(){return this.getCssValue()},getCssValue:function(){return this._amount+this._unit},getAmount:function(){return this._amount},getUnit:function(){return this._unit},add:function(t){var e=new this.$class(t);this._unit===e.getUnit()&&(this._amount+=e.getAmount())},_parseSizeString:function(t){var e=this._seperateAmountFromUnit(t);this.setAmount(e.amount),this.setUnit(e.unit)},setAmount:function(t){this._amount=t||0===t?t:this._getDefaultAmountForUnit(this._unit)},setUnit:function(t){this._unit=t||this._getDefaultUnit()},_seperateAmountFromUnit:function(t){t+="";var e=parseFloat(t),i=t.split(e+"").join("");return i=this.UNITS.contains(i)?i:this._getDefaultUnit(),e=isNaN(e)?this._getDefaultAmountForUnit(i):e,{unit:i,amount:e}},_getDefaultAmountForUnit:function(t){return this.DEFAULT_AMOUNT_FOR_UNIT[t]||1},_getDefaultUnit:function(){return this._unit?this._unit:this.UNITS[0]},toString:function(){return this.getCssValue()}})}),define.Const("Background",{VALID_WIDTH:["auto","contain","cover"],VALID_POSITION_X:["left","right","center"],VALID_POSITION_Y:["top","bottom","center"],VALID_ATTACHMENT:["scroll","fixed"],VALID_REPEAT:["repeat","no-repeat"],DEFAULT_PYRAMID_SIZE:1920}),define.Const("BorderRadius",{VALID_UNITS:["px","%","em"]}),define.Const("BoxShadow",{VALID_UNITS:["px"]}),define.Const("FONT",{STYLE:["normal","italic"],VARIANT:["normal","small-caps","inherit"],WEIGHT:["normal","bold","bolder","lighter"],UNITS:["px","em","pt","ex","in","cm","mm","pc"]}),define.bootstrapClass("core.utils.Wixify",function(){function t(t,e,i){this._requiredParams={compData:null,compProperties:null,idPrefix:null,logicClass:null,skinClass:null,dataInstance:null,viewNode:null,style:null},this._wixifyDone=!1,this._wixifyCallback=t,this._paramsSet={},this._className=i,this._startTime=(new Date).getTime(),this._wixifyTimeout=e?e:h}var e={getType:function(){return""}},i=function(t){t.viewNode.$logic||(t.logicClass.NEW_BASE_COMP===!0?n(t):a(t))},n=function(t){var i=t.logicClass,n=t.skinClass,a=t.dataInstance,o=t.viewNode,h=t.compProperties,l=t.style||t.compData.innerStyle,c=s(i,o,t.idPrefix,t.compData.argsObject);W.ComponentLifecycle.registerComponent(c),a&&a!==e&&c.setDataItem(a),h&&c.setComponentProperties(h);var d=new n;l&&d.setParamMapper(l),c.setSkin(d),r(o)},s=function(t,e,i,n){var s=e.getProperty("id")||o(t,i),a=new t(s,e,n);return e.$logic=a,e.getLogic=function(){return a},a},a=function(t){t.dataInstance||(t.dataInstance=e);var i=t.viewNode.getProperty("id")||o(t.logicClass,t.idPrefix),n=new t.logicClass(i,t.viewNode,t.compData.argsObject),s=new t.skinClass;t.compData.innerStyle&&s.applyStyle(t.compData.innerStyle),t.style?n.initSkinAndStyle(s,t.style):n.setSkin(s);var a=n.getAcceptableDataTypes(),h=t.dataInstance.getType();t.compProperties&&n.setComponentProperties(t.compProperties),-1!=a.indexOf(h)?t.dataInstance!==e&&n.setDataItem(t.dataInstance):LOG.reportError(wixErrors.WIXIFY_INVALID_DATA_TYPE,"wrong data type",h,", data type: "+h+", acceptable types: "+a+", component: "+n.className),t.viewNode.$logic=n,t.viewNode.getLogic=function(){return n},r(t.viewNode)},r=function(t){t.fireEvent(Constants.ComponentEvents.WIXIFIED,t.$logic),t.$logic.fireEvent(Constants.ComponentEvents.WIXIFIED,t.$logic),t.trigger&&t.trigger(Constants.ComponentEvents.WIXIFIED,t.$logic),t.$logic.trigger&&t.$logic.trigger(Constants.ComponentEvents.WIXIFIED,t.$logic)},o=function(t,e){e=e?e+"___":"";var i=t.prototype.className,n=i.lastIndexOf(".");return i=n>-1?i.substr(n):i,W.Utils.getUniqueId(e+i)};Element.implement({wixify:function(n,s,a,r,o){var h,l,c,d,u,_,p;h=this.getProperty("comp"),l=this.getProperty("skin"),c=this.getProperty("dataQuery"),d=this.getProperty("propertyQuery"),_={argsObject:n,innerStyle:o},p=this.getProperty("styleId"),!r&&Constants.WixifyTimeOut&&(r=Constants.WixifyTimeOut);var m=new t(i,r,h);if(p)W.Theme.getStyle(p,function(t){m.setParam("style",t),W.Skins.getSkin(t.getSkin(),m.getAsyncSetterFor("skinClass"))},l);else{if(m.setParam("style",void 0),!l)return LOG.reportError(wixErrors.WIXIFY_NO_SKIN,"Element","wixify",h),void 0;W.Skins.getSkin(l,m.getAsyncSetterFor("skinClass"))}if(!h)return LOG.reportError(wixErrors.WIXIFY_NO_COMP,"Element","wixify",h),void 0;if(this.getLogic)return LOG.reportError(wixErrors.WIXIFY_ALREADY_WIXIFIED,"Element","wixify",h),void 0;if(u=this,u.fireEvent("wixifyStarted"),m.setParam("viewNode",u),m.setParam("idPrefix",a),m.setParam("compData",_),s)m.setParam("dataInstance",s);else if(c){var g,f=this.getProperty("dataQuerySource");g=f&&"preview"==f&&W.Editor?W.Preview.getPreviewManagers().Data:W.Data,g.getDataByQuery(c,m.getAsyncSetterFor("dataInstance"))}else m.setParam("dataInstance",e);return d?(this.isTimedOut=!1,this.propQueryTimer=setTimeout(function(){this.isTimedOut=!0,m.setParam("compProperties",void 0)}.bind(this),1e4),W.ComponentData.getDataByQuery(d,function(t){this.isTimedOut||(clearTimeout(this.propQueryTimer),m.getAsyncSetterFor("compProperties")(t))}.bind(this))):m.setParam("compProperties",void 0),W.Components.getComponent(h,m.getAsyncSetterFor("logicClass")),m.run(),this}}),Elements.implement({wixify:function(t,e){for(var i=this.length-1;i>-1;--i)this[i].wixify(t,e);return this}});var h=2e3;return t.prototype={_timedOut:null,_timeOutId:null,run:function(){this._wixifyDone||(this._timeOutHandler=setTimeout(function(){this._clearTimeout(),this._onWixifyTimeout()}.bind(this),this._wixifyTimeout))},_clearTimeout:function(){clearTimeout(this._timeOutHandler)},setParam:function(t,e){if(!this._requiredParams.hasOwnProperty(t))throw"this wixifier is not waiting for a parameter named "+t;this._requiredParams[t]=e,this._paramsSet[t]=(new Date).getTime()-this._startTime,this._checkIfEverythingIsThere()},getAsyncSetterFor:function(t){return function(e){this.setParam(t,e)}.bind(this)},_checkIfEverythingIsThere:function(){var t=!0;for(var e in this._requiredParams)if(this._requiredParams.hasOwnProperty(e)&&void 0===this._paramsSet[e]){t=!1;break}t&&this._onAllWixifyParamsReady()},_onAllWixifyParamsReady:function(){if(!this._wixifyDone&&(this._wixifyDone=!0,this._clearTimeout(),this._wixifyCallback&&this._wixifyCallback(this._requiredParams),this._timedOut)){var t=(new Date).getTime()-this._startTime;
LOG.reportError(wixErrors.WIXIFY_FINISHED_AFTER_TIMEOUT,t,this._timeOutId,t)}},_onWixifyTimeout:function(){this._timedOut=(new Date).getTime()-this._startTime,this._timeOutId="["+this._className+":"+this._timedOut+"]";var t=this._requiredParams,e=this._paramsSet,i=[];for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&i.push(n);var s="Time: "+this._wixifyTimeout+". missing: "+i.join(",");W.Utils.debugTrace("Wixify Error",this._className,this._timeOutId,s),1==i.length&&"compProperties"==i[0]&&(LOG.reportError(wixErrors.WIXIFY_TIMEOUT,this._className,this._timeOutId,s),this._onAllWixifyParamsReady())},toString:function(){return"[Wixifier]"}},function(){}}),define.dataSchema("Button",{label:"resourceKey",toggleMode:"boolean",disabled:"boolean",iconSrc:"string",command:"string",commandParameter:"string",action:"string"}),define.dataSchema("Document",{renderModifiers:"object",name:"string",mainPage:"ref",mainPageId:"string",pages:"refList"}),define.dataSchema("FlatTheme",{THEME_DIRECTORY:{type:"themeUrl","default":"base"},BG_DIRECTORY:{type:"themeUrl","default":"base"},CONTACT_DIRECTORY:{type:"themeUrl","default":"base"},NETWORKS_DIRECTORY:{type:"themeUrl","default":"base"},EXTERNAL_LINKS_DIRECTORY:{type:"themeUrl","default":"base"},PAGES_DIRECTORY:{type:"themeUrl","default":"base"},WEB_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},font:{type:"font-family","default":"Arial,sans-serif"},bgId:{type:"imageId","default":"BG_USES_THEME_IMAGE"},bgSize:{type:"size","default":","},bgType:{type:"bgMode","default":"BG_USES_THEME_IMAGE"},siteBgColor:{type:"color","default":"0,0,0,1"},headerTextColor:{type:"color","default":"255,255,255,1"},headerBgColor:{type:"color","default":"0,0,0,0"},textColor:{type:"color","default":"255,255,255,1"},areaBgColor:{type:"color","default":"130,81,13,1"},iconBgColor:{type:"color","default":"255,255,255,1"},borderColor:{type:"color","default":"255,255,255,1"},fontHeader:{type:"font","default":"normal normal bold 2.4em/1.0em [font] {headerTextColor}"},fontTitle:{type:"font","default":"italic normal bold 2.0em/2.0em [font] {siteBgColor}"},fontSubTitle:{type:"font","default":"normal normal bold 1.2em/1.4em [font] {siteBgColor}"},fontButton:{type:"font","default":"normal normal bold 1.4em/2.2em [font] {areaBgColor}"},fontText:{type:"font","default":"normal normal normal 1.1em/1.1em [font] {siteBgColor}"},fontSmallText:{type:"font","default":"normal normal normal 0.5em/0.7em [font] {siteBgColor}"},borderContainer:{type:"border","default":"0.15em solid [borderColor]"},borderThumb:{type:"border","default":"0.15em solid [borderColor]"},borderButton:{type:"border","default":"0.15em solid [borderColor]"},borderIcon:{type:"border","default":"0.15em solid [borderColor]"},radiusContainer:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusThumb:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusButton:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusIcon:{type:"radius","default":"0.6em 0.0em 0.0em 0.6em"},padding1:{type:"padding","default":"1em 1em 1em 1em"},padding2:{type:"padding","default":"0.0em 0.5em 0.0em 0.5em"},padding3:{type:"padding","default":"1.0em 0.0em 1.0em 0.0em"},iconSize:{type:"number","default":"3.2"},bulletSize:{type:"number","default":"1.5"},headerSpacing:{type:"number","default":"0em"},componentSpacing:{type:"number","default":"0.45em"},itemSpacing:{type:"number","default":"0.75em"},thumbSpacing:{type:"number","default":"0.23em"},iconSpacing:{type:"number","default":"0.75em"}}),define.dataSchema("Header",{title:"string",imageSize:{type:"string","default":"medium"},image:"ref"}),define.dataSchema("Image",{"extends":"Link",title:"string",uri:"string",description:"string",height:"number",width:"number",borderSize:"string",alt:"string",originalImageDataRef:{type:"ref",description:"Original Image before edit","default":null}}),define.dataSchema("ImageList",{items:"refList"}),define.dataSchema("Link",{linkType:{type:"string","default":"FREE_LINK"},href:"string",text:"string",target:"string",icon:"string"}),define.dataSchema("TextLink",{linkType:{type:"string","default":"FREE_LINK"},href:"string",text:"string",target:"string",icon:"string"}),define.dataSchema("LinkList",{items:"refList",subType:"string"}),define.dataSchema("MediaItem",{componentType:"string",dateCreated:"string",description:"",fileName:"string",fileSize:"number",height:"number",width:"number",iconURL:"string",mediaType:"string",mimeType:"string",originalFileName:"string",sourceURL:null,tags:null,title:"",version:null}),define.dataSchema("MenuItem",{text:"string",refId:"ref",items:"list"}),define.Class("core.datatypes.NavigationTreeDataClass",function(t){var e=t;e.inherits("core.managers.data.DataItemBase"),e.resources(["W.Data"]),e.methods({initialize:function(t,e){var i=t.items,n=[];i&&this._convertRawItemsToMenuItems(i,n),t.items=n,this.parent(t,e)},_convertRawItemsToMenuItems:function(t,e){for(var i=0;t.length>i;i++){var n=t[i],s={refId:n.refId,items:[],type:"MenuItem"},a=this.resources.W.Data.createDataItem(s);e.push(a),n.items&&n.items.length>0&&this._convertRawItemsToMenuItems(n.items,a.get("items"))}},getItems:function(){return this._data.items||(this._data.items=[]),this._data.items},getAllItems:function(){var t=this.getItems(),e=[];return this._collectInternalItems(t,e)},getSubItems:function(t){var e=t.get("items"),i=[];return this._collectInternalItems(e,i)},_collectInternalItems:function(t,e){for(var i=0;t.length>i;i++){var n=t[i];e.push(n),this._collectInternalItems(n.get("items"),e)}return e},getItemByRefId:function(t){var e=this.getItems();return this._getItemFromItemsByRefId(e,t)},_getItemFromItemsByRefId:function(t,e){for(var i=0;t.length>i;i++){var n=t[i];if(n.get("refId")==e)return n;if(n.get("items")&&n.get("items").length>0){var s=this._getItemFromItemsByRefId(n.get("items"),e);if(s)return s}}},addItem:function(t,e,i){e?this._addSubItem(t,e,i):"number"==typeof i?this.getItems().splice(i,0,t):this.getItems().push(t)},_addSubItem:function(t,e,i){var n=this.getItemByRefId(e),s=n.get("items");"number"==typeof i?s.splice(i,0,t):s.push(t)},_createNavigationItem:function(t){var e={refId:t,items:[],type:"MenuItem"};return this.resources.W.Data.createDataItem(e)},createAndAddNavigationItem:function(t,e,i){var n=this._createNavigationItem(t),s=this.getItemByRefId(e);this.addItem(n,e,i),this.fireDataChangeEvent({cause:"CREATED_AND_ADDED",parentItem:s,item:n})},deleteNavigationItem:function(t){var e=this.getItemByRefId(t),i=this.getItemParent(e,this),n=i.get("items"),s=e.get("items"),a=n.indexOf(e);if(s)for(var r=0;s.length>0;){var o=s[0];this._moveItem(o,i,a+r),r++}n.erase(e),this.fireDataChangeEvent({cause:"DELETE",item:e})},getItemLevel:function(t,e,i){var n;n=e?e.get("items"):this.getItems(),i||(i=0);for(var s=0;n.length>s;s++){var a=n[s];if(a==t)return i;if(a.get("items")&&a.get("items").length>0){var r=this.getItemLevel(t,a,i+1);if("number"==typeof r)return r}}},moveItemToParentAtIndex:function(t,e,i){this._moveItem(t,e,i),this.fireDataChangeEvent({cause:"MOVE",parentItem:e,item:t,newIndex:i})},_moveItem:function(t,e,i){var n=e?e.get("refId"):null,s=this.getItemParent(t,this),a=s.get("items");a.erase(t),this.addItem(t,n,i)},getItemParent:function(t,e){e=e||this;for(var i=e.get("items"),n=0;i.length>n;n++){var s=i[n];if(s==t)return e;if(s.get("items")&&s.get("items").length>0){var a=this.getItemParent(t,s);if(a)return a}}},isSubItemByRefId:function(t){var e=this.getItemByRefId(t),i=this.getItemParent(e);return i==this?!1:!0},getItemParentByRedId:function(t){var e=this.getItemByRefId(t);return this.getItemParent(e)},fireDataChangeEvent:function(t){this._dataManager.markDirtyObject(this),this._dataManager.flagDataChange(),this.fireEvent(Constants.DataEvents.DATA_CHANGED,t)},cloneData:function(){var t={},e=[];return t.type=this._dataType,t.metaData=this._data.metaData,t.id="MAIN_MENU",this.cloneItems(this.getItems(),e),t.items=e,t},cloneItems:function(t,e){for(var i=0;t.length>i;i++){var n=t[i],s=this.cloneSingleItem(n);e.push(s),n.get("items")&&n.get("items").length>0&&this.cloneItems(n.get("items"),s.items)}},cloneSingleItem:function(t){return{refId:t.get("refId"),items:[]}},isReady:function(){if(this._isReady)return!0;var t=this.getWaitingForReadyList();return this._isReady=t.length>0?!1:!0,this._isReady},getWaitingForReadyList:function(){var t=[],e=this.getAllItems();this.getDataManager();for(var i=0;e.length>i;i++){var n=e[i],s=n.get("refId"),a=this.resources.W.Data.isDataAvailable(s);a||t.push(s)}return t}})}),define.dataSchema("Menu",{dataClassRef:"core.datatypes.NavigationTreeDataClass"}),define.dataSchema("Page",{title:"string",hideTitle:"boolean",icon:"string",windowTitle:"string",descriptionSEO:"string",metaKeywordsSEO:"string",pageTitleSEO:"string",pageUriSEO:"string",hidePage:"boolean",underConstruction:"boolean",tpaApplicationId:"number",pageSecurity:{type:"object","default":{requireLogin:!1,passwordDigest:""}}}),define.dataSchema("RichText",{text:"string",defaultStyle:"string"}),define.dataSchema("RichTextImage",{text:"ref",image:"ref"}),define.dataSchema("Service",{title:"string",description:"string",image:"ref"}),define.dataSchema("ServiceList",{serviceType:"string",items:"refList"}),define.dataSchema("Text",{text:{type:"string","default":"asdf"}}),define.dataSchema("Theme",{properties:"object"}),define.dataSchema("TopLevelStyle",{skin:"string",style:"object",styleType:{type:"string","enum":["system","custom","userDefined"],description:"type of the style, defaults to system style","default":"system"},pageId:{type:"string",description:"for custom styles - id of the page where the component is"},compId:{type:"string",description:"for custom styles - id of the component that has the custom style"},componentClassName:{type:"string",description:"class name of the component type this style applies to"}}),define.dataSchema("TwitterFollow",{accountToFollow:{type:"string","default":"wix"}}),define.dataSchema("TwitterTweet",{defaultText:"string",accountToFollow:"string"}),define.dataSchema("WFlatTheme",{THEME_DIRECTORY:{type:"themeUrl","default":"base"},BG_DIRECTORY:{type:"themeUrl","default":"base"},CONTACT_DIRECTORY:{type:"themeUrl","default":"base"},NETWORKS_DIRECTORY:{type:"themeUrl","default":"base"},EXTERNAL_LINKS_DIRECTORY:{type:"themeUrl","default":"base"},PAGES_DIRECTORY:{type:"themeUrl","default":"base"},WEB_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},BASE_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},siteBg:{type:"background","default":"none 0 0 center center auto repeat no-repeat fixed {color_2}"},color:{type:"array",itemType:"color",defaultItems:["#000000","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#333333","#666666","#999999","#AAAAAA","#DCDCDC","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},font:{type:"array",itemType:"font",defaultItems:["normal normal normal 24px/1.2em Arial {color_5}","normal normal bold 16px/1.1em Arial {color_5}","italic normal bold 18px/1.1em Lobster {color_5}","normal normal bold 22px/1.1em Arial {color_5}","normal normal bold 20px/1.1em Arial {color_5}","normal normal normal 18px/1.3em Arial {color_5}","normal normal normal 16px/1.2em Arial {color_6}","normal normal normal 14px/1.3em Arial {color_6}","normal normal normal 12px/1.3em Arial {color_6}","normal normal normal 10px/1.3em Arial {color_6}","normal normal normal 8px/1.3em Arial {color_6}"]},border:{type:"array",itemType:"border",defaultItems:["0.15em solid [color_0]","0.15em solid [color_0]","0.15em solid [color_0]"]},padding1:{type:"padding","default":"0 0 0 0"},padding2:{type:"padding","default":"0.0em 0.5em 0.0em 0.5em"},padding3:{type:"padding","default":"1.0em 0.0em 1.0em 0.0em"},iconSize:{type:"number","default":"3.2"},bulletSize:{type:"number","default":"1.5"},headerSpacing:{type:"number","default":"0em"},componentSpacing:{type:"number","default":"0.45em"},itemSpacing:{type:"number","default":"0.75em"},thumbSpacing:{type:"number","default":"0.23em"},iconSpacing:{type:"number","default":"0.75em"}}),define.dataSchema("testType",{}),define.dataSchema("TemplateList",{id:"string",name:"string",previewSource:"string"}),define.dataSchema("PhotoProperties",{imageSize:{type:"string","enum":["small","medium","large"],"default":"medium",description:"size of the image in runtime"}}),define.Class("core.managers.ConfigurationManager",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.methods({_getEditorModel:function(){return window.editorModel},getEditorModelProperty:function(t){var e=this._getEditorModel();return e&&e[t]},getRendererModelProperty:function(t){return window.rendererModel&&window.rendererModel[t]},getEditedSiteLoadTimeVersion:function(){return this._getEditorModel().siteHeader.version},getLocationMapProperty:function(t){return window.serviceTopology&&window.serviceTopology.scriptsLocationMap&&window.serviceTopology.scriptsLocationMap[t]},getServiceTopologyProperty:function(){return function(t){var e={scriptsRoot:this.getLocationMapProperty("web")+"/",staticSkinUrl:this.getLocationMapProperty("skins")+"/",staticThemeUrl:this.getLocationMapProperty("web")+"/images/mobile/core/themes",staticThemeUrlWeb:this.getLocationMapProperty("skins")+"/images/wysiwyg/core/themes"};return window.serviceTopology&&(e[t]||window.serviceTopology[t])}}(),getImagesUrl:function(){var t=window.serviceTopology&&window.serviceTopology.scriptsLocationMap;return(t.web||t["html-wysiwyg"])+"/images"},getCoreThemesUrl:function(){var t=window.serviceTopology&&window.serviceTopology.scriptsLocationMap;return(t.core||t["html-client-core"])+"/images/core/themes"},getHelpServerUrl:function(){var t=this.getServiceTopologyProperty("helpServer")||"http://help.wixpress.com/support/main/html5";return window.wixEditorLangauge&&"en"!==window.wixEditorLangauge&&(t=t.replace("www",window.wixEditorLangauge)),t},setServiceTopologyProperty:function(t,e){window.serviceTopology[t]=e},getUserPublicUrl:function(){return this.getEditorModelProperty("publicUrl")},getUserDomainListUrl:function(){var t=this.getServiceTopologyProperty("premiumServerUrl");return t+"/wix/api/domainConsole"},getSiteId:function(){return window.siteId},getMetaSiteId:function(){return this.getEditorModelProperty("metaSiteId")||this.getRendererModelProperty("metaSiteId")},isMetaSiteTemplate:function(){return this.getEditorModelProperty("metaSiteTemplate")||!1},siteNeverSavedBefore:function(){return this.getEditorModelProperty("firstSave")},setMetaSiteId:function(t){window.editorModel.metaSiteId=t},userHasFacebookSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_FACEBOOK)},userHasMobileSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_MOBILE)},userHasWebSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_WEB)},_userHasAppType:function(t){var e=this.getEditorModelProperty("serviceMappings");if(!e)return!1;for(var i in e)if(e[i].applicationType==t)return!0;return!1},isPremiumUser:function(){var t=this.getEditorModelProperty("metaSiteData");return t&&t.premiumFeatures?t.premiumFeatures.length>0:!1},getCreateMobileSiteLink:function(){var t=this.getServiceTopologyProperty("createMobileUrl"),e=this.getEditorModelProperty("metaSiteData").siteName,i=this.getMetaSiteId(),n=t+e+"?flashSiteId="+i;return n},getCreateFacebookSiteLink:function(){return this._getCreateWysiwygSiteLink(Constants.WEditManager.SITE_TYPE_FACEBOOK)},getCreateWebsiteLink:function(){return this._getCreateWysiwygSiteLink(Constants.WEditManager.SITE_TYPE_WEB)},_getCreateWysiwygSiteLink:function(t){var e=t==Constants.WEditManager.SITE_TYPE_WEB?this.getServiceTopologyProperty("createWebsiteUrl"):this.getServiceTopologyProperty("createFacebookUrl"),i=this.getMetaSiteId(),n=e+"?metasite="+i;return n},isInDebugMode:function(){return"nodebug"!==window.debugMode},isFacebookSite:function(){var t=this.getApplicationType();return t&&"htmlfacebook"===t.toLowerCase()},getDebugMode:function(){return window.debugMode},getApplicationType:function(){return window.rendererModel&&window.rendererModel.applicationType||window.siteHeader&&window.siteHeader.applicationType},getDocumentType:function(){return window.siteHeader&&window.siteHeader.documentType},getMediaStaticUrl:function(t){var e=this.getServiceTopologyProperty("staticMediaUrl")+"/";return"ico"==/[^.]+$/.exec(t)[0]&&(e=e.replace("media","ficons")),e},getResourcesStaticUrl:function(){var t=this.getServiceTopologyProperty("resourcesRoot");return t||this.getServiceTopologyProperty("scriptsRoot")+"/resources/wysiwyg/bundles/"},getLanguage:function(){return window.wixEditorLangauge||this.getEditorModelProperty("languageCode")},isReady:function(){return!0},clone:function(t){return this.parent(t)},createPackage:function(){},getCurrentOrigin:function(){var t="http://"+window.location.host;return t},getMetaSiteData:function(){return this.getEditorModelProperty("metaSiteData")},getPremiumFeatures:function(){var t=this.getRendererModelProperty("premiumFeatures");if(!t){var e=this.getMetaSiteData();t=e&&e.premiumFeatures}return t},getRunningExperiments:function(){return this.getEditorModelProperty("runningExperiments")||this.getRendererModelProperty("runningExperiments")},isPublicMode:function(){return!!window.publicModel},isPreviewMode:function(){return!this.isPublicMode()&&!this.isEditorMode()},isEditorMode:function(){return!!window.editorModel}})}),define.Class("core.managers.LinkTypesManager",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.fields({langFlag:!1,_allTypes:{FACEBOOK:{target:"http://www.facebook.com/wix",text:"Facebook",linkType:["EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},LINKEDIN:{target:"http://www.linkedin.com/wix",text:"LinkedIn",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},TWITTER:{target:"http://www.twitter.com/wix",text:"Twitter",linkType:["EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},CALL:{target:"212.000.0000",text:"Call Me",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"tel:",tip:"call"},SMS:{target:"212.000.0000",text:"Text Me",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"sms:",tip:"text"},EMAIL:{target:"feedback@wix.com",text:"Email",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"mailto:",tip:"send an email to"},MAP:{target:"wix offices new york",text:"Address",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"http://maps.google.com/maps?f=q&source=s_q&hl=en&q=",tip:"open map for address "},BLOGGER:{target:"http://www.blogger.com/wix",text:"Blogger",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},YOUTUBE:{target:"http://www.youtube.com/wix",text:"Youtube",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},FREE_LINK:{target:"http://www.wix.com",text:"Any link",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},FLICKR:{target:"http://www.flickr.com/wix",text:"Flickr",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},SKYPE:{target:"http://www.skype.com/wix",text:"Skype",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},MYSPACE:{target:"http://www.myspace.com/wix",text:"MySpace",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},VIMEO:{target:"http://www.vimeo.com/wix",text:"Vimeo",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},DELICIOUS:{target:"http://www.delicious.com/wix",text:"Delicious",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"}}}),e.methods({getLinkTypesByMeta:function(t){var e;if(this.langFlag===!1){for(e in this._allTypes)this._allTypes[e].text=W.Resources.get("EDITOR_LANGUAGE",e+"_TITLE");this.langFlag=!0}var i=[],n={},s=!0;for(e in this._allTypes)i=this._allTypes[e].linkType,i.indexOf(t)>=0&&(n[e]=this._allTypes[e],s=!1);return 1==s&&LOG.reportError(wixErrors.LT_LINK_UNKNOWN,"LinkTypesManager","getLinkTypesByMeta",t+""),n},getNewLink:function(t){this._allTypes[t]||LOG.reportError(wixErrors.LT_INVALID_LINK_TYPE,"LinkTypesManager","getNewLink",t+"");var e=Object.clone(this._allTypes[t]);return e.metaData={isPreset:!0},e.linkType=t,e.type="Link",delete e.tip,delete e.protocol,e},getLinkIcon:function(t){return t.toLowerCase()+".png"},gotoLink:function(t){if(!W.Viewer.isScrollLock()){var e=t.get("linkType"),i=t.get("target");if(W.Viewer.getPreviewMode())W.Viewer.getLinkTipFunc()&&W.Viewer.getLinkTipFunc()(t,this);else{var n=!this._skipForceFlash(i.toLowerCase())&&this._matchCurrentUrl(i.toLowerCase());n&&this.setForceFlashCookie();var s=0===i.toLowerCase().indexOf("https://");s?i=i.replace("https://",""):0===i.toLowerCase().indexOf("http://")&&(i=i.replace("http://",""));var a=this._allTypes[e].protocol;"http://"==a&&s&&(a="https://");var r=a+i;this._changeLocation(r)}}},_changeLocation:function(t){document.location.href=t},showLinkTip:function(t){var e=t.get("linkType"),i=this._allTypes[e].tip+" "+t.get("target");W.Preview.showPreviewTip("Link will",i)},isReady:function(){return!0},clone:function(t){return this.parent(t)},stripUrl:function(t){var e=t.replace(/(\w+:\/\/)*([\w\-_]+\.)*([\w\-_]+\.[\w\-_]+).*/,"$3"),i={com:!0,org:!0,net:!0,edu:!0,gov:!0,mil:!0,info:!0,co:!0,ac:!0},n=e.split("."),s=n[0];return i[s]?t.replace(/(\w+:\/\/)*([\w\-_]+\.)*([\w\-_]+\.[\w\-_]+\.[\w\-_]+).*/,"$3"):e},setForceFlashCookie:function(){var t=new Date;t.setTime(t.getTime());var e=20,i=new Date(t.getTime()+60*1e3*e);document.cookie="forceFlashSite=true;path="+window.location.pathname+";domain=."+this.stripUrl(window.location.hostname)+";expires="+i.toGMTString()},_skipForceFlash:function(t){return window.location.href.toLowerCase()==t},_matchCurrentUrl:function(t){return this.stripUrl(window.location.href.toLowerCase())==this.stripUrl(t)}})}),define.Class("core.managers.ResourceManager",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.resources(["scriptLoader","topology","W.Utils","W.Config"]),e.fields({_bundleMap:{EDITOR_LANGUAGE:"/resources/editor/bundles/html_editor_",WIXAPPS_LANGUAGE:"/resources/editor/wixapps/wixapps_",WIXAPPS2_LANGUAGE:"/resources/editor/wixapps2/wixapps2_"}}),e.statics({STABLE_LANGUAGES:["en"],EXPERIMENTAL_LANGUAGES:["de","es","fr","it","pl","pt","ru","ja","ko","tr"]}),e.methods({initialize:function(){this.bundles={},this._currentBundle="EDITOR_LANGUAGE",this.langSymbol=this.getLanguageSymbol()},get:function(t,e,i){var n=this.getBundle(t,e);return n?n.hasOwnProperty(e)?n[e]:i?i:"localized item not found: [ "+e+"] in bundle: [ "+t+" ] ":"bundle wasn't loaded yet: [ "+t+" ] when requesting [ "+e+" ]"},getCur:function(t,e){return this.get(this._currentBundle,t,e)},getBundle:function(t,e){var i=this.bundles[t];return i||LOG.reportError(wixErrors.RESOURCE_MANAGER_BUNDLE_NOT_FOUND,"mobile.editor.managers.ResourceManager","getBundle",[t,e]),i},getUrlForLanguage:function(t,e){e=e||this.langSymbol;var i=this.resources.topology.langs;return i+(this._bundleMap[t]||this._bundleMap.EDITOR_LANGUAGE)+e+".json"},setBundle:function(t,e){this.bundles[t]=e},replacePlaceholders:function(t,e){if("string"!=typeof e)return"";var i=this.getBundle(t,e);return e.replace(/\[.+?\]/g,function(t){var e=t.substring(1,t.length-1),n=i[e];return void 0!==n?n:t})},loadLanguageBundle:function(t,e,i){var n=this.getUrlForLanguage(t),s=this;this.resources.scriptLoader.loadResource({url:n},{onLoad:function(n){s.setBundle(t,n),s.define.resource(t,n),e.call(s,n,t,i)},onFailed:function(a){s.setBundle(t,{}),s.define.resource(t,{}),e.call(s,a,t,i),LOG.reportError(wixErrors.LANGUAGE_PACK_FAILED_TO_LOAD,{c1:t,c2:n,language:i})}})},getLanguageSymbol:function(){var t="en",e=this.resources.W.Utils.getQueryParam("lang"),i=((e||this.resources.W.Config.getLanguage()||t)+"").toLowerCase(),n=this.resources.W.Config.getRunningExperiments();return(this.STABLE_LANGUAGES.contains(i)||this.EXPERIMENTAL_LANGUAGES.contains(i)&&n&&(n.MultiLang&&"new"===n.MultiLang.toLowerCase()||n["Lang_"+i]&&"new"===n["Lang_"+i].toLowerCase()))&&(t=i),window.wixEditorLangauge=t},clone:function(t){var e=this.parent(t);return e.bundles=this.bundles,e._currentBundle=this._currentBundle,e}})}),define.Class("core.managers.components.BCComponentDeserializer",function(t){var e=t;e.utilize(["core.managers.components.ComponentBuilder"]),e.methods({initialize:function(){},deserializeComponents:function(t,e,i){var n=t.map(this._createBuilderFromCompDescription.bind(this)),s=[];n.forEach(function(t){t.onCreated(function(t,a){s.push(t),s.length===n.length&&e(s),(i||function(){})(t,a)}).create()})},deserialize:function(t,e){this._createBuilderFromCompDescription(t).onCreated(e).create()},_createBuilderFromCompDescription:function(t){var e=t.node,i=this._initBuilder(t,e),n=t.components||[];return this._createChildren(n).each(this._attchToBuilder(i)),i},_createChildren:function(t){return t.map(this._createBuilderFromCompDescription.bind(this))},_attchToBuilder:function(t){return function(e){t.data.node.appendChild(e.data.node),t.withChild(e)}},_initBuilder:function(t,e){var i=new this.imports.ComponentBuilder(e);return i.withType(t.comp||t.componentType).withSkin(t.skin)._with("htmlId",t.htmlId||t.id).withUid(t.uId)._with("propertyQuery",t.propsID)._with("styleId",t.styleId).withData(t.dataQuery).withArgs(t.argObject)._with("layout",t.layout)._with("paddingBottom",t.paddingBottom)._with("minHeight",t.minHeight)}})}),define.Class("core.managers.component.BaseCompSchemaGenerator",function(t,e){var i=t,n=e;i.statics({generateComponentSchema:function(t,e){if(t){var i=this._aggregateSchema(t,e);t.$compSchema=i,t.prototype.$compSchema=i}},_aggregateSchema:function(t,e){e=e||{};for(var i={},n=this._getTraitsWithNewSchemaField(t),s=0;n.length>s;++s){var a=n[s],r=a._definitionFieldName_,o=a._fieldName_,h=a._aggregateSchema_,l=e[r];i[o]=this._aggregateSchemaField(t,l,h,r,o)}return i},_aggregateSchemaField:function(t,e,i,s,a){var r;switch(n.getInheritStrategy(e)){case n.STRATEGIES.INHERIT:r=this._aggregateInheritSchema(t,i,a),r=this._aggregateTraits(t,r,i,s);break;case n.STRATEGIES.MERGE:r=this._aggregateInheritSchema(t,i,a),r=this._mergeFieldData(r,e,i),r=this._aggregateTraits(t,r,i,s);break;case n.STRATEGIES.OVERRIDE:r=i(e),r=this._aggregateTraits(t,r,i,s)}return r},_aggregateInheritSchema:function(t,e,i){var n=t.prototype.Extends;return n.$compSchema&&n.$compSchema[i]||null},_aggregateTraits:function(t,e,i,s){for(var a=this._getClassTraitsWithoutParentTraits(t),r=0;a.length>r;++r){a[r].prototype;var o=a[r]._classDef_,h=o[s];n.getInheritStrategy(h)===n.STRATEGIES.MERGE&&(e=this._mergeFieldData(e,h,i))}return e},_mergeFieldData:function(t,e,i){var n=e.include||null,s=e.exclude||null;return i(t,n,s)},_getClassTraitsWithoutParentTraits:function(t){var e=t.prototype.Implements,i=t.prototype.Extends;if(i){var n=i.prototype.Implements;e=e.filter(function(t){return n.contains(t)?void 0:t})}return e},_getTraitsWithNewSchemaField:function(t){var e=t.prototype.Implements;return e.filter(function(t){return"string"==typeof t._fieldName_&&"function"==typeof t._aggregateSchema_?t:void 0})}})}),define.Class("mobile.core.components.base.BaseComponent",function(t){var e=t;e.utilize(["core.components.base.SizeLimits"]),e.inherits("bootstrap.utils.Events"),e.binds(["getComponentProperties","_setSkinPartElements","_onDataChange","_onDefaultAction","_replaceSkin","_replaceSkinAsync","_onRenderingTriggerEvent","_onComponentWixified","_onEditModeChanged","_skinParamsChange"]),e.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),e.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[]}}),e.methods({_renderTriggers:[],initialize:function(t,e,i){this._onRender=this._onRender.bind(this),this.initComponentLayout=this.initComponentLayout.bind(this),this._layoutInitialized=!1,this._anchors=[],this._$x=this._$y=0,this._$width=this._$height=100,this._reverseAnchors=[],this._actualHeight=-1,this._autoSizeTimerIntervals=-1,this.addEvent("render",this._onRender),this.addEvent("autoSized",this._onAutoSized),this.addEvent("autoSizedAnimation",this._onAutoSizedAnimation),this._baseComponentOriginalInitialize(t,e,i),this._showOnAllPagesChangeability=!0,this._wysiwygMode=!0,this._resizableSides=[Constants.BaseComponent.ResizeSides.TOP,Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.BOTTOM,Constants.BaseComponent.ResizeSides.RIGHT],this._moveDirections=[Constants.BaseComponent.MoveDirections.HORIZONTAL,Constants.BaseComponent.MoveDirections.VERTICAL],this._view.setStyle("visibility","hidden"),this.addEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout)},isDraggable:function(){return!0},_baseComponentOriginalInitialize:function(t,e,i){this._compId=t,this._view=e,this.$view=e,this._styleNameSpace=i&&i.styleNameSpace,this._isEnabled=!e.disabled,this._view.setProperty("id",i&&i.id||t),this._allComponentPartsReady=!1,this._componentReady=!1,this._isRenderNeeded=!0,this._autoBoundParts=null,this._isDisposed=!1,this._isRendered=!1,this._editorMode="CURRENT_PAGE";var n=i&&i.command||e.getAttribute("command");this._commandParameter=i&&i.commandParameter||e.getAttribute("commandParameter"),this._command=null,this._commandName=null,this._usesExternalData=!1,this._callLaterIDs=[],this._stateGrpDict={},this._sizeLimits=this.getSizeLimits(),this._minimumTimeBetweenRenders=this._minimumTimeBetweenRenders||0,this._lastRenderTime=-9999,this._renderDelayed=!1,n&&this.setCommand(n,this._commandParameter),this._isDisplayed=!1,e.addEvent(Constants.ComponentEvents.WIXIFIED,this._onComponentWixified),this.injects().Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditModeChanged)},toString:function(){return"[Component "+this.className+" #"+this._compId+"]"},getComponentId:function(){return this._compId},getComponentType:function(){return this._view.get("comp")},_getDataManager:function(){return this._data.getDataManager()},getViewNode:function(){return this._view},getStyleNameSpace:function(){return this._styleNameSpace||this.getOriginalClassName()},getSizeLimits:function(){return void 0===this._sizeLimits&&(this._sizeLimits=new this.imports.SizeLimits,this._sizeLimits.minW=this._sizeLimits.minW||this.MINIMUM_WIDTH_DEFAULT,this._sizeLimits.minH=this._sizeLimits.minH||this.MINIMUM_HEIGHT_DEFAULT,this._sizeLimits.maxW=this._sizeLimits.maxW||this.MAXIMUM_WIDTH_DEFAULT,this._sizeLimits.maxH=this._sizeLimits.maxH||this.MAXIMUM_HEIGHT_DEFAULT,this._originalSizeLimits=this._sizeLimits.clone()),this._sizeLimits},_initSizeLimits:function(){},setMinW:function(t){this.getSizeLimits().minW=t,this._originalSizeLimits.minW=t,this._applySizeLimitsIfNeeded()},setMinH:function(t){this.getSizeLimits().minH=t,this._originalSizeLimits.minH=t,this._applySizeLimitsIfNeeded()},setMaxW:function(t){this.getSizeLimits().maxW=t,this._originalSizeLimits.maxW=t,this._applySizeLimitsIfNeeded()},setMaxH:function(t){this.getSizeLimits().maxH=t,this._originalSizeLimits.maxH=t,this._applySizeLimitsIfNeeded()},_applySizeLimitsIfNeeded:function(){(this._$width<this.getSizeLimits().minW||this._$width>this.getSizeLimits().maxW)&&this.setWidth(this._$width),(this._$height<this.getSizeLimits().minH||this._$height>this.getSizeLimits().maxH)&&this.setHeight(this._$height)},getAcceptableDataTypes:function(){return[""]},getRawData:function(){return this._data?this._data.getData():void 0},getDataItem:function(){return this._data},isUsingExternalData:function(){return this._usesExternalData},setDataItem:function(t){var e=this._data;try{e&&(e.removeComponentWithInterest(this),e.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange))}catch(i){}this._data=t,t&&t!=e&&(this._data.addComponentWithInterest(this),this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._view.setAttribute("dataquery","#"+this._data.get("id"))),this._onDataChange(t),this._tryCreatingComponentParts()
},setDataByQuery:function(t,e){this.injects().Data.getDataByQuery(t,function(t){this.setDataItem(t),e&&e()}.bind(this))},_setSkinPartElements:function(t){this._validateSkinParts(t),this._skinPartElements=t,this._tryCreatingComponentParts()},_validateSkinParts:function(t){var e;for(var i in this._skinPartsSchema)e=this._skinPartsSchema[i],t[i]||e.optional||e.autoCreate===!1||e.repeater||LOG.reportError(wixErrors.SKIN_PART_MISSING,"BaseComponent","_validateSkinParts",{c1:this.$className,c2:this._skin.$className+":"+i})},_tryCreatingComponentParts:function(){this._skinPartElements&&(this._data||this.getAcceptableDataTypes().indexOf("")>=0)&&this._loadComponentParts()},_loadComponentParts:function(){this._allComponentPartsReady=!1,this._skinParts=this._skinPartElements;var t={},e=[],i={};for(var n in this._skinPartsSchema)if("view"!=n){var s=this.getSkinPartDefinition(n),a=this._doesSkinPartNeedAutoWixification(n,!0,s);if(a){var r=this._skinParts[n]||new Element("div");t[n]=r,i[n]=s,e.push(r)}}delete this._skinPartElements;var o=this;if(0!==e.length){new Async.Bulk(e,null,{completeEvent:Constants.ComponentEvents.READY,onComplete:function(){if(!o._isDisposed){for(var e in t){var i=t[e];e=i.get("skinPart"),e&&(o._skinParts[e]=i.getLogic())}o._setAllPartsReady()}}});for(n in t)this._createInnerComponent(n,t[n],!0,i[n])}else this._setAllPartsReady()},_doesSkinPartNeedAutoWixification:function(t,e,i){return i=i||this.getSkinPartDefinition(t),i.type==Constants.ComponentPartTypes.HTML_ELEMENT||i.repeater?!1:e&&i.autoCreate===!1?!1:!0},_createInnerComponent:function(t,e,i,n){return n=n||this.getSkinPartDefinition(t),n.type==Constants.ComponentPartTypes.HTML_ELEMENT||n.repeater||i&&n.autoCreate===!1?void 0:(n.skin=n.skin||e.getProperty("skin"),this._createComponentbyDefinition(n,e))},_createComponentbyDefinition:function(t,e,i){e=e||new Element("div"),e.setProperty("skinPart",t.id);var n;if(t.dataQuery)n=t.dataQuery;else if(t.dataRefField){var s=t.dataRefField;n="*"==s?this._data:this._data.get(s)}else if(t.dataItem)n=t.dataItem;else if(t.dataType){var a=this._data?this._data.getDataManager():W.Data;n=a.addDataItemWithUniqueId("",{type:t.dataType}).dataObject,n.setMeta("isPersistent",!1)}this._data&&this._data.getDataManager()!=W.Data?e.set("dataQuerySource","preview"):t.dataQuerySource&&e.set("dataQuerySource",t.dataQuerySource),t.argObject=t.argObject||{};var r;t.styleGroup&&this._style&&(r="inherit"==t.styleGroup?this._style:this._style.getStyleByGroupName(t.styleGroup));var o;return(i||r)&&(o=function(t){i&&i(t)}),this.injects().Components.createComponent({compNode:e,type:t.type,skin:t.skin,data:n,args:t.argObject,componentReadyCallback:o,innerStyle:r})},getSkinPartDefinition:function(t){var e=this._skinPartsSchema[t];if(!e)return LOG.reportError(wixErrors.CM_NO_PART,this.className,"getSkinPartParams",skinPartName),ret;var i=this._skinPartsSchema[t]||{},n=this._skin&&this._skin.getCompPartsDefinition()[t]||{},s=Object.merge({id:t},n,i);return s.hookMethod&&"function"==typeOf(this[s.hookMethod])&&(s.argObject=s.argObject||{},s=this[s.hookMethod](s)),s},_setAllPartsReady:function(){this._allComponentPartsReady||(this._allComponentPartsReady=!0,this._registerDataBindings(),this._registerSkinPartCommands(),this._applySizeLimitsIfNeeded(),this._onAllSkinPartsReady(this._skinParts),this._renderIfReady())},setTextContent:function(){W.Utils.debugTrace("")},setSkin:function(t){if(this._skin&&this._skin.unRegister(),this._skinParts&&this._skinParts.inlineContent){var e=this._skin.getInlineContent();this._view.empty(),this._view.adopt(e)}this._skin=t;var i=this.getSizeLimits(),n=this._originalSizeLimits;i.minW=this._skin.minW||n.minW,i.minH=this._skin.minH||n.minH,i.maxW=this._skin.maxW||n.maxW,i.maxH=this._skin.maxH||n.maxH,this._skin.register(this._view,this._setSkinPartElements,this._skinParamsChange)},initSkinAndStyle:function(t,e){if(!this._skin){this._skin=t,this._style=e;var i=this.getSizeLimits(),n=this._originalSizeLimits;i.minW=this._skin.minW||n.minW,i.minH=this._skin.minH||n.minH,i.maxW=this._skin.maxW||n.maxW,i.maxH=this._skin.maxH||n.maxH,this._skin.applyStyle(e),this._updateViewAttributes(),this._style.addEvent("skinChange",this._replaceSkinAsync),this._skin.register(this._view,this._setSkinPartElements,this._skinParamsChange),this._onStyleReady()}},setStyle:function(t){t!==this._style&&(this._style&&this._style.removeEvent("skinChange",this._replaceSkinAsync),this._style=t,t.getSkin()!=this._skin.getOriginalClassName()?this._skin.injects().Skins.getSkin(t.getSkin(),this._replaceSkin):this._skin.applyStyle(t),this._updateViewAttributes(),this._style.addEvent("skinChange",this._replaceSkinAsync),this._onStyleReady())},_onEditModeChanged:function(t){var e=this._editorMode;this._editorMode=t,this._editModeChanged(t,e)},_editModeChanged:function(){},_onStyleReady:function(){},getStyle:function(){return this._style},_replaceSkinAsync:function(){this._skin.injects().Skins.getSkin(this._style.getSkin(),this._replaceSkin)},_replaceSkin:function(t){var e=new t;e.applyStyle(this._style),this.setSkin(e)},_updateViewAttributes:function(){this._view.removeAttribute("styleId"),this._view.setAttribute("skin",this._skin.$className),this._style&&(this._view.removeAttribute("skin"),this._view.setAttribute("styleId",this._style.getId()))},render:function(){},_onAllSkinPartsReady:function(){},_onDataChange:function(t,e,i){this._preventRenderOnDataChange(t,e,i)||this._renderIfReady()},_preventRenderOnDataChange:function(){},_renderIfReady:function(){this._componentReady?this._tryRender(!0):this._testComponentReady()},renderIfNeeded:function(){this._componentReady?this._tryRender(!1):this._testComponentReady()},_tryRender:function(t){if(this._isRenderNeeded=this._isRenderNeeded||!!t,!this._componentReady||!this._needsRender()||!this._allComponentPartsReady)return this._componentReady&&this._allComponentPartsReady;var e=!1;if(0===this._minimumTimeBetweenRenders||this._timeSinceLastRender()>this._minimumTimeBetweenRenders)this._prepareForRender()&&(e=!0,this.fireEvent(Constants.ComponentEvents.READY_FOR_RENDER),!this._skipRender&&this._isDisplayed&&(this._isRenderNeeded=!1,this._newlyDisplayed=!1,this._lastRenderTime=(new Date).getTime(),this.render(),this._isRendered=!0,this._refreshDataBindings(),this._areRenderingTriggersAttached||(this._areRenderingTriggersAttached=!0,this._attachRenderTriggers()),this.fireEvent(Constants.ComponentEvents.RENDER),this._view.fireEvent(Constants.ComponentEvents.RENDER)));else if(!this._renderDelayed){this._renderDelayed=!0;var i=Math.max(10,this._minimumTimeBetweenRenders-this._timeSinceLastRender());this.callLater(this._delayedRenderCB,[t],i)}return e},_delayedRenderCB:function(t){this._renderDelayed=!1,this._tryRender(t)},_timeSinceLastRender:function(){return(new Date).getTime()-this._lastRenderTime},_needsRender:function(){return this._isRenderNeeded},isReady:function(){return this._componentReady},isRendered:function(){return this._isRendered},setCollapsed:function(t){t?this.collapse():this.uncollapse()},callLater:function(t,e,i){if(!this._isDisposed){var n=this.injects().Utils.callLater(t,e,this,i);return n&&this._callLaterIDs.push(n),n}},callRenderLater:function(t){this._isDisposed||(t=t||100,this._renderDelayed||(this._renderDelayed=!0,this.callLater(function(){this._renderDelayed=!1,this._renderIfReady()}.bind(this),[],t)))},collapse:function(){this._view&&this._view.collapse()},uncollapse:function(t){this._view&&this._view.uncollapse(t)},setState:function(t,e){this._processStates(),this._currentState,e||(e=this._stateGrpDict[t]||"DEFAULT"),e=e.toUpperCase();var i=this._stateMap[e];i?0>i.indexOf(t)?LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,this.$className,"setState",e+":"+t):(this._currentStateMap[e]=t,this._syncState()):LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,this.$className,"setState",e)},hasState:function(t,e){this._processStates(),e||(e=this._stateGrpDict[t]||"DEFAULT"),e=e.toUpperCase();var i=this._stateMap[e];return i?0>i.indexOf(t)?!1:!0:!1},removeState:function(t,e){this._processStates(),e=(e||"DEFAULT").toUpperCase();var i=this._stateMap[e];if(i){var n=this._currentStateMap[e];n==t&&delete this._currentStateMap[e],this._syncState()}else LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,this.$className,"removeState",e)},_syncState:function(){var t=[];for(var e in this._stateMap)this._currentStateMap[e]&&t.push(this._currentStateMap[e]);var i=t.join(" "),n=this._view,s=this._currentState||"";this._currentState=i,null!==n&&(n.setProperty("state",i),n.addClass("FOCRE_REFLOW_PLEASE"),n.removeClass("FOCRE_REFLOW_PLEASE"),i!=s&&(this._onStateChange(i,s),this.fireEvent("stateChange",{newState:i,oldState:s}),n.triggerDisplayChanged()))},getState:function(t){var e;return t?(this._currentStateMap||this._processStates(),e=this._currentStateMap[t.toUpperCase()]):e=this._view.getProperty("state"),e||""},_processStates:function(){if(!this._stateMap){var t,e;this._currentStateMap={},this._stateMap={DEFAULT:[]};var i=this._states||[],n={};if(i instanceof Array)for(t=0;i.length>t;++t)e=i[t],"string"!=typeof e?LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",i):this._stateMap.DEFAULT.push(e);else if("object"==typeof i)for(var s in i){var a=i[s];if(a instanceof Array){var r=s.toUpperCase();for(this._stateMap[r]=a.concat(),t=0;a.length>t;++t)e=a[t],e in n&&LOG.reportError(wixErrors.CM_DUPLICATE_STATE_NAME,this.$className,"_processStates",e),n[e]=!0,this._stateGrpDict[e]=r}else LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",s)}else LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",i)}},dispose:function(){if(W.Layout&&W.Layout.deleteSavedAnchorsById(this.getID()),this._isDisposed)return LOG.reportError(wixErrors.COMPONENT_ALREADY_DISPOSED,this.className,"dispose",this._compId);for(this._view&&(this._view.cleanup(),this._view.destroy(),this._view=null,this.$view=null,this._isDisposed=!0),this._data&&(this._data.removeComponentWithInterest(this),this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._data.getDataManager().removeDataItem(this._data),delete this._data),this._properties&&(this._properties.removeComponentWithInterest(this),this._properties.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._properties.getDataManager().removeDataItem(this._properties),delete this._properties);this._callLaterIDs.length>0;){var t=this._callLaterIDs.pop();t&&this.injects().Utils.clearCallLater(t)}this.removeEvents();var e=this.injects().Commands;if(e&&e.unregisterListener(this),this.getSkin()&&this.getSkin().dispose(),this._skinParts){for(var i in this._skinParts){var n=this._skinParts[i];if(n)if(n._compId)try{n.dispose()}catch(s){}else try{n.cleanup(),n.destroy()}catch(a){}}this._skinParts=null}},getIsDisposed:function(){return this._isDisposed},_onComponentWixified:function(){var t=this._view;this._canFocus&&(t.addEvent(Constants.CoreEvents.FOCUS,this._onFocus.bind(this)),t.addEvent(Constants.CoreEvents.BLUR,this._onBlur.bind(this))),this._isDisplayed=t.isNodeDisplayed(),this._areRenderingTriggersAttached=!1;var e=this._triggers;if(e)for(var i=e.length-1;i>=0;--i){var n=e[i];t.addEvent(n,this._onDefaultAction)}var s=Constants.DisplayEvents,a=this._onRenderingTriggerEvent;for(var r in Constants.DisplayEvents)t.addEvent(s[r],a)},_onComponentReady:function(){this._view},_attachRenderTriggers:function(){for(var t=this._renderTriggers||[],e=this._view,i=t.length-1;i>=0;--i)e.addEvent(t[i],this._onRenderingTriggerEvent)},_testComponentReady:function(){if(!this._componentReady)if(this._view.getLogic)this._isBaseComponentReady()&&(this._componentReady=!0,this._isEnabled?this._handleEnabled():this._handleDisabled(),this._tryRender()?(this.fireEvent(Constants.ComponentEvents.READY),this._view.fireEvent(Constants.ComponentEvents.READY)):this._componentReady=!1);else{var t=function(){this._view.removeEvent(Constants.ComponentEvents.WIXIFIED,t),this._testComponentReady()}.bind(this);this._view.addEvent(Constants.ComponentEvents.WIXIFIED,t)}},_isBaseComponentReady:function(){return this._allComponentPartsReady&&!!this._skinParts&&(!!this._data||this.getAcceptableDataTypes().indexOf("")>=0)},_prepareForRender:function(){return!0},_onStateChange:function(){},fancify:function(t){var e=this.injects().Components.createComponent("mobile.editor.components.FancyItem","mobile.editor.skins.FancyItemSkin",void 0,{},null,function(){var i=this;e.getLogic().createGui({dataPanel:this,upClickHandler:t.upCallback,downClickHandler:t.downCallback,deleteHandler:t.deleteCallback,showHideToggleHandler:t.isHiddenCallback,isHidden:t.initialIsHidden},this._skinParts.fancyContainer),e.getLogic()._skinParts.view.insertInto(i._skinParts.view),this._tryRender(!0),t.readyCallback&&t.readyCallback()}.bind(this))},_refreshDataBindings:function(){var t=this._autoBoundParts;if(t&&t.length)for(var e=this._data&&this._data.getData(),i=this.injects(),n=i.Resources,s=i.Utils,a=this._skinParts,r=t.length-1;r>=0;--r){var o,h=t[r],l=a[h.skinPart];if(l){if(h.bindToData){if(o=e&&e[h.bindToData],null===o||void 0===o){LOG.reportError(wixErrors.CM_NO_DATA,this.className,"refreshDataBindings",h.bindToData);continue}}else if(h.bindToDictionary){if(o=n.get("EDITOR_LANGUAGE",h.bindToDictionary),null===o||void 0===o){LOG.reportError(wixErrors.CM_NO_DICTIONARY_DATA,this.className,"refreshDataBindings",h.bindToDictionary);continue}}else h.bindToSelf&&(o=this[h.bindToSelf]);if(h.dictionaryFallback&&o.match(/^\s*$/)&&(o=n.get("EDITOR_LANGUAGE",h.dictionaryFallback)),h.isView){var c=h.viewType;if(""===c){var d=l.nodeName;if("input"==d.toLowerCase()){var u=l.getAttribute("type").toLowerCase();"text"==u?c="textinput":("checkbox"==u||"radio"==u)&&(c="check")}else c="text";h.viewType=c}if("textinput"==c)l.setAttribute("value",o);else if("check"==c){var _=s.stringToBoolean(o);_?l.setAttribute("checked",!0):l.removeAttribute("checked")}else l.innerHTML=o}else l.setTextContent(o)}}},hide:function(){this._view&&this._view.hide()},show:function(){this._view&&this._view.show()},_disableLinks:function(t){var e=this;t.addEvent("click",function(t){var i=e.injects().Viewer;if(i.getPreviewMode()&&(t.preventDefault(),W.Viewer.getLinkTipFunc())){var n=$(this).getProperty("href")||"",s=e.injects().Data.createDataItem({type:"Link",target:n,linkType:"FREE_LINK"});W.Viewer.getLinkTipFunc()(s)}})},_sanitizeLinks:function(t){for(var e=0;t.length>e;++e){var i=t[e];this._sanitizeLink(i)}},_sanitizeLink:function(t){var e=t.get("href");e&&0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&0!==e.indexOf("telnet://")&&0!==e.indexOf("ftp://")&&0!==e.indexOf("mailto:")&&(e.indexOf("@")>0?t.set("href","mailto:"+e):(0===e.indexOf("www")||0!==e.indexOf("www")&&0!==e.indexOf("#"))&&t.set("href","http://"+e))},_onFocus:function(){},_onBlur:function(){},_onDefaultAction:function(){this.executeCommand()},executeCommand:function(t){if(!this._command&&this._commandName){var e;e="WEditorCommands.AddComponent"==this._commandName?W.CommandsNew.getCommand(this._commandName):W.Commands.getCommand(this._commandName),e&&this.setCommand(e,this._commandParameter)}if(this._command){var i=arguments.length>0?t:this._commandParameter;i&&(i=this._parseDataReference(i)),this._command.execute(i,this)}},enable:function(){this._isEnabled||(this._isEnabled=!0,this._view.removeAttribute("disabled"),this._handleEnabled())},disable:function(){this._isEnabled&&(this._isEnabled=!1,this._view.setAttribute("disabled","disabled"),this._handleDisabled())},isEnabled:function(){return this._isEnabled},setCommand:function(t,e){var i=this.injects().Commands;if(("WEditorCommands.AddComponent"==this._commandName||"WEditorCommands.AddComponent"==t)&&(i=this.injects().CommandsNew),"string"==typeof t)this._commandName=t,t=i.getCommand(t);else if(!t instanceof i.Command&&!i.isCommandInstance(t))return LOG.reportError(wixErrors.BAD_COMMAND,this.className,"setCommand",t),void 0;this._commandParameter=e,this._command&&(this._command.unregisterListener(this),this._command=null),t?(this._command=t,t.registerListener(this,null,this._onCommandStatusChanged),this._commandName&&delete this._commandName):this._commandName&&i.registerCommandListenerByName(this._commandName,this,null,this._onCommandStatusChanged)},getCommandName:function(){return this._command?this._command.getName():this._commandName},getCommandParameter:function(){return this._commandParameter},_onCommandStatusChanged:function(t){t.isEnabled()?this.enable():this.disable()},_onEnabled:function(){},_handleEnabled:function(){var t=this._view,e=t.tabIndex,i=t._savedTabIndex;(null===e||void 0===e)&&(e=-1),-1==e&&(void 0!==i?t.tabIndex=i:this._canFocus&&(t.tabIndex=0)),this._canFocus&&t.addClass("focusable"),this._componentReady&&this._onEnabled()},_onDisabled:function(){},_handleDisabled:function(){var t=this._view,e=t.tabIndex;(null===e||void 0===e)&&(e=-1),e>=0&&(t._savedTabIndex=e,t.tabIndex=-1),document.activeElement==t&&t.blur(),this._canFocus&&t.removeClass("focusable"),this._componentReady&&this._onDisabled()},_onRenderingTriggerEvent:function(t){var e=this._view.isNodeDisplayed();switch(t){case Constants.DisplayEvents.COLLAPSED:case Constants.DisplayEvents.REMOVED_FROM_DOM:this._isDisplayed=!1,this._newlyDisplayed=!1;break;case Constants.DisplayEvents.SKIN_CHANGE:this._renderTriggers.contains(Constants.DisplayEvents.SKIN_CHANGE)&&(e?this._renderIfReady():this._componentInvalidated=!0);break;case Constants.DisplayEvents.MOVED_IN_DOM:this._view.isNodeDisplayed()&&this._renderTriggers.contains(Constants.DisplayEvents.MOVED_IN_DOM)&&this._renderIfReady(),this._skin.renderCssIfNeeded();break;default:var i=this._isDisplayed;this._isDisplayed=e,this._newlyDisplayed=this._newlyDisplayed||!i&&this._isDisplayed;var n=this._renderTriggers.contains(t)||this._renderTriggers.contains(Constants.DisplayEvents.DISPLAY_CHANGED);this._newlyDisplayed&&(n||!this._areRenderingTriggersAttached||this._componentInvalidated)&&(this._componentInvalidated=!1,this._renderIfReady()),this._skin.renderCssIfNeeded(),this._addedToDom()}},invalidateComponent:function(){this._componentInvalidated=!0},getIsDisplayed:function(){return this._isDisplayed},_addedToDom:function(){},checkVisibility:function(){return this._isDisplayed=this._view.isNodeDisplayed(),this._isDisplayed},_setDataField:function(t,e){this._data.set(t,e,!0)},_setMetaDataField:function(t,e){this._data.setMeta(t,e)},getFocusNode:function(){var t=this._skinParts.view;for(var e in this._skinPartsSchema)this._skinPartsSchema[e].focus&&(t=this._skinParts[e]||t);return t},getSkinPart:function(t){return this._skinParts[t]},getSkin:function(){return this._skin},setComponentProperties:function(t){var e=this._properties;this._properties=t,t.addComponentWithInterest(this),t&&t!=e&&this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)},getComponentProperty:function(t){return this._properties||this._createComponentProperties(),this._properties.get(t)},setComponentProperty:function(t,e,i){this._properties||this._createComponentProperties(),this._properties.set(t,e,i)},_createComponentProperties:function(){if(this._view){var t=this._compId,e=this._propertiesSchemaName;if(!e)return null;this._properties=W.ComponentData.addDataItem(t,{type:e},this),this._properties.addComponentWithInterest(this),this._view.setProperty("propertyQuery",t),this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)}},deleteComponentProperty:function(){},_onComponentPropertyChange:function(){},_loadComponentProperties:function(){},getComponentProperties:function(){return this._properties||this._createComponentProperties(),this._properties},_registerSkinPartCommands:function(){var t=this._skinPartsSchema,e=this.injects().Commands;for(var i in t){var n=t[i],s=this._skinParts[i],a=this._parseDataReference(n.command);if(s&&a){var r;if(r="string"==typeof a?e.getCommand(a):a,"view"==i||n.type==Constants.ComponentPartTypes.HTML_ELEMENT){var o=this._parseDataReference(n.commandParameter);r?s._command=r:s._commandName=a,s._commandParameter=o;var h=s.nodeName.toLowerCase();"select"==h?s.addEvent(Constants.CoreEvents.CHANGE,this._elementChangeExecuteCommand):s.addEvent(Constants.CoreEvents.CLICK,this._elementExecuteCommand)}else s.setCommand(r||a,n.commandParameter)}}},_registerDataBindings:function(){var t=[],e=this._skinPartsSchema;for(var i in e){var n=e[i],s=this._skinParts[i];if(s){var a=n.type==Constants.ComponentPartTypes.HTML_ELEMENT,r=a?s:s.getViewNode(),o=null,h=n.autoBindData||r&&r.getAttribute("autoBindData");h?o={bindToData:h}:(h=n.autoBindDictionary||r&&r.getAttribute("autoBindDictionary"),h?o={bindToDictionary:h}:(h=n.autoBindThis||r&&r.getAttribute("autoBindThis"),h&&(o={bindToSelf:h}))),o&&(o.skinPart=i,o.isView=a,o.viewType="",o.dictionaryFallback=n.dictionaryFallback,t.push(o))}}t.length&&(this._autoBoundParts=t)},_parseDataReference:function(t){if(!t||"string"!=typeof t)return t;var e=t;try{var i=t.indexOf("this.");if(0===i){try{e=this[t.substring(5)]}catch(n){e=null}e||W.Utils.debugTrace(this.className+" unknown part data reference "+t)}else i=t.indexOf("data."),0===i&&(this._data&&(e=this._data.get(t.substring(5)))||W.Utils.debugTrace(this.className+" missing data for skinpart "+t))}catch(s){W.Utils.debugTrace(this.className+" error processing partData "+t)}return e},_elementExecuteCommand:function(t){var e=W.Commands;"WEditorCommands.AddComponent"==this._commandName&&(e=W.CommandsNew);var i=this._command||(this._command=e.getCommand(this._commandName));i&&i.execute(this._commandParameter||t,this)},_elementChangeExecuteCommand:function(){var t=this.value,e=W.Commands;"WEditorCommands.AddComponent"==this._commandName&&(e=W.CommandsNew);var i=this._command||(this._command=e.getCommand(this._commandName));i&&i.execute(t)},hasChildren:function(){return!1},onPageVisibilityChange:function(){},initComponentLayout:function(){this._view.setStyle("visibility","visible"),this.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout),this._valueFetchingRegex=/[-\d\.]+/;for(var t=["x","y","width","height"],e=!1,i=0;t.length>i;i++){var n=t[i],s=this._view.get(n);if(null!=s&&""!=s){e=!0;var a="set"+n.capitalize();this[a](s,!0)}}if(this._layoutInitialized=!0,e&&this._view.hasAttribute("pos")===!1)"relative"!=this._view.getStyle("position")&&this._view.setStyle("position","absolute");else{var r=this._view.getAttribute("pos");r&&this._view.setStyle("position",r)}this.saveCurrentDimensions(),this.saveCurrentCoordinates()},_onRender:function(){this._intervalID&&clearInterval(this._intervalID),this._wCheckForSizeChangeAndFireAutoSized(5),this.flushMinPhysicalHeightCache()},_wCheckForSizeChangeAndFireAutoSized:function(t){if(this._view){this._autoSizeTimerIntervals=Math.max(t,this._autoSizeTimerIntervals);var e=function(){try{this._autoSizeTimerIntervals>1&&requestAnimFrame(e),this._autoSizeTimerIntervals>-1&&this._onAutoSized()}catch(t){}finally{this._autoSizeTimerIntervals--}}.bind(this);window.requestAnimFrame(e)}},_addedToDom:function(){this._pendingAutoSize&&(this._onAutoSized(this._pendingAutoSizeArgs),delete this._pendingAutoSize,delete this._pendingAutoSizeArgs)},_onAutoSized:function(t){if(!this._view||!this._isDisplayed||0==this.getPhysicalHeight())return this._pendingAutoSize=!0,this._pendingAutoSizeArgs=t,void 0;var e=this._actualWidth;this.flushPhysicalHeightCache();var i,n=this.getPhysicalHeight(),s=this.getWidth();if(i=this._lastHeightOnAutoSize?this._lastHeightOnAutoSize:0,(n!=i||e!=s&&e)&&(this._actualWidth=s,!t||!t.ignoreLayout)){var a=!0;null==this.getAnchors()||W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getAnchors())?a=!1:null!=this.getHorizontalGroup()&&W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getHorizontalGroup())?a=!1:this._areAnchorsAlreadySet||(a=!1),this._anchorTargetsReady||a?(this._anchorsInvalidated=!1,this._anchorTargetsReady=!0,W.Layout&&W.Layout.enforceAnchors([this])):this._anchorsInvalidated=!0}this._lastHeightOnAutoSize=n,this.fireEvent("autoSizeChange")},isAnchorsInvalidated:function(){return this._anchorsInvalidated===!0},_onAutoSizedAnimation:function(){this._wCheckForSizeChangeAndFireAutoSized(20)},_skinParamsChange:function(){this._view&&this._view.fireEvent(Constants.DisplayEvents.SKIN_CHANGE,Constants.DisplayEvents.SKIN_CHANGE),this._onAutoSized()},saveCurrentCoordinates:function(){this._lastCoords={x:this.getX(),y:this.getY()}},getCurrentCoordinates:function(){return this._lastCoords={x:this.getX(),y:this.getY()},this._lastCoords},getLastCoordinates:function(){return this._lastCoords||this.saveCurrentCoordinates(),this._lastCoords},saveCurrentDimensions:function(){this._lastDimensions={w:this.getWidth(),h:this.getHeight()}},getCurrentDimensions:function(){return this._lastDimensions={w:this.getWidth(),h:this.getHeight()},this._lastDimensions},getLastDimensions:function(){return this._lastDimensions||this.saveCurrentDimensions(),this._lastDimensions},getX:function(){return this._$x},setX:function(t){if(this._$x!=parseInt(t,10)){if(isNaN(parseInt(t,10)))return W.Utils.debugTrace("WbaseComp","setX","NaN passed as value"),void 0;this._$x=parseInt(t,10),this._view.setStyle("left",t+"px"),this.onMovement()}},getY:function(){return this._$y},setY:function(t){if(this._$y!=parseInt(t,10)){if(isNaN(parseInt(t,10)))return W.Utils.debugTrace("WbaseComp","setY","NaN passed as value"),void 0;this._$y=parseInt(t,10),this._view.setStyle("top",t+"px"),this.onMovement()}},getWidth:function(){return this._$width},setWidth:function(t,e,i){return 0!=i&&(i=!0),t=parseInt(t,10),isNaN(t)?(W.Utils.debugTrace("WbaseComp","setWidth","NaN passed as value"),void 0):(t=this._limitWidth(t),(this._$width!=t||e)&&(this._$width=t,this._view.setStyle("width",t+"px"),i&&this._onResize(),this.flushMinPhysicalHeightCache(),this.flushPhysicalHeightCache()),void 0)},setHeight:function(t,e,i){return 0!=i&&(i=!0),t=parseInt(t,10),isNaN(t)?(W.Utils.debugTrace("WbaseComp","setHeight","NaN passed as value"),void 0):(t=this._limitHeight(t),(this._$height!=t||e)&&(this._$height=t,this._view.setStyle("min-height",this._$height+"px"),this.flushPhysicalHeightCache(),i&&this._onResize()),void 0)},isInstanceOfClass:function(t){if(this.className==t)return!0;for(var e=this.$parentPrototype;e;){if(e.className==t)return!0;e=e.$parentPrototype}return!1},isFixedPositioned:function(){return!1},getSelectableX:function(){return this.getX()},getSelectableY:function(){return this.getY()},getSelectableWidth:function(){return this.getWidth()},getSelectableHeight:function(){return this.getPhysicalHeight()},_limitWidth:function(t){return this._limitDimension(t,this.getSizeLimits().minW,this.getSizeLimits().maxW)},_limitHeight:function(t){return this._limitDimension(t,this.getSizeLimits().minH,this.getSizeLimits().maxH)},_limitDimension:function(t,e,i){return Math.min(Math.max(t,e),i)},getHeight:function(){return this._$height},_onResize:function(){this.fireEvent("resize")},onMovement:function(){this.fireEvent("componentMoved")},getPosition:function(){var t=this.getViewNode().getSize();return{y:this.getY(),x:this.getX(),height:t.y,width:t.x}},getGlobalPosition:function(){return this._view.getPosition()},getGlobalPositionRefNode:function(){return this._getEditBoxReferenceNode().getPosition()},getSizeRefNode:function(){return this._getEditBoxReferenceNode().getSize()},getID:function(){return this._view.getProperty("id")},getMinPhysicalHeight:function(){if(!this._minPhysicalHeight){var t=this.getHeight();this.setHeight(1),this._minPhysicalHeight=this.getPhysicalHeight(),this.flushPhysicalHeightCache(),this.setHeight(t)}return this._minPhysicalHeight},getPhysicalHeight:function(){return this._actualHeight=this._actualHeight||this.getViewNode().getSize().y,this._actualHeight=Math.max(this.getHeight(),this._actualHeight),this._actualHeight},getExtraPixels:function(t){return this.getDivExtraPixels(this._view,t)},getDivExtraPixels:function(t,e){var i=Number.from(t.getStyle("border-top"))+Number.from(t.getStyle("padding-top")),n=Number.from(t.getStyle("border-bottom"))+Number.from(t.getStyle("padding-bottom")),s=Number.from(t.getStyle("border-left"))+Number.from(t.getStyle("padding-left")),a=Number.from(t.getStyle("border-right"))+Number.from(t.getStyle("padding-right"));return e&&(i+=Number.from(t.getStyle("margin-top")),n+=Number.from(t.getStyle("margin-bottom")),s+=Number.from(t.getStyle("margin-left")),a+=Number.from(t.getStyle("margin-right"))),{top:i,bottom:n,left:s,right:a,height:i+n,width:s+a}},flushPhysicalHeightCache:function(){delete this._actualHeight},flushMinPhysicalHeightCache:function(){delete this._minPhysicalHeight},getAnchors:function(){return this._anchors},setAnchors:function(t){this._areAnchorsAlreadySet=!0,this._anchors=t,t.forEach(this.addReverseAnchor)},addAnchor:function(t){this._anchors.push(t),this.addReverseAnchor(t)},addReverseAnchor:function(t){t.toComp===this?this._reverseAnchors.include(t):t.toComp.addReverseAnchor(t)},getReverseAnchors:function(){return this._reverseAnchors},getHorizontalGroup:function(){return this._horizontalGroup},setHorizontalGroup:function(t){this._horizontalGroup=t},getLayoutMode:function(){return"NORMAL"},getMinDragY:function(t){return W.Layout&&W.Layout.getComponentMinDragY(this,t)},getParentComponent:function(){var t=this.getViewNode().getParent("[comp]");return t&&t.getLogic?t.getLogic():null},getResizableSides:function(){return this._resizableSides},isResizable:function(){return this._resizableSides.length>0},isHorizResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.RIGHT)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.LEFT)},isVertResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.TOP)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.BOTTOM)},isHorizontallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.HORIZONTAL)},isVerticallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.VERTICAL)},allowHeightLock:function(){return this.isVertResizable()},useLayoutOnDrag:function(){return!1},useLayoutOnResize:function(){return!1},isEditableInPlace:function(){return!1},getEditedContent:function(){return null},isContainable:function(){return!0},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD},from:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD}}},isSelectable:function(){return!0},isContainer:function(){return!1},isDeleteable:function(){return!0},isDuplicatable:function(){return!0},isDeleteableRecurse:function(){if(!this.isDeleteable())return!1;for(var t=this.getViewNode().getElements("[comp]"),e=0;t.length>e;e++)if(t[e].getLogic&&!t[e].getLogic().isDeleteable())return!1;return!0},isMultiSelectable:function(){return!0},_createClickOverlay:function(){if(this.injects().Viewer.isPublicMode()||this._debugMode)return this._socialOverlayElement&&this._socialOverlayElement.clear(),void 0;if(!this._socialOverlayElement){var t={};this._socialOverlayElement=new Element("A",t);var e=W.Config.getServiceTopologyProperty("staticThemeUrlWeb")+"/transparent.gif";this._socialOverlayElement.setStyles({position:"absolute",top:"0",left:"0",height:"100%",width:"100%",background:"transparent url("+e+") repeat top left;"}),this._socialOverlayElement.addEvent("click",function(t){t.stopPropagation();var e={component:this};this.injects().Commands.executeCommand("socialWidget.interact",e,this)}.bind(this)),this.getViewNode().adopt(this._socialOverlayElement)}},_getEditBoxReferenceNode:function(){return this._view},getShowOnAllPagesChangeability:function(){return this._showOnAllPagesChangeability},setShowOnAllPagesChangeability:function(t){this._showOnAllPagesChangeability=t},isSiteSegment:function(){return this.isInstanceOfClass("wysiwyg.viewer.components.SiteSegmentContainer")},_addToolTipToSkinPart:function(t,e){t&&t.getViewNode&&(t=t.getViewNode()),t.addEvent("mouseenter",function(){W.Commands.executeCommand("Tooltip.ShowTip",{id:e},t)
}.bind(this)),t.addEvent("mouseleave",function(){W.Commands.executeCommand("Tooltip.CloseTip")}.bind(this))},canMoveToOtherScope:function(){return!0},disableReportLayoutChange:function(){},enableReportLayoutChange:function(){}})}),define.Class("core.managers.components.ComponentBuilder",function(t){var e=t;e.methods({initialize:function(t){this.data={},this.data.children=[],this.withNode(t)},_with:function(t,e){return this.data[t]=e,void 0===e&&delete this.data[t],this},withType:function(t){return this._with("type",t)._with("comp",t)},withData:function(t){var e="string"==typeof t?"dataQuery":"dataObject",i="string"!=typeof t?"dataQuery":"dataObject";return this._with(e,t)._with(i,void 0)},withChild:function(t){return this.data.children.push(t),this._appendChild(t),this},_appendChild:function(t){this.data.node.appendChild(t.data.node)},withNode:function(t){return this._with("node",this._createNodeWithUidSoMooToolsWouldNotStackEventsOnAllNodes(t)),0!=this.data.children.length&&this.data.children.forEach(function(t){this._appendChild(t)}.bind(this)),this},_createNodeWithUidSoMooToolsWouldNotStackEventsOnAllNodes:function(t){if(t||(t=W.Preview&&W.Preview.getPreviewSite?W.Preview.getPreviewSite().document.createElement("div"):document.createElement("div")),!t.uid){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=0|16*Math.random(),i="x"==t?e:8|3&e;return i.toString(16)});t.uid=e}return t},withUid:function(t){return this._with("uid",t)},withSkin:function(t){return this._with("skin",t)},withParentLogic:function(t){return this._with("parentLogic",t)},withSkinParamMapper:function(t){return this._with("skinParamMapper",t)},withDomIdPrefix:function(t){return this._with("domIdPrefix",t)},withArgs:function(t){return this._with("args",t)},onSkinRequest:function(t){return this.skinProvider=t,this},onCreated:function(t){return this.onCreatedCallback=t,this},create:function(){this._validate()&&this._setCreatedEvent()._wixifyNodeWithChildren()},_wixifyNodeWithChildren:function(){var t=this.data.children.filter(function(t){return!t._isWixified()}),e=t.map(function(t){return t.data.node});0!=t.length?(new Async.Bulk(e,null,{completeEvent:Constants.ComponentEvents.WIXIFIED,onComplete:function(){this._wixifyNode()}.bind(this)}),t.each(function(t){t.onError(this.onErrorCallback).create()}.bind(this))):this._wixifyNode()},onError:function(t){return this.onErrorCallback=t,this},_wixifyNode:function(){this._setNodeAttribute("comp")._setNodeAttribute("skin")._setNodeAttribute("dataQuery")._setNodeAttribute("propertyQuery")._setNodeAttribute("styleId")._setNodeAttribute("paddingBottom")._setNodeAttribute("minHeight"),this._setNodeLayout()._setNodeIds(),this.data.node.wixify(this.data.args,this.data.dataObject,this.data.domIdPrefix,void 0,this.data.skinParamMapper,this.data.parentLogic)},_setNodeIds:function(){return this.data.node.uid=this.data.uid||this.data.node.uid,this.data.node.id=this.data.htmlId||this.data.node.id,this},_setNodeLayout:function(){return this.data.layout?(this.data.node.setAttribute("x",this.data.layout.x),this.data.node.setAttribute("y",this.data.layout.y),this.data.node.setAttribute("width",this.data.layout.width),this.data.node.setAttribute("height",this.data.layout.height),this):this},_setNodeAttribute:function(t){return this.data[t]&&this.data.node.setAttribute(t,this.data[t]),this},_setCreatedEvent:function(){if("function"==typeof this.onCreatedCallback){var t=this.onCreatedCallback;this.data.node.addEvent(Constants.ComponentEvents.READY,function(){t(this.$logic,this)})}return this},_validate:function(){return this._validateType()&&this._validateSkin()&&this._validateNotWixified()},_validateType:function(){return this.data.type?!0:(this._callErrorHandler("you must set type before creating a component!"),!1)},_validateSkin:function(){return this.data.skin?!0:"function"==typeof this.skinProvider?this._validateSkinWithProvider():(this._callErrorHandler("you must set skin or set a skin-provider before creating a component!"),!1)},_validateSkinWithProvider:function(){var t=this.skinProvider();return t?(this.withSkin(t),!0):(this._callErrorHandler("skin-provider did not supply any skin"),!1)},_isWixified:function(){return!!this.data.node.$logic},_validateNotWixified:function(){return this._isWixified()?(this._callErrorHandler("you cannot create component on a wixified element"),!1):!0},_callErrorHandler:function(t){if("function"!=typeof this.onErrorCallback)throw t;this.onErrorCallback(t)}})}),define.Class("core.managers.component.ComponentDefinition",function(t){var e=t;e.inherits(t.constructor),e.methods({initialize:function(){t.constructor.apply(this),this._skinParts_=void 0,this._dataTypes_=void 0,this._states_=void 0,this._propertiesSchemaType_=void 0},skinParts:function(t){this._skinParts_=t},dataTypes:function(t){this._dataTypes_=t},states:function(t){this._states_=t},propertiesSchemaType:function(t){this._propertiesSchemaType_=t}})}),define.Class("core.managers.component.ComponentManager",function(t){var e=t;e.utilize(["bootstrap.utils.Queue","core.managers.component.ComponentDefinition","mobile.core.components.base.BaseComponent","core.managers.component.BaseCompSchemaGenerator"]),e.resources(["W.Classes"]),e.inherits("bootstrap.managers.BaseManager"),e.binds(["_onClassReady","getComponent"]),e.methods({initialize:function(){this._componentQue=new this.imports.Queue,this._componentMap={},this._componentDefinitions={},this._pendingComponentClassMap={},this.resource.getResources(["W.Classes","W.Experiments"],function(t){this._experimentManager=t.W.Experiments,this._classManager=t.W.Classes,this._classManager.addClassNamespaceHook(this.getComponent),this._classManager.addClassReadyHandler(this._onClassReady)}.bind(this)),this._componentMap["mobile.core.components.base.BaseComponent"]=this.imports.BaseComponent,this.define.component.definitionModifier=this._onCompDefineCallBack.bind(this)},_onCompDefineCallBack:function(t,e){var i=this._componentQue.getQueue(t);return i&&i.length>0&&this.registerNewComponent(t,e),e},registerNewComponent:function(t,e){var i=new this.imports.ComponentDefinition;e(i,i._inheritStrategy_),i=this._experimentManager.applyExperiments(t,i),i=this._fixCompDefinition(t,i),this._validateNewComponent(t,i),this._pendingComponentClassMap[t]="pending",this._componentDefinitions[t]=i,this._classManager.registerClassDefinition(t,i)},_validateNewComponent:function(t){return this._componentMap[t]?(LOG.reportError(wixErrors.CM_NAME_ALREADY_EXIST,this.className,"newComponent",t)(),void 0):void 0},_fixCompDefinition:function(t,e){var i=e._imports_||[];if(e._skinParts_){var n=e._skinParts_||{};for(var s in n)if(n[s]){var a=n[s].type;if(a&&a!=Constants.ComponentPartTypes.HTML_ELEMENT&&0>i.indexOf(a)){var r=this.getNameOverride(a);i.push(r)}}e._fields_._skinPartsSchema=n}e.utilize(i),e._fields_._propertiesSchemaName=e._propertiesSchemaType_,e._dataTypes_&&(e._methods_.getAcceptableDataTypes=function(){return e._dataTypes_}),e._states_&&(e._fields_._states=e._states_);var o=e._methods_.onComponentReady;return o&&this._componentQue.add(t,o),e},newComponent:function(t){this.define.oldComponent(t)},_buildCompClassData:function(t,e,i,n){return{name:t,traits:e(),imports:i(),Class:n()}},_validateComponent:function(t,e,i,n,s){if(this._componentMap[t])return LOG.reportError(wixErrors.CM_NAME_ALREADY_EXIST,this.className,"_validateComponent > is new",t)(),!1;var a=s().Extends;return instanceOf(a,String)?!0:(LOG.reportError(wixErrors.CM_NO_EXTEND,this.className,"_validateComponent > has inherits",t)(),void 0)},_addImportsToCompClass:function(t,e){var i=e.imports||[],n=t&&t.skinParts||{};for(var s in n){var a=n[s].type;a&&a!=Constants.ComponentPartTypes.HTML_ELEMENT&&0>i.indexOf(a)&&i.push(a)}e.imports=i},override:function(t,e){if(!t)throw Error("null/undefined component name for override");this._componentMap[t]=e},getComponent:function(t,e){if(t=this.getNameOverride(t),this._componentMap[t])return W.Utils.callLater(e,[this._componentMap[t]]),this._componentMap[t];var i=this.define.getDefinition("component"),n=nsUtil.getNameSpace(i,t),s=this._componentQue.hasQueue(t)===!1;return this._componentQue.add(t,e),s&&(n?this.registerNewComponent(t,n):this._classManager.getClass(t,function(){})),null},getNameOverride:function(t){return this.define.Class.$nameOverrides[t]||t},_onClassReady:function(t,e){return this._pendingComponentClassMap[t]?(this._onComponentClassReady(e,t),void 0):(this._componentQue.removeKey(t),void 0)},_onComponentClassReady:function(t,e){e=t.$originalClassName,this._componentMap[e]=t;var i=this._componentDefinitions[e];this.imports.BaseCompSchemaGenerator.generateComponentSchema(t,i);var n=this._componentQue.getQueue(e);n.forEach(function(t){t&&t(this._componentMap[e])}.bind(this)),this._componentQue.removeKey(e)},createComponent:function(t,e,i,n,s,a,r,o,h,l){if(t&&"object"==typeOf(t)){var c=t;t=c.type,e=c.skin||e,i=c.data||i,n=c.args||n,s=c.wixifyCallback||s,a=c.componentReadyCallback||a,r=c.domIdPrefix||r,o=c.compNode||o,l=c.innerStyle||c.skinParamMapper}if(!t||"string"!=typeOf(t))return LOG.reportError(wixErrors.CM_LOGIC_TYPE,this.className,"createComponent","created from:"+this.className),new Element("span");var d={comp:t,skin:e};if(i){var u=typeof i;"string"==u?(d.dataQuery=i,i=null):"object"==u&&(i._dataType||LOG.reportError(wixErrors.WIXIFY_MISSING_DATA_TYPE,this.className,"createComponent","created from:"+this.className))}return o?o.setProperties(d):o=new Element("div",d),s&&"function"==typeof s&&o.addEvent("wixified",function(){s(o.getLogic())}),a&&"function"==typeof a&&o.addEvent(Constants.ComponentEvents.READY,function(){o.removeEvent(Constants.ComponentEvents.READY,arguments.callee),a(o.getLogic())}),i&&i._dataType?o.wixify(n,i,r,h,l):o.wixify(n,null,r,h,l),o},isReady:function(){return!0}})}),define.experimentPlugin("ExperimentComponentPlugin",function(t){function e(t,e){resource.getResourceValue("W.Classes",function(t){t.getClass("core.managers.component.ComponentDefinition",function(t){n=t})});var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),s=t;"function"==typeof t&&(s=new n,t(s));var a=new n;return e(a,i),s.inherits(a._extends_||s._extends_),s.resources(i._mergeField_(s._resources_,a._resources_)),s.binds(i._mergeField_(s._binds_,a._binds_)),s.traits(i._mergeField_(s._traits_,a._traits_)),s.utilize(i._mergeField_(s._imports_,a._imports_)),s.statics(i._mergeObjects_(s._statics_,a._statics_)),s.fields(i._mergeObjects_(s._fields_,a._fields_)),s.methods(i._mergeObjects_(s._methods_,a._methods_)),s.skinParts(i._mergeField_(s._skinParts_,a._skinParts_)),s.states(i._mergeField_(s._states_,a._states_)),s.dataTypes(i._mergeField_(s._dataTypes_,a._dataTypes_)),s.propertiesSchemaType(a._propertiesSchemaType_||s._propertiesSchemaType_),s}function i(t,e){define.component(t,e)}var n,s=t;s.init("component","newComponent",e,i)}),define.Const("components",{DEFAULT_PREFIX:"c",BASE_LIST_ITEM_PREFIX:"bli"}),define.Class("core.managers.componentlifecyclemanager.ComponentInfo",function(t){var e=t;e.statics({STATES:{INITIATED:"initiated",READY:"ready",ERROR:"error_in_comp",PAUSED:"paused"}}),e.fields({component:null,state:"",isDisplayed:!1,isDisplayedBefore:!1,error:null,parentComp:null,childComps:{}}),e.methods({initialize:function(t){this.component=t,this.state=this.STATES.INITIATED,this.childComps={}}})}),define.Class("core.managers.componentlifecyclemanager.ComponentLifecycleManager",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.utilize(["core.managers.componentlifecyclemanager.ReflowTimer","core.managers.componentlifecyclemanager.ComponentMeasurer","core.managers.componentlifecyclemanager.ComponentRenderer","core.managers.componentlifecyclemanager.ComponentInfo"]),e.binds(["_beforeReflow","_afterReflow"]),e.statics({PHASES:{MEASURE_INITIATED:"measureInitiatedComps",MEASURE:"measure",COLLECT_RENDER_COMPS:"collectCompsForRender",RENDER:"render"}}),e.methods({initialize:function(){this._registeredComponents={};var t=this.imports.ReflowTimer;this._reflowTimer=new t,this._reflowTimer.on(t.REFLOW_EVENTS.BEFORE_REFLOW,this,this._beforeReflow),this._reflowTimer.on(t.REFLOW_EVENTS.AFTER_REFLOW,this,this._afterReflow),this._compMeasurer=new this.imports.ComponentMeasurer(this),this._compRenderer=new this.imports.ComponentRenderer(this),this.ComponentInfo=this.imports.ComponentInfo,this.run()},run:function(){this._reflowTimer.run()},pause:function(){this._reflowTimer.stop()},forceRender:function(){this._reflowTimer.forceReflow()},_beforeReflow:function(){this._compRenderer.updateLayoutForDisplayedComps(),this._compRenderer.renderComponents()},_afterReflow:function(){this._compMeasurer.invalidateDisplayAndMeasureAllDisplayedComponents()},registerComponent:function(t,e){var i=t.getComponentId();if(this._registeredComponents[i])return LOG.reportError(wixErrors.COMPONENT_ALREADY_REGISTERED_IN_LIFECYCLE,"ComponentLifecycleManager","registerComponent",i),void 0;var n=new this.ComponentInfo(t);return this._registeredComponents[i]=n,t.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._componentExterminated),e&&this._renderImmediate(n),this.forceRender(),n},_renderImmediate:function(){},getComponentInfo:function(t,e){var i=t.getComponentId();return this._registeredComponents[i]?this._registeredComponents[i]:(!e&&LOG.reportError(wixErrors.COMPONENT_NOT_REGISTERED_IN_LIFECYCLE,"ComponentLifecycleManager",i),null)},getAllComponentsInfo:function(){return this._registeredComponents},setParentComponentProcess:function(t,e){var i=t.getComponentId(),n=this.getComponentInfo(t,!0),s=this.getComponentInfo(e,!0);s&&n&&(this.removeChildComponentProcess(t),s.childComps[i]=n,n.parentComp=s)},removeChildComponentProcess:function(t){var e=this.getComponentInfo(t,!0),i=e&&e.parentComp;if(i){var n=t.getComponentId();delete i.childComps[n],e.parentComp=null}},getComponentChildList:function(t,e,i){i=i||[];var n=t.childComps;for(var s in n){var a=n[s];a&&(e&&this.getComponentChildList(a,!0,i),i.push(a))}return i},_onComponentError:function(t,e,i){t.component,t.state=t.STATES.ERROR,t.error=e,this._errorHandler&&this._errorHandler(t,e,i)},_componentExterminated:function(t){var e=t.target,i=e.getComponentId(),n=this._registeredComponents[i];n&&(this.removeChildComponentProcess(n.component),delete this._registeredComponents[i])},setComponentErrorHandler:function(t){this._errorHandler=t},clone:function(t){return this._reflowTimer.stop(),this.parent(t)},"@testRenderNow":function(t){if(!t)throw'specified null for required arg "component"';this._compRenderer.runRender([t])}})}),define.Class("core.managers.componentlifecyclemanager.ComponentMeasurer",function(t){var e=t;e.methods({initialize:function(t){this._compLC=t},invalidateDisplayAndMeasureAllDisplayedComponents:function(){this._markAllCompsAsNotDisplayed(),this._runMeasureForFirstTimeInitiatedComps();var t=this._getDisplayedCompList(document.body);this.measureComponents(t),this._invalidateAllDisplayModifiedComps()},measureComponents:function(t){var e,i,n;if(t.length)try{for(e=0;t.length>e;++e)i=t[e],n=this._compLC.getComponentInfo(i),n.isDisplayed=!0,this._measureComponent(n)}catch(s){t.splice(0,e+1),this._compLC._onComponentError(n,s,this._compLC.PHASES.MEASURE),t.length>0&&this.measureComponents(t)}},_measureComponent:function(t){var e=t.component;if(e._skinParts){e._invalidations_.clearInvalidationType(e.INVALIDATIONS.SIZE),e._invalidations_.clearInvalidationType(e.INVALIDATIONS.POSITION);for(var i in e._skinParts){var n=this._getNodeForMeasure(e._skinParts[i]);if(n){var s=this._getOldMeasure(n),a=this._getNewMeasure(n);n.$measure=a,this._invalidateSizeIfChanged(e,i,n,a,s),this._invalidatePositionIfChanged(e,i,n,a,s)}}e.isInvalidated([e.INVALIDATIONS.SIZE,e.INVALIDATIONS.POSITION])&&e.reportLayoutChange()}e.trigger(Constants.LifecycleSteps.MEASURE)},_getNodeForMeasure:function(t){return t instanceof HTMLElement?t:t.getViewNode instanceof Function?t.getViewNode():null},_getOldMeasure:function(t){return t.$measure||{width:0,height:0,top:0,left:0}},_getNewMeasure:function(t){var e=t.getSize(),i=t.getPosition(t.parentNode);return{width:e.x,height:e.y,top:i.y,left:i.x}},_invalidateSizeIfChanged:function(t,e,i,n,s){if(n.width!==s.width||n.height!==s.height){var a="view"===e?t.INVALIDATIONS.SIZE:t.INVALIDATIONS.PART_SIZE;t.invalidate(a,{current:n,old:s,partName:e,reference:i},!0)}},_invalidatePositionIfChanged:function(t,e,i,n,s){if(n.top!==s.top||n.left!==s.left){var a="view"===e?t.INVALIDATIONS.POSITION:t.INVALIDATIONS.PART_POSITION;t.invalidate(a,{current:n,old:s,partName:e,reference:i},!0)}},_markAllCompsAsNotDisplayed:function(){var t=this._compLC.getAllComponentsInfo();for(var e in t){var i=t[e];i.isDisplayedBefore=i.isDisplayed,i.isDisplayed=!1}},_runMeasureForFirstTimeInitiatedComps:function(){var t=this._compLC.getAllComponentsInfo();for(var e in t){var i=t[e];if(i.state===i.STATES.INITIATED)try{i.state=i.STATES.READY,this._measureComponent(i)}catch(n){this._compLC._onComponentError(i,n,this._compLC.PHASES.MEASURE_INITIATED),this._runMeasureForFirstTimeInitiatedComps()}}},_invalidateAllDisplayModifiedComps:function(){var t=this._compLC.getAllComponentsInfo();for(var e in t){var i=t[e];if(i.isDisplayedBefore!==i.isDisplayed){var n=i.component;n.invalidate(n.INVALIDATIONS.DISPLAY,{current:i.isDisplayed})}}},_getDisplayedCompList:function(t,e){e=e||[];var i=this._isNodeDisplayed(t);if(i)for(var n=t.childNodes,s=0;n.length>s;++s)this._getDisplayedCompList(n[s],e);if(i&&t.$logic){var a=t.$logic,r=a.getComponentId(),o=this._compLC.getAllComponentsInfo(),h=o[r];h&&e.push(a)}return e},_isNodeDisplayed:function(t){return t.getStyle?"none"!==t.getStyle("display")?!0:!1:!0}})}),define.Class("core.managers.componentlifecyclemanager.ComponentRenderer",function(t){var e=t;e.methods({initialize:function(t){this._compLC=t},renderComponents:function(){this._collectCompListForRender(),this.runRender(this._compsForRender)},runRender:function(t){var e,i,n;if(t.length)try{for(e=0;t.length>e;++e)i=t[e],n=this._compLC.getComponentInfo(i),this._renderComponent(i)}catch(s){t.splice(0,e+1),this._compLC._onComponentError(n,s,this._compLC.PHASES.RENDER),t.length>0&&this.runRender(t)}},_renderComponent:function(t){var e={invalidations:t._invalidations_};t._invalidations_=new t.imports.InvalidationCollector,t.trigger(Constants.LifecycleSteps.RENDER,e)},updateLayoutForDisplayedComps:function(){var t=this._compLC.getAllComponentsInfo();for(var e in t){var i=t[e];i.isDisplayed&&this._updateCompLayout(i.component)}},_updateCompLayout:function(t){var e=this._getComponentResizeData(t);if(e)for(var i in e){var n=e[i];switch(i){case"width":t._setWidth_(n);break;case"height":t._setHeight_(n);break;case"x":t._setX_(n);break;case"y":t._setY_(n)}}},_getComponentResizeData:function(t){return this._getLayoutChangeData({width:t.getLastInvalidationByType(t.INVALIDATIONS.WIDTH_REQUEST),height:t.getLastInvalidationByType(t.INVALIDATIONS.HEIGHT_REQUEST),x:t.getLastInvalidationByType(t.INVALIDATIONS.X_REQUEST),y:t.getLastInvalidationByType(t.INVALIDATIONS.Y_REQUEST)})},_getLayoutChangeData:function(t){var e;for(var i in t){var n=t[i];n&&!n._used_&&(n._used_=!0,e=e||{},e[i]=n[i])}return e},_collectCompListForRender:function(t){var e,i=t?t.compList:[],n=t?t.checkedCompIds:{},s=function(t){e=t;var s=t.component,a=s.getComponentId();n[a]=!0,this._isComponentReadyForRender(e)&&i.push(s)}.bind(this);try{var a=this._compLC.getAllComponentsInfo();for(var r in a)if(!n[r]){var o=a[r],h=this._compLC.getComponentChildList(o,!0);h.forEach(s),s(o)}}catch(l){this._compLC._onComponentError(e,l,this.PHASES.COLLECT_RENDER_COMPS),this._collectCompListForRender({compList:i,checkedCompIds:n})}this._compsForRender=i},_isComponentReadyForRender:function(t){var e=t.component;return t.state===t.STATES.READY&&e.isRenderNeeded(e._invalidations_)}})}),define.Class("core.managers.componentlifecyclemanager.ReflowTimer",function(t){var e=t;e.inherits("bootstrap.managers.events.EventDispatcher"),e.resources(["W.Utils"]),e.binds(["_beforeReflow","_onIdleDone"]),e.statics({REFLOW_EVENTS:{BEFORE_REFLOW:"beforeReflow",AFTER_REFLOW:"afterReflow"}}),e.methods({initialize:function(){this._isRunning=!1,this._isInIdleMode=!1,this._idleFPS=4},run:function(t){this._isRunning||(this._idleFPS=t||this._idleFPS,this._isRunning=!0,this._listenForNextReflow())},stop:function(){this._isRunning=!1,this._stopListening(),this._removeTestNode()},forceReflow:function(){this._isInIdleMode&&(this._stopListening(),this._isInIdleMode=!1,this._forceReflowTimeoutIndex=this.resources.W.Utils.callLater(this._onIdleDone,[],this,0))},_listenForNextReflow:function(){this._beforeReflowTimoutIndex=this.resources.W.Utils.callOnNextRender(this._beforeReflow)},_listenForAfterReflow:function(){this._isReflowTestNodeValid()?this._afterReflow():this._checkReflowTimoutIndex=this.resources.W.Utils.callLater(this._listenForAfterReflow,[],this,0)},_stopListening:function(){this.resources.W.Utils.clearOnNextRender(this._beforeReflowTimoutIndex),this.resources.W.Utils.clearCallLater(this._checkReflowTimoutIndex),this.resources.W.Utils.clearCallLater(this._idleTimoutIndex),this.resources.W.Utils.clearCallLater(this._forceReflowTimeoutIndex)},_beforeReflow:function(){this._isRunning&&(this.trigger(this.REFLOW_EVENTS.BEFORE_REFLOW),this._updateReflowTestNode(),this._setIdleDelay())},_afterReflow:function(){this._isRunning&&(this.trigger(this.REFLOW_EVENTS.AFTER_REFLOW),this._listenForNextReflow())},_setIdleDelay:function(){var t=1e3/this._idleFPS;this._isInIdleMode=!0,this._idleTimoutIndex=W.Utils.callLater(this._onIdleDone,[],this,t)},_onIdleDone:function(){this._stopListening(),this._isInIdleMode=!1,this._listenForAfterReflow()},_updateReflowTestNode:function(){this._textNode||(this._reflowTestConNode=new Element("div",{id:"ReflowTestContainer"}).setStyles({width:"1px",height:"1px",overflow:"hidden"}),this._textNode=new Element("div",{id:"ReflowTestNode"}).setStyles({width:"10px",height:"0px"}),this._textNodeInnerDiv=new Element("div",{id:"ReflowTextInnerNode"}).setStyles({width:"10%"}),this._textNode.adopt(this._textNodeInnerDiv),this._reflowTestConNode.adopt(this._textNode),document.body.adopt(this._reflowTestConNode));var t=parseInt(this._textNode.getStyle("width"),10)+10;this._reflowTextExpectedWidth=.1*t,this._textNode.setStyle("width",t+"px")},_removeTestNode:function(){this._textNode&&(this._textNode.parentNode&&this._textNode.parentNode.removeChild(this._textNode),this._reflowTestConNode.parentNode&&this._reflowTestConNode.parentNode.removeChild(this._reflowTestConNode),delete this._textNode,delete this._reflowTestConNode,delete this._reflowTextExpectedWidth)},_isReflowTestNodeValid:function(){return this._textNodeInnerDiv.offsetWidth==this._reflowTextExpectedWidth}})}),define.Const("LifecycleSteps",{RENDER:"render",MEASURE:"measure",UPDATE:"update"}),function(){var t=null;define.Class("core.managers.css.CssManager",function(e){var i=e;i.inherits("bootstrap.managers.BaseManager"),i.binds(["_onThemePropertyChange","updateAllThemeCss"]),i.statics({GLOBAL_THEME_CSS_TYPES:["font","color"],FONT_SERVICE_URL:"http://fonts.googleapis.com/css?family="}),i.methods({initialize:function(){this._themeStyleSheet=this._generateThemeStylesSheet(),this._addHelveticaToWixSites(),this._configureSystemFonts(),this._configureCustomFonts(),this.resource.getResourceValue("W.Theme",function(t){this._themeManager=t,t.addEvent("propertyChange",this._onThemePropertyChange),t.isDataReady()?this.updateAllThemeCss():t.addEvent("dataReady",this.updateAllThemeCss)}.bind(this))},_configureSystemFonts:function(){this._systemFontsCssDefinition={},this._systemFontsNames=[];for(var t in Constants.CSS.SYSTEM_FONTS)for(var e=Constants.CSS.SYSTEM_FONTS[t],i=0;e.length>i;++i){var n=e[i],s="array"==typeOf(n)?n[0]:n;this._systemFontsNames.push(s);var a="array"==typeOf(n)?n.concat().reverse():[n];a.push(t),this._addQuoteToArrayElementsIfContainSpaces(a),this._systemFontsCssDefinition[s]=a.join(",")}},_configureCustomFonts:function(){this._customFontsCssDefinition={},this._customFontsNames=[];for(var t in Constants.CSS.CUSTOM_FONTS)for(var e=Constants.CSS.CUSTOM_FONTS[t],i=0;e.length>i;++i){var n=e[i],s="array"==typeOf(n)?n[0]:n;this._customFontsNames.push(s);var a="array"==typeOf(n)?n.concat().reverse():[n];a.push(t),this._addQuoteToArrayElementsIfContainSpaces(a),this._customFontsCssDefinition[s]=a.join(",")}},_addQuoteToArrayElementsIfContainSpaces:function(t){for(var e=0;t.length>e;++e)t[e].indexOf(" ")&&(t[e]='"'+t[e]+'"')},_onThemePropertyChange:function(t){var e=this._themeManager.getPropertyType(t.name);this.GLOBAL_THEME_CSS_TYPES.contains(e)&&this._updateThemeGlobalCssByPropertyName(t.name,e)},updateAllThemeCss:function(){for(var t=0;this.GLOBAL_THEME_CSS_TYPES.length>t;++t)for(var e=this.GLOBAL_THEME_CSS_TYPES[t],i=this._themeManager.getPropertiesAccordingToType(e),n=0;i.length>n;++n)this._updateThemeGlobalCssByPropertyName(i[n],e)},_updateThemeGlobalCssByPropertyName:function(t,e){var i=this.getThemeGlobalPropertyCssDefinition(t,e);if(this._themeStyleSheet.updateRule(i.selector,i.rules),"font"==e){var n=this._themeManager.getProperty(t).getFontFamily(),s=this.getFontType(n);"custom"==s&&this.loadFont(n)}},getThemeGlobalPropertyCssDefinition:function(t,e,i){e=e||this._themeManager.getPropertyType(t);var n,s=this._themeManager.getProperty(t),a="";switch(e){case"font":n="."+t,a=i?"font: "+s.getCssValue():s.getCssRule();break;case"color":n="."+t,a="color:"+s.getHex(!1)}return{selector:n,rules:a}},_generateThemeStylesSheet:function(){return t||(t=W.Utils.createStyleSheet("WIX_THEME_STYLES")),this._themeStyleNodeId=t.styleNode.get("id"),t},getCssNodeId:function(){return this._themeStyleNodeId},getDefaultFont:function(){var t=Constants.CSS.SYSTEM_FONTS["sans-serif"][0];return t="array"===typeOf(t)?t[0]:t},getFontFallbacksCss:function(t){return this._systemFontsCssDefinition[t]||this._customFontsCssDefinition[t]||'"'+t+'"'},getFontList:function(){return[].concat(this._systemFontsNames,this._customFontsNames).sort()},getFontType:function(t){return-1!=this._systemFontsNames.indexOf(t)?"system":-1!=this._customFontsNames.indexOf(t)?"custom":null},getUsedFontsUrl:function(){for(var t=this._themeManager.getPropertiesAccordingToType("font"),e={},i=0;t.length>i;++i){var n=this._themeManager.getProperty(t[i]).getFontFamily();"custom"==this.getFontType(n)&&(e[n]=n)}return this.FONT_SERVICE_URL+this._getFontsQuery(e)},loadFont:function(t){this._readyFonts=this._readyFonts||{},this._loadedFonts=this._loadedFonts||{};var e=-1!=this._customFontsNames.indexOf(t),i=this._readyFonts[t],n=this._loadedFonts[t];!e||i||n||(this._loadedFonts[t]=t,this._fontLoadCallLater||(this._fontLoadCallLater=W.Utils.callLater(this._loadFonts,void 0,this,50)))},_loadFonts:function(){delete this._fontLoadCallLater;var t=this.FONT_SERVICE_URL+this._getFontsQuery(this._loadedFonts);for(var e in this._loadedFonts)this._readyFonts[e]=e,delete this._loadedFonts[e];this._addFontsLoaderCssTag(t)},_getFontsQuery:function(t){fontQuery="";for(var e in t)fontQuery+=e.split(" ").join("+"),fontQuery+=":n,b,i,bi|";return fontQuery},_addFontsLoaderCssTag:function(t){if(0===$$("[href="+t+"]").length){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t;var i=document.getElementsByTagName("link")[0];i.parentNode.insertBefore(e,i)}},_addHelveticaToWixSites:function(){if(window.rendererModel&&"WixSite"===rendererModel.documentType){this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Italic"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Medium"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-UltLt"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-UltLt"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-25UltL"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-35Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-95Blac"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-95Blac"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-95Blac"]);var t=this.getHelveticaCssUrl();t&&this._addFontsLoaderCssTag(t)}},getHelveticaCssUrl:function(){return window.rendererModel&&"WixSite"===rendererModel.documentType?window.serviceTopology.publicStaticsUrl+"/css/Helvetica/fontFace.css":null},_pushUnique:function(t,e){var i=this._doesArrayExistInArrayOfArrays(t,e);i||t.push(e)},_doesArrayExistInArrayOfArrays:function(t,e){for(var i=0;t.length>i;i++){var n=t[i];if(n.length===e.length)for(var s=0;e.length>s&&n[s]===e[s];s++)if(s===e.length-1)return!0}return!1},clone:function(t){return this.parent(t)},isReady:function(){return!0}})})}(),define.Const("CSS",{COLORS:["transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],SYSTEM_FONTS:{"sans-serif":[["Arial","Helvetica"],["Arial Black","Gadget"],["Impact","Charcoal"],["Lucida Sans Unicode","Lucida Grande"],["Tahoma","Geneva"],["Verdana","Geneva"]],serif:["Georgia",["Palatino Linotype","Book Antiqua","Palatino"],["Times New Roman","Times"]],cursive:["Comic Sans MS"],monospace:["Courier New",["Lucida Console","Monaco"]]},CUSTOM_FONTS:{"sans-serif":["Anton","Basic","Jockey One","Jura","Open Sans","Overlock","Play","Signika","Spinnaker","Chelsea Market"],serif:["Caudex","EB Garamond","Enriqueta","Forum","Noticia Text","Fredericka the Great","Kelly Slab","Josefin Slab"],cursive:["Lobster","Niconne","Marck Script","Mr De Haviland","Patrick Hand","Sarina","Corben"],monospace:[]}}),define.Class("core.managers.data.ComponentDataManager",function(t){var e=t;
e.utilize(["core.managers.data.PropertiesItem"]),e.inherits("core.managers.data.DataManager"),e.fields({DEFINE_NAMESPACE:"dataPropertyItem"}),e.methods({initialize:function(){this._PropertiesItem=this.imports.PropertiesItem,this.parent()},addDataItem:function(t,e,i){var n=this.createDataItem(e,i);return n._data.id=t,this.dataMap[t]=n,this._runCallbacks(t,n),this.markDirtyObject(n),n},createDataItem:function(t,e){var i=t.type,n=this.getDataTypeSchema(i);return n?new this._PropertiesItem(n,t,this,e):new this._DataItemBase(t,this)}})}),define.Class("core.managers.data.DataItemBase",function(t){var e=t;e.inherits("bootstrap.utils.Events"),e.binds(["fireDataChangeEvent"]),e.statics({METADATA_DEFAULTS:{isPreset:!1,isHidden:!1,description:"",isPersistent:!0},getFieldsFilterArray:function(t){return"array"==typeOf(t)?t:Object.keys(t)}}),e.methods({initialize:function(t,e){if(this._data=t,t.type&&"string"!=typeof t.type)throw"invalid data type. must be string";this._dataType=t.type,this._dataManager=e||this.injects().Data,this.componentsWithInterest=[]},setData:function(t,e){var i=this._data,n=this._data!==t;this._data=t,this._dataType=t.type,n&&!e&&this.fireDataChangeEvent(void 0,t,i)},setFields:function(t,e){var i={},n={},s=this._data;Object.forEach(t,function(t,e){s[e]!==t&&(i[e]=s[e],n[e]=t),this.set(e,t,!0)}.bind(this)),Object.keys(i).length>0&&this.fireDataChangeEvent(n,n,i,e)},setMeta:function(t,e,i){if(t in this.METADATA_DEFAULTS){if(this._data.metaData=this._data.metaData||{},this._data.metaData[t]=e,i){var n={key:e},s={};this.fireDataChangeEvent(n,s)}}else LOG.reportError(wixErrors.INVALID_METADATA_FIELD,"DataItemBase","setMeta",t)()},set:function(t,e,i,n){if(e=this.injects().Utils.sanitizeUnicode(e),this._data[t]!==e){var s={};if(s[t]=this._data[t],this._data[t]=e,this.setMeta("isPreset",!1),!i){var a={};a[t]=e,this.fireDataChangeEvent(t,a,s,n)}}},getFields:function(t){var e={},i=this.getFieldsFilterArray(t);return i.forEach(function(t){e[t]=this.get(t)}.bind(this)),e},getData:function(){return this._data},getType:function(){return this._data.type},getMeta:function(t){if(t in this.METADATA_DEFAULTS){var e=this._data.metaData&&this._data.metaData[t];return void 0!==e?e:this.METADATA_DEFAULTS[t]}LOG.reportError(wixErrors.INVALID_METADATA_FIELD,"DataItemBase","getMeta",t)()},get:function(t){var e=this._data[t];return"string"==typeof e&&(e=this._sanitizeString(e)),e},_sanitizeString:function(t){return t.replace(/[\u0080\u0099\u009C]/g,"")},fireDataChangeEvent:function(t,e,i,n,s){this.markDataAsDirty();var a=void 0!==t?[this,t,e,i]:[this];this.fireEvent(Constants.DataEvents.DATA_CHANGED,a),this._dataManager.reportDataItemChangeEvent(this,e,i,n,s)},markDataAsDirty:function(){this.getMeta("isPersistent")!==!1&&(this._dataManager.markDirtyObject(this),this._dataManager.flagDataChange())},toString:function(){return"[Data Object]"},getDataManager:function(){return this._dataManager},addComponentWithInterest:function(t){this.componentsWithInterest.include(t)},removeComponentWithInterest:function(t){this.componentsWithInterest.erase(t)},cloneData:function(){return Object.clone(this.getData())},hasField:function(t){var e=this._data[t];return null!==e&&void 0!=e}})}),define.Class("core.managers.data.DataItemWithSchema",function(t){var e=t;e.inherits("core.managers.data.DataItemBase"),e.utilize(["core.utils.css.Color"]),e.traits(["bootstrap.utils.Events"]),e.statics({FIELD_TYPE_DEFAULTS:{refList:[],ref:"",number:Number.NaN,string:"",color:"255,255,255,1","boolean":!1,object:{},list:[]}}),e.methods({initialize:function(t,e,i,n){this._schema=t,this._schemaType=n,this._snapshot={},this.parent(e,i),this._setSchemaDefaults()},reset:function(){for(var t in this._schema){var e=this._getDefaultValue(t);this._data[t]!=e&&this.set(t,e)}},removeField:function(t){delete this._data[t]},takeSnapshot:function(){var t={};this._cloneBySchema(t,this._data),this._snapshot=t},restoreSnapshot:function(t){this._snapshot?(this._cloneBySchema(this._data,this._snapshot),this.discardSnapshot(),t!==!1&&this.fireDataChangeEvent()):LOG.reportError(wixErrors.DATA_MISSING_SNAPSHOT,"DataItem","restoreSnapshot",this._dataType)},discardSnapshot:function(){this._snapshot=null},getSchemaType:function(){return this._schemaType},getSchema:function(){return this._schema},setSchema:function(t){this._schema=t},getFieldSchema:function(t){return this._schema[t]},_setSchemaDefaults:function(){for(var t in this._schema){var e=this._schema[t];if(e&&e["default"]){var i=this._data[t],n=this.get(t);i||i==n||this.set(t,n)}}},get:function(t){var e=this.parent(t),i=this._schema[t];if(void 0!==e&&null!==e){if(Constants.DataTypes.TYPE_RESOURCE_KEY==i){var n=this.getDataManager().getResourceManager();n&&(e=n.get("EDITOR_LANGUAGE",e,e))}}else e=this._getDefaultValue(t),this._data[t]=e;return"color"==i?new this.imports.Color(value):e},getFieldType:function(t){return this._schema[t]},_getDefaultValue:function(t){var e,i=this._schema[t];return i?(e="string"==typeof i?this.FIELD_TYPE_DEFAULTS[i]:i.hasOwnProperty("default")?i["default"]:this.FIELD_TYPE_DEFAULTS[i.type],this._cloneDefaultObject(e)):void 0},_cloneDefaultObject:function(t){return Array.isArray(t)?t.splice(0,0):"object"==typeof t&&null!==t?Object.clone(t):t},_cloneBySchema:function(t,e){for(var i in this._schema){var n=e[i],s=typeof n;t[i]=instanceOf(n,Array)?n.slice():"object"==s?Object.clone(n):n}return t},copySchemaFieldsFrom:function(t,e){this._cloneBySchema(this._data,t._data),e||this.fireDataChangeEvent()},copySchemaFieldsTo:function(t,e,i){var n=this._cloneBySchemaAndReturnDataChange(t._data,this._data),s=0==Object.keys(n.newValue).length+Object.keys(n.oldValue).length;s||e||t.fireDataChangeEvent(void 0,n.newValue,n.oldValue,i)},_cloneBySchemaAndReturnDataChange:function(t,e){var i,n,s={},a={};for(var r in this._schema){var o=e[r],h=typeof o;i=t[r],instanceOf(o,Array)?(n=o.slice(),t[r]=n):"object"==h?(n=Object.clone(o),t[r]=n):(n=o,t[r]=n),(i||n)&&i!=n&&(a[r]=i,s[r]=n)}return{dataItem:t,newValue:s,oldValue:a}},set:function(t,e,i,n,s){var a=this._validateByPresenceInSchema(t);a?this.parent(t,e,i,n,s):LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"DataItemWithSchema","set",{c1:"key: "+t+", schemaType: "+this._schemaType})},setData:function(t,e){return t!==this._data?this._hasValidType(t.type)?(this._data?this._data.type==t.type&&(t.id=this._data.id,this.parent(t,!1),this._setSchemaDefaults(),e!==!1&&this.fireDataChangeEvent()):this.parent(t,e),void 0):(LOG.reportError(wixErrors.SCHEMA_MISSING,"DataItemWithSchema","setData",{c1:"type: "+t.type+", schemaType: "+this._schemaType}),void 0):void 0},hasField:function(t){var e=this._data[t];return null!==e&&void 0!=e},_hasValidType:function(t){return this._schemaType===t},_hasCheckableSchema:function(){return this._schemaType&&"Document"!==this._schemaType},_isKeyPresentedInSchema:function(t){return void 0!==this._schema[t]},_validateByPresenceInSchema:function(t){return this._hasCheckableSchema()?this._isKeyPresentedInSchema(t):!0}})}),define.Class("core.managers.data.DataManager",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.utilize(["core.managers.data.DataItemBase","core.managers.data.DataItemWithSchema","bootstrap.utils.Queue"]),e.resources(["W.Classes","W.Experiments"]),e.fields({DEFINE_NAMESPACE:"dataItem"}),e.methods({initialize:function(){this._classManager=this.resources.W.Classes,this._readyDataSchemaMap={},this.dataMap={},this.dirtyDataObjectsMap={},this.callbackQueue=new this.imports.Queue,this._DataItemBase=this.imports.DataItemBase,this._DataItemWithSchema=this.imports.DataItemWithSchema,this.define[this.DEFINE_NAMESPACE].definitionModifier=this._onDataItemDefineCallBack.bind(this)},flagDataChange:function(){this._dataChanged=!0},clearDataChange:function(){this._dataChanged=!1},isDataChange:function(){return this._dataChanged===!0},_onDataItemDefineCallBack:function(t,e){return this.addDataItem(t,e),e},getDataTypeSchema:function(t){if(!this._readyDataSchemaMap[t]){var e=this.define.getDefinition("dataSchema"),i=e[t];if(!i){var n="/schema=["+t+"]";return LOG.reportError(wixErrors.SCHEMA_MISSING,"DataManager","getSchema"+n,[t])(),null}this._applySchemaInheritance(i),i=this.resources.W.Experiments.applyExperiments(t,i),this._readyDataSchemaMap[t]=i}return this._readyDataSchemaMap[t]},_applySchemaInheritance:function(t){var e=t["extends"];if(e){var i=this.getDataTypeSchema(e);Object.merge(t,i)}},clearDirtyObjectsMap:function(){this.dirtyDataObjectsMap={}},hasDirtyObjects:function(){return W.Utils.objectSizeDelta(this.dirtyDataObjectsMap)},markDirtyObject:function(t){var e=t._data,i=e.id;this.dirtyDataObjectsMap[i]=t},addDataItems:function(t){for(var e in t)this.addDataItem(e,t[e])},addDataItemsForPage:function(t){var e=this.define.getDefinition(this.DEFINE_NAMESPACE);for(var i in t){var n=nsUtil.getNameSpace(e,i);this.dataMap[i]||n||define[this.DEFINE_NAMESPACE](i,t[i])}},addDataItem:function(t,e){e=this.resources.W.Experiments.applyExperiments(t,e);var i=this.createDataItem(e);return i._data.id=t,this.dataMap[t]=i,this._runCallbacks(t,i),this.skipDirtyMarking||this.markDirtyObject(i),i},override:function(t,e){if(!t||!this.dataMap[t])throw Error("Invalid data id name for override: "+t);this.dataMap[t]=e},addDataItemWithUniqueId:function(t,e){var i;do i=t+Number.random(0,99999).toString(36),i=i.replace(" ","_");while(this.dataMap[i]);var n=this.addDataItem(i,e);return{id:i,dataObject:n}},reportDataItemChangeEvent:function(t,e,i,n,s){this.fireEvent(Constants.DataEvents.DATA_CHANGED,[t,e,i,n]),!s&&void 0!==e&&void 0!==i&&t._data.id&&this.fireEvent("undoDataChangedEvent",[t,e,i,n])},_runCallbacks:function(t,e){this.callbackQueue.popQueue(t).forEach(function(t){t&&t(e)})},createDataItem:function(t,e){e=e||t.type;var i;if(e&&(i=this.getDataTypeSchema(e)),i){if(i.dataClassRef){var n;return this._classManager.getClass(i.dataClassRef,function(t){n=t}),n?new n(t,this):(LOG.reportError(wixErrors.SCHEMA_MISSING,"DataManager","getSchema"+i.dataClassRef,[i.dataClassRef])(),null)}return new this._DataItemWithSchema(i,t,this,e)}return new this._DataItemBase(t,this)},isDataItem:function(t){return t&&instanceOf(t,this._DataItemBase)},getDataByQuery:function(t,e){var i=null;if(0===t.indexOf("#")){var n=t.substr(1);if(i=this.dataMap[n])return e&&e(i),i;this.callbackQueue.add(n,e);var s=this.define.getDefinition(this.DEFINE_NAMESPACE),a=nsUtil.getNameSpace(s,n);if(a)return this.addDataItem(n,a)}else LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","getDataByQuery",t),W.Utils.callLater(e,[null])},isDataAvailable:function(t){var e=null;if(0===t.indexOf("#")){var i=t.substr(1);if(!i)return!1;if(e=this.dataMap[i])return!0;var n=this.define.getDefinition(this.DEFINE_NAMESPACE),s=nsUtil.getNameSpace(n,i);return s?!0:!1}return LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","isDataAvailable",t),!1},getDataByQueryList:function(t,e){var i={},n=function(n){return function(s){i[n]=s;for(var a=!0,r=0;t.length>r;++r)if(!i[t[r]]){a=!1;break}a&&e&&e(i)}};if(0===t.length){var s={};W.Utils.callLater(e,[s])}else{for(var a={},r=!0,o=0;t.length>o;++o){var h=this.getDataByQuery(t[o],n(t[o]));h?a[t[o]]=h:r=!1}if(r)return a}},getDataMap:function(){return this.dataMap},getDirtyDataObjectsMap:function(){return Object.filter(this.dirtyDataObjectsMap,function(t){return t.getMeta("isPersistent")})},clone:function(t){var e=this.parent(t);return e},isReady:function(){return!0},_copyData:function(t){for(var e in this.dataMap){var i=Object.clone(this.dataMap[e].getData());t.addDataItem(e,i)}},toString:function(){return"[Data Manager]"},markAllDirty:function(){for(var t in this.dataMap)this.dirtyDataObjectsMap[t]=this.dataMap[t]},getResourceManager:function(){return W.Resources},removeDataItem:function(t){var e="string"==typeof t?t:this.getQueryOfDataItem(t);this._removeIfSafe(e)},_removeIfSafe:function(t){var e=t&&this.dataMap[t.substr(1)];e&&(0!==e.componentsWithInterest.length||this._isReferenced(t)||(e.removeAllEvents(),delete this.dataMap[t.substr(1)]))},_isReferenced:function(t){var e,i;for(e in this.dataMap)if(i=this.dataMap[e].getData(),i&&i.items&&i.items.indexOf&&-1!==i.items.indexOf(t))return!0;return!1},getQueryOfDataItem:function(t){var e;for(e in this.dataMap)if(t===this.dataMap[e])return"#"+e},getDataItem:function(t,e){"string"==typeof t?this.injects().Data.getDataByQuery(t,e):e(t)},getDataItemsList:function(t){t.length>0&&"string"==typeof t[0]},getDataItemsByType:function(t,e){var i=this._getDataItemsByTypeFromMap(t),n=this._getDefinitionsByType(t),s=Object.keys(n),a=s.map(function(t){return"#"+t});this.getDataByQueryList(a,function(t){var n=Object.append(t,i);e(n)})},_getDataItemsByTypeFromMap:function(t){var e=Object.values(this.dataMap),i=e.filter(function(e){return e.getType()==t});return i.toMap(function(t){return"#"+t.get("id")})},_getDefinitionsByType:function(t){var e=Object.filter(this.define.getDefinition(this.DEFINE_NAMESPACE),function(e){return e&&e.type===t});return e}})}),define.experimentPlugin("ExperimentDataItemPlugin",function(t){function e(t,e){var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),n=e(i),s=i._mergeField_(t,n);return s}function i(t,e){define.dataItem(t,e())}var n=t;n.init("dataItem","newDataItem",e,i)}),define.experimentPlugin("ExperimentDataPropertyItemPlugin",function(t){function e(t,e){var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),n=e(i),s=i._mergeField_(t,n);return s}function i(t,e){define.dataPropertyItem(t,e())}var n=t;n.init("dataPropertyItem","newDataPropertyItem",e,i)}),define.experimentPlugin("ExperimentDataSchemaPlugin",function(t){function e(t,e){var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),n=e(i),s=i._mergeField_(t,n);return s}function i(t,e){define.dataSchema(t,e())}var n=t;n.init("dataSchema","newDataSchema",e,i)}),define.Class("core.managers.data.PropertiesItem",function(t){var e=t;e.inherits("core.managers.data.DataItemWithSchema"),e.methods({initialize:function(t,e,i,n){this.parent(t,e,i),this._ownerComponent=n}})}),define.Const("DataEvents",{DATA_CHANGED:"dataChanged",BEFORE_CHANGE:"beforeDataChange",AFTER_CHANGE:"afterDataChange"}),define.Const("DataTypes",{TYPE_RESOURCE_KEY:"resourceKey"}),define.Const("PropertyEvents",{PROPERTY_CHANGED:"propertyChanged"}),define.Const("UrmEvents",{DATA_CHANGE_RECORDED:"dataChanged"}),define.Class("core.managers.serverfacade.CorsRESTClient",function(t){var e=t;e.inherits("core.managers.serverfacade.RESTClient"),e.methods({initialize:function(){},get:function(t,e,i){var n=this._createCorsXhr(t);n.onabort=function(){this._onXhrEvent("abort",n,i)}.bind(this),n.ontimeout=function(){this._onXhrEvent("timeout",n,i)}.bind(this),n.onerror=function(){this._onXhrEvent("error",n,i)}.bind(this),n.onload=function(){this._onXhrEvent("load",n,i)}.bind(this),n.onprogress=function(){},n.send()},_createCorsXhr:function(t,e){var i=e||"GET",n=null;try{n=new XMLHttpRequest}catch(s){}return n&&"withCredentials"in n?n.open(i,t,!0):"undefined"!=typeof XDomainRequest&&(t=-1!=t.indexOf("?")?t+"&":t+"?",t+="ctype=text/plain",n=new XDomainRequest,n.open(i,t),n.setRequestHeader=function(){}),n},_onXhrEvent:function(t,e,i){if("load"!=t||!this._isIExplorer()&&4!=e.readyState)this._onError(e,i);else{var n={};try{n=JSON.parse(e.responseText)}catch(s){}this._onSuccess(n,i)}},_isIExplorer:function(){return-1!=navigator.userAgent.indexOf("MSIE")},post:void 0,jsonp:void 0,jsonrpc:void 0})}),define.Class("core.managers.serverfacade.RESTClient",function(t){var e=t;e.statics({CALLBACK_STATUS:{SUCCESS:"success",ERROR:"error"},REQUEST_OBJECT:{jsonrpc:"2.0",id:1,method:"",params:[]}}),e.resources(["W.Utils"]),e.methods({initialize:function(){},get:function(t,e,i){var n=this._createRequestOptions(t,e,i),s=new Request.JSON(n);e?s.get(JSON.encode(e)):s.get()},post:function(t,e,i){var n=this._createRequestOptions(t,e,i);n.headers={"Content-Type":"application/json; charset=utf-8"};var s=new Request.JSON(n);s.post(JSON.encode(e))},jsonp:function(t,e,i){var n=this._createRequestOptions(t,e,i),s=new Request.JSONP(n);s.send(JSON.encode(e))},jsonrpc:function(t,e,i,n){var s=Object.clone(this.REQUEST_OBJECT);s.method=e,s.params=i,this.post(t,s,{onSuccess:function(t){t.result&&"function"==typeof n.onSuccess?n.onSuccess(t.result):"function"==typeof n.onError&&n.onError({errorDescription:"json-rpc returned an error",errorCode:-9999,payload:t.error})},onError:n.onError})},responseCallback:null,_createRequestOptions:function(t,e,i){var n=function(t){this._onSuccess(t,i)}.bind(this),s=function(t){this._onError(t,i)}.bind(this),a=function(t){this._onComplete(t,i)}.bind(this),r=function(t,e){this._onRequest(t,e,i)}.bind(this),o={url:t,urlEncoded:!1,onSuccess:n,onFailure:s,onComplete:a,onRequest:r};return o},_onSuccess:function(t,e){t?this._executeSuccessCallback(e.onSuccess,t):this._executeFailureCallback(e.onError,Constants.ServerErrors.NO_DATA),this._executeUsersCallback(this.CALLBACK_STATUS.SUCCESS,t)},_onError:function(t,e){if(t){var i=Object.clone(Constants.ServerErrors.SERVER_UNHANDLED_ERROR);i.errorCode=t.status,this._executeFailureCallback(e.onError,i)}else this._executeFailureCallback(e.onError,Constants.ServerErrors.NO_DATA);this._executeUsersCallback(this.CALLBACK_STATUS.ERROR,t)},_onComplete:function(t,e){this._executeSuccessCallback(e.onComplete,t)},_onRequest:function(t,e,i){for(var n=this.resources.W.Utils.getQueryParam("callback",t).split("."),s=window,a=0;n.length>a;a++)s=s[n[a]];"function"==typeof i.onRequest&&i.onRequest(s,t,e)},_executeSuccessCallback:function(t,e){"function"===typeOf(t)&&t(e)},_executeFailureCallback:function(t,e){"function"===typeOf(t)&&t(e.errorDescription,e.errorCode,e.payload)},_executeUsersCallback:function(t,e){this.responseCallback&&"function"===typeOf(this.responseCallback)&&this.responseCallback(t,e)}})}),define.Class("core.managers.serverfacade.WixRESTClient",function(t){var e=t;e.inherits("core.managers.serverfacade.RESTClient"),e.methods({initialize:function(){},jsonp:function(t,e,i,n){if(n){var s=this._createRequestOptions(t,e,i);s.onSuccess=function(t,e){this._onSuccess(e,i)}.bind(this),s.onComplete=function(){},s.timeout=5e3;var a=new Request.JSONP(s);a.send(JSON.encode(e))}else this.parent(t,e,i)},_onSuccess:function(t,e){this._validateServerSuccessResponse(t),t?t.success?this._executeSuccessCallback(e.onSuccess,t):this._executeFailureCallback(e.onError,t):this._executeFailureCallback(e.onError,Constants.ServerErrors.NO_DATA),this._executeUsersCallback(this.CALLBACK_STATUS.SUCCESS,t.payload)},_onComplete:function(t,e){this._validateServerSuccessResponse(t),this.parent(t,e)},_validateServerSuccessResponse:function(t){t&&t.success!==!1||LOG.reportError(wixErrors.SERVER_RETURNED_ERROR,"RESTClient","_onComplete",t)},_executeSuccessCallback:function(t,e){var i=e&&e.payload||e;this.parent(t,i)},_executeUsersCallback:function(t,e){var i=e&&e.payload||e;this.parent(t,i)}})}),define.Const("ServerErrors",{NO_DATA:{errorDescription:"no data",errorCode:-9999,payload:"no data"},SERVER_UNHANDLED_ERROR:{errorDescription:"server unhandled error",errorCode:-9999,payload:"no data"}}),define.Class("mobile.core.skins.BaseSkin",function(t){var e=t;e.resources(["W.Skins"]),e.binds(["_onStylePropChange"]),e.fields({_comps:[],_params:[{type:"domId",name:"Component ID",id:"compId",inherited:!0}],_html:"<div></div>",_css:["base {}"],_viewNode:null,_updatePartsCallback:null,_skinParts:null,_inlineContainer:null}),e.methods({initialize:function(){this._isDisposed=!1},applyStyle:function(t){t&&this._style!==t&&(this._removeOldStyle(),this._addStyle(t),this._render())},_removeOldStyle:function(){this._style&&this._style.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStylePropChange),delete this._style},_addStyle:function(t){this._style=t,this._style.addEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStylePropChange)},register:function(t,e,i){this._isRegistered()?LOG.reportError(wixErrors.SKIN_MANAGER_RE_REGISTER,"mobile.core.skins.BaseSkin","register",t.getProperty("id")):(this._viewNode=t,this._updatePartsCallback=e,this._skinParamChangeCallback=i,this._render())},unRegister:function(){this._viewNode=null,this.dispose()},_isRegistered:function(){return this._viewNode&&this._updatePartsCallback},getInlineContent:function(){return this._skinParts?this._skinParts.inlineContent?this._skinParts.inlineContent.getChildren():null:this._viewNode.getChildren()},_render:function(){if(this._isRegistered()){var t=this.getInlineContent();if(this._skinParts=this._buildSkin(),this._skinParts.inlineContent&&t){this._skinParts.inlineContent.empty();for(var e=0;t.length>e;e++)t[e].insertInto(this._skinParts.inlineContent,"bottom",Constants.DisplayEvents.MOVED_IN_DOM)}this._updatePartsCallback(this._skinParts)}},_onStylePropChange:function(t){this.resources.W.Skins.stylePropertiesChangedForSkin(this.className,this._style,t.properties),this._skinParamChangeCallback(t.properties)},_informLogicOfParamChanges:function(){},_buildSkin:function(t){return this._renderCss(),this._renderHtml(t)},_renderCss:function(){this.resources.W.Skins.buildSkinCSS(this.className,this._style)},_renderHtml:function(t){var e=this._viewNode;return t&&t.viewNode&&(e=t.viewNode),this.resources.W.Skins.buildSkinHTML(this.className,e,this._style)},renderCssIfNeeded:function(){var t=!0;if(this._style)t=this._style.isStyleRenderedForAllSkins();else{var e=this.getSkinClassData(),i=e.CSSBuildFlags;for(var n in i)if(!i[n]){t=!1;break}}t||this._renderCss()},getStyle:function(){return this._style},getParams:function(){return this._params},getCompPartsDefinition:function(){return this.compParts||{}},getCompPartSkinName:function(t){var e=this.compParts;return e&&e[t].skSin},getUniqueClass:function(t){return this.resources.W.Skins.getUniqueClass(t,this.$className)},dispose:function(){this._isDisposed=!0,this._updatePartsCallback=null,this._removeOldStyle()},getParamValue:function(t){return this.resources.W.Skins.getSkinParamValue(this.$className,t,this._style)}})}),define.Class("core.managers.skin.BaseSkin2",function(t){var e=t;e.inherits("bootstrap.managers.events.EventDispatcher"),e.binds(["_onParamChange","_onParamMapperSkinChange"]),e.resources(["W.Skins"]),e.methods({initialize:function(){},setParamMapper:function(t){this.removeParamMapper(),this._paramMapper=t,this._paramMapper.addEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onParamChange),this._paramMapper.addEvent(Constants.StyleEvents.SKIN_CHANGED,this._onParamMapperSkinChange),this._render()},getParamMapper:function(){return this._paramMapper||null},removeParamMapper:function(){this._paramMapper&&(this._paramMapper.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onParamChange),this._paramMapper.removeEvent(Constants.StyleEvents.SKIN_CHANGED,this._onParamMapperSkinChange),delete this._paramMapper)},_onParamMapperSkinChange:function(){this._paramMapper.getSkinClassName()!==this.$className&&this._logic&&this._logic.setSkinMapper(this._paramMapper)},_onParamChange:function(t){this.resources.W.Skins.stylePropertiesChangedForSkin(this.className,this._paramMapper,t.properties)},_setLogic_:function(t){this._logic=t,this._render()},_removeLogic_:function(){delete this._logic},_render:function(){if(this._logic){var t=this._logic.getInlineContent();if(this._skinParts=this._buildSkin(),this._skinParts.inlineContent&&t){this._skinParts.inlineContent.empty();for(var e=0;t.length>e;e++)t[e].insertInto(this._skinParts.inlineContent,"bottom",Constants.DisplayEvents.MOVED_IN_DOM)}this._logic._updateSkinParts_(this._skinParts)}},_buildSkin:function(){return this._renderCss(),this._renderHtml()},_renderCss:function(){this.resources.W.Skins.buildSkinCSS(this.$className,this._paramMapper)},_renderHtml:function(){var t=this._logic.getViewNode();return this.resources.W.Skins.buildSkinHTML(this.$className,t,this._paramMapper)},getCompPartsDefinition:function(){return this.compParts||{}},getParams:function(){return this._params},getCompPartSkinName:function(t){var e=this.compParts;return e&&e[t].skSin},getUniqueClass:function(t){return this.resources.W.Skins.getUniqueClass(t,this.getOriginalClassName())},getParamValue:function(t){return this.resources.W.Skins.getSkinParamValue(this.getOriginalClassName(),t,this._paramMapper)},exterminate:function(){this._removeLogic_(),this.removeParamMapper(),this.parent()}})}),define.Class("core.managers.skin.CssGarbageCollector",function(t){var e=t;e.utilize(["core.managers.skin.GCDomTraverse"]),e.binds(["runGarbageCollector"]),e.methods({initialize:function(t,e,i){this._styleDataMap=t,this._skinDataMap=e,this._skinRenderer=i,this._DomTraverserClass=this.imports.GCDomTraverse},runGarbageCollector:function(){this._domTraverser=new this._DomTraverserClass,this._domTraverser.traverseDomAndCollectUsedStyles(function(t,e){this._runGarbageCollectorOnStyles(t),this._runGarbageCollectorOnSkins(e)}.bind(this))},_runGarbageCollectorOnStyles:function(t){var e=this._findUnusedStyles(t);for(var i in e)if(e[i]){var n=e[i];this._processUnusedStyles(n)}},_findUnusedStyles:function(t){var e=Object.filter(this._styleDataMap,function(e,i){return!t.contains(i)});return e},_runGarbageCollectorOnSkins:function(t){var e=this._findUnusedSkins(t);for(var i in e){var n=this._skinDataMap[i];n&&this._removeUnusedSkinRules(n)}},_findUnusedSkins:function(t){var e=Object.filter(this._skinDataMap,function(e,i){return!t.contains(i)});return e},_processUnusedStyles:function(t){var e=t.getSkinArray(),i=t.getGroups();for(var n in i){var s=i[n];this._processUnusedStyles(s)}for(var a=0;e.length>a;a++){var r=this._skinDataMap[e[a]];r&&this._removeUnusedSkinRules(r,t.getId())}t.setStyleRenderFlag(!1)},_removeUnusedSkinRules:function(t,e){var i=t.css;if(i)for(var n=0;i.length>n;n++){e||(e="");var s=this._skinRenderer.replaceStylePlaceHolder(i[n].selector,e);this._skinRenderer.removeCssRule(s),t.CSSBuildFlags[e]=!1}}})}),define.experimentPlugin("ExperimentSkinPlugin",function(t){function e(t,e){resource.getResourceValue("W.Classes",function(t){t.getClass("core.managers.skin.SkinDefinition",function(t){n=t})});var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),s=t;"function"==typeof t&&(s=new n,t(s));var a=new n;return e(a,i),s.inherits(a._extends_||s._extends_),s.utilize(i._mergeField_(s._imports_,a._imports_)),s.fields(i._mergeObjects_(s._fields_,a._fields_)),s.compParts(i._mergeField_(s._compParts_,a._compParts_)),s.skinParams(i._mergeField_(s._skinParams_,a._skinParams_)),s.html(a._html_||s._html_),s.css(i._mergeField_(s._css_,a._css_)),s}function i(t,e){define.skin(t,e)}var n,s=t;s.init("skin","newSkin",e,i)}),define.Class("core.managers.skin.GCDomTraverse",function(t){var e=t;e.methods({initialize:function(){this._usedStyles=[],this._usedSkins=[]},traverseDomAndCollectUsedStyles:function(t){this._traverseElementAndCollect($(document.body)),t(this._usedStyles,this._usedSkins)},_traverseElementAndCollect:function(t){var e=t.isDisplayed();if(e){this._collectElementStylesSkins(t);var i=t.getChildren();if(i&&i.length)for(var n=0;i.length>n;n++)this._traverseElementAndCollect(i[n])}},_collectElementStylesSkins:function(t){var e=t.getAttribute("styleId");e&&this._usedStyles.push(e);var i=t.getAttribute("skin");i&&this._usedSkins.push(i);var n=t.getLogic&&t.getLogic().getSkin&&t.getLogic().getSkin().$className;n&&this._usedSkins.include(n)}})}),define.Class("core.managers.skin.SkinDefinition",function(t){var e=t;e.inherits(t.constructor),e.methods({initialize:function(){t.constructor.apply(this),this._compParts_={},this._skinParams_=[],this._html_="",this._css_=[]},compParts:function(t){this._compParts_=t},skinParams:function(t){this._skinParams_=t},html:function(t){this._html_=t},css:function(t){this._css_=t}})}),define.Class("core.managers.skin.SkinManager",function(t){var e=t;e.utilize(["core.managers.skin.SkinDefinition","core.managers.skin.SkinParser","core.managers.skin.SkinRenderer","core.managers.skin.CssGarbageCollector","bootstrap.utils.Queue"]),e.inherits("bootstrap.managers.BaseManager"),e.resources(["W.Classes","W.Theme","W.Utils","W.Experiments"]),e.binds(["_onClassReady","getSkin","buildSkinCSS","_onThemeChange","_checkThemePropChanges","_checkStylePropChanges","_onSkinDefineCallBack"]),e.methods({initialize:function(){this._SkinParserClass=this.imports.SkinParser,this._SkinRendererClass=this.imports.SkinRenderer,this._CssGarbageCollectorClass=this.imports.CssGarbageCollector,this._skinParser=new this._SkinParserClass,this._skinRenderer=new this._SkinRendererClass,this._skinQue=new this.imports.Queue,this._skinClassMap={},this._pendingSkinClassMap={},this._skinDataMap={},this._styleDataMap={},this._cssGarbageCollector=new this._CssGarbageCollectorClass(this._styleDataMap,this._skinDataMap,this._skinRenderer),this._classManager=this.resources.W.Classes,this._classManager.addClassNamespaceHook(this.getSkin),this._classManager.addClassReadyHandler(this._onClassReady),this.resources.W.Theme.addEvent("propertyChange",this._onThemeChange),this.define.skin.definitionModifier=this._onSkinDefineCallBack.bind(this)},_onSkinDefineCallBack:function(t,e){var i=this._skinQue.getQueue(t);return i&&i.length>0&&this.registerNewSkin(t,e),e},registerNewSkin:function(t,e){if(!this._isSkinRegister()){var i=new this.imports.SkinDefinition;e(i),i=this.resources.W.Experiments.applyExperiments(t,i),this._fixSkinDefinition(t,i),this._validateNewSkin(t),this._addSkinDependencies(t,i),this._pendingSkinClassMap[t]="pending",this._classManager.registerClassDefinition(t,i)}},_isSkinRegister:function(t){return this._pendingSkinClassMap[t]||this._skinDataMap[t]},_fixSkinDefinition:function(t,e){var i=e._fields_;i._html=e._html_,i._css=e._css_,i._params=e._skinParams_,i.compParts=e._compParts_},_validateNewSkin:function(t){return this._skinClassMap[t]||this._skinDataMap[t]?(LOG.reportError(wixErrors.SKIN_ALREADY_EXIST,this.className,"newSkin",t+""),void 0):void 0},_addSkinDependencies:function(t,e){var i=e._imports_||[],n=e._compParts_||{};for(var s in n){var a=n[s].skin;if(a&&0>i.indexOf(a)){var r=this.getNameOverride(a);i.push(r)}}e.utilize(i)},newSkin:function(t){this.define.oldSkin(t)},override:function(t,e){if(!t)throw Error("null/undefine skin name to override: ");this.getSkin(t,function(){this._skinClassMap[t]=e}.bind(this))},getSkin:function(t,e){if(t=this.getNameOverride(t),this._skinClassMap[t])return this.resources.W.Utils.callLater(e,[this._skinClassMap[t]]),this._skinClassMap[t];var i=this._skinQue.hasQueue(t)===!1;if(this._skinQue.add(t,e),i){var n=this.define.getDefinition("skin"),s=nsUtil.getNameSpace(n,t);s?this.registerNewSkin(t,s):this._classManager.getClass(t,function(){})}return null},getNameOverride:function(t){return this.define.Class.$nameOverrides[t]||t},_onClassReady:function(t,e){return this._pendingSkinClassMap[t]?(this._onSkinClassReady(t,e),this._skinQue.getQueue(t).forEach(function(t){t&&t(e)}.bind(this)),void 0):(this._skinQue.removeKey(t),void 0)},_onSkinClassReady:function(t,e){var i=this._skinParser.parseSkinData(t,e);this._skinDataMap[t]=i,e.prototype.getSkinClassData=function(){return i},this._onSkinReady(e,t)},_onSkinReady:function(t,e){this._skinClassMap[e]=t,this._skinQue.getQueue(e).forEach(function(t){t&&t(this._skinClassMap[e])}.bind(this)),this._skinQue.removeKey(e)},_$getCssId:function(){return this._skinRenderer.getCssNodeId()},isReady:function(){return!this._skinQue.hasQueue()},buildSkinCSS:function(t,e){var i=this._skinDataMap[t];if(!i)return LOG.reportError(wixErrors.SKIN_MANAGER_NO_DATA_FOR_SKIN,"mobile.core.managers.SkinManager","buildSkinCSS",t),void 0;var n=this._skinRenderer.getStyleId(e);i.CSSBuildFlags[n]||e&&e.isStyleRenderedForSkin(t)||(e?(this._styleDataMap[n]=e,e.setStyleRenderFlagForSkin(t,!0)):i.CSSBuildFlags[n]=!0,this._skinRenderer.registerSkinCSSNow(i,e))},buildSkinHTML:function(t,e,i){if(!t||!e){var n=e&&e.getProperty("id");return LOG.reportError(wixErrors.SKIN_MANAGER_MISSING_ARGUMENTS,"mobile.core.managers.SkinManager","buildSkinHTML","skinName="+t+" compId="+n+"compViewNode: "+e),{}
}var s=this._skinDataMap[t];return s?this._skinRenderer.buildSkinHTML(s,e,i):(LOG.reportError(wixErrors.SKIN_MANAGER_NO_DATA_FOR_SKIN,"mobile.core.managers.SkinManager","buildSkinHTML",t),{})},stylePropertiesChangedForSkin:function(t,e,i){var n=e&&e.getId();if(t&&n&&i){this._styleChangedProps||(this._styleChangedProps={}),this._styleChangedProps[t]=this._styleChangedProps[t]||{},this._styleChangedProps[t][n]=this._styleChangedProps[t][n]||{style:e,props:{}};for(var s in i)this._styleChangedProps[t][n].props[s]="";this._styleChangeCallLater||(this._styleChangeCallLater=this.resources.W.Utils.callOnNextRender(this._checkStylePropChanges,100))}},_onThemeChange:function(t){var e=t.name;e&&(this._themeChangedProps||(this._themeChangedProps={}),this._themeChangedProps[e]=t,this._themeChangeCallCallLater||(this._themeChangeCallCallLater=this.resources.W.Utils.callOnNextRender(this._checkThemePropChanges,100)))},_checkStylePropChanges:function(){var t,e,i,n,s,a,r,o;delete this._styleChangeCallLater;for(t in this._styleChangedProps){e=this._styleChangedProps[t],i=this._skinDataMap[t];for(n in e)for(s=e[n].style,a=e[n].props,r=i.css,o=0;r.length>o;++o)this._isSkinCssClassContainsPartialParams(r[o],a,"id")&&this._skinRenderer.updateSkinCSSClass(r[o].selector,r[o].rules,r[o].params,i.params,s)}delete this._styleChangedProps},_checkThemePropChanges:function(){if(delete this._themeChangeCallCallLater,this===W.Skins)for(var t in this._skinDataMap)for(var e=this._skinDataMap[t],i=this._skinDataMap[t].css,n=0;i.length>n;++n)this._isSkinCssClassContainsPartialParams(i[n],this._themeChangedProps,"defaultTheme")&&this._skinRenderer.updateSkinCSSClass(i[n].selector,i[n].rules,i[n].params,e.params);delete this._themeChangedProps},_isSkinCssClassContainsPartialParams:function(t,e,i){var n=t.params;for(var s in e)for(var a=0;n.length>a;++a)if(n[a][i]&&n[a][i]==s)return!0;return!1},getSkinParamValue:function(t,e,i){for(var n=this._skinDataMap[t].params,s=0;n.length>s;s++){var a=n[s];if(a.id==e)return this._skinRenderer.getParamValue(a,i)}return null},getUniqueClass:function(t,e){var i=this._skinParser.getSkinCSSName(e),n=this._skinParser.getUniqueClass(t,i);return n.uniqueClass}})}),define.Class("core.managers.skin.SkinParser",function(t){var e=t;e.methods({parseSkinData:function(t,e){var i=e.prototype,n=i._params||[],s=i._html||"",a=i._css||[],r=[],o={},h={},l=this._addStylePlaceHolder(this.getSkinCSSName(t));n=this._processSkinParams(n,t);for(var c=0;a.length>c;++c){var d=a[c];if(d)this._processSkinCssClass(d,n,l,h,o,r);else{var u="";try{u=a.join(",")}catch(_){}LOG.reportError(wixErrors.SKIN_PROBLEM_WITH_RULE,this.className,"_registerSkinData",t+"("+c+") : "+u)}}return{name:t,params:n,html:s,css:r,compParts:i.compParts||{},skinPartClasses:o,skinSpecificClasses:h,skinCSSName:l,CSSBuildFlags:{},canFocus:!!i.canFocus}},getSkinCSSName:function(t){return t.replace(/\./g,"_")},_processSkinParams:function(t,e){for(var i=0;t.length>i;++i){var n=t[i];if(n.defaultParam&&(n.defaultParam=this._getParamById(t,n.defaultParam),n.defaultParam||(LOG.reportError(wixErrors.SKIN_PARAM_REF_NOT_FOUND,e,"_processSkinParams/defaultParam",n.id)(),delete n.defaultParam,n.defaultValue="")),n.sumParams){for(var s=[],a=0;n.sumParams.length>a;++a){var r=this._getParamById(t,n.sumParams[a]);r?s.push(r):LOG.reportError(wixErrors.SKIN_PARAM_REF_NOT_FOUND,e,"_processSkinParams/sumParams",n.sumParams[a])()}n.sumParams=s}}return t},_getParamById:function(t,e){for(var i=0;t.length>i;++i)if(t[i].id===e)return t[i];return null},_processSkinCssClass:function(t,e,i,n,s,a){var r=t.indexOf("{"),o=t.lastIndexOf("}");if(-1!=r&&-1!=o&&o-1>r)for(var h=t.substr(0,r),l=t.substring(r+1,o),c=this._getParamsUsed(l,e),d=h.split(","),u=0;d.length>u;++u)h=this._processSkinCssSelector(d[u],i,n,s),a.push({selector:h,rules:l,params:c})},_processSkinCssSelector:function(t,e,i,n){var s=this._convertCssSelector(t,e,i,n),a=t.length?t.charAt(0):"",r="["==a||":"==a||""===a||"{"==a||"."==a||">"==a;if(r||s==t){var o=r?"":" ";s="."+e+o+s}return s=s.trim().replace(/\s+/g," ")},_convertCssSelector:function(t,e,i,n){var s,a,r=/%(\.?[a-z0-9]+)%/i;for(s=t.match(r);s&&!(2>s.length);){a=s[1];var o=this.getUniqueClass(a,e);"class"==o.type?i[a.substring(1)]=o.uniqueClass:n[a]=o.uniqueClass,t=t.replace(r,"."+o.uniqueClass),s=t.match(r)}return t},getUniqueClass:function(t,e){var i={};if("."==t.charAt(0)){var n=t.substring(1);i.uniqueClass=e+"-c-"+n,i.type="class"}else i.uniqueClass=e+"-"+t,i.type="skinPart";return i},_getParamsUsed:function(t,e){var i=[];if(!t||!e||0===e.length)return i;for(var n=0,s=e.length;s>n;++n)-1!=t.indexOf("["+e[n].id+"]")&&(i[e[n].id]=e[n]);var a={};for(var r in i){var o=i[r];if(o.defaultParam){for(;void 0!==o.defaultParam;)o=o.defaultParam;a[o.id]=o}}return Object.values(Object.merge(i,a))},_addStylePlaceHolder:function(t){return t+Constants.skinManager.STYLE_CSS_PLACEHOLDER}})}),function(){var t=null;define.Class("core.managers.skin.SkinRenderer",function(e){var i=e;i.utilize(["core.utils.css.BorderRadius","core.utils.css.Color","core.utils.css.Size","core.utils.css.Font","core.utils.css.BoxShadow"]),i.methods({initialize:function(){this._stylesheet=this._generateSkinsStylesSheet()},replaceStylePlaceHolder:function(t,e){return t.split(Constants.skinManager.STYLE_CSS_PLACEHOLDER).join(e)},registerSkinCSSNow:function(t,e){for(var i=t.css,n=0;i.length>n;++n)this.updateSkinCSSClass(i[n].selector,i[n].rules,i[n].params,t.params,e)},updateSkinCSSClass:function(t,e,i,n,s){styleId=this.getStyleId(s);for(var a=0;i.length>a;++a){var r=i[a],o=r.id,h=this._getParamValue(r,s),l=this._paramValueToCss(h,r);null===l&&(l=""),e=e.split("["+o+"]").join(l)}if(t=this.replaceStylePlaceHolder(t,styleId),s&&s.isCssRedirectedToStyle())s.updateCssRule(t,e);else try{this._stylesheet.updateRule(t,e)}catch(c){}},getParamValue:function(t,e){return this._getParamValue(t,e)},_getParamValue:function(t,e){var i=null;if(t.defaultParam){var n=t.defaultParam;return this._applyParamMutators(this._getParamValue(n,e),t)}if(e&&e.getProperty(t.id)){var s=e.getPropertySource(t.id);return i=e.getProperty(t.id),"theme"==s&&(i=this.injects().Theme.getProperty(i)),i=this._castToType(i,t),i=this._addExtraToParamByType(t,i,e),this._applyParamMutators(i,t)}if(t.defaultTheme){var a=t.defaultTheme,r=W.Theme.getProperty(a);return r=this._castToType(r,t),this._applyParamMutators(r,t)}if(t.sumParams){var o=t.sumParams;if(o&&"array"==typeOf(o)&&o.length>0){var h=this._getParamValue(o[0],e);if(h.add&&"function"==typeof h.add)for(var l=1;o.length>l;l++)h.add(this._getParamValue(o[l],e));return this._applyParamMutators(h,t)}}return t.defaultValue?(i=this._castToType(t.defaultValue,t),this._applyParamMutators(i,t)):null},_castToType:function(t,e){switch(e.type){case Constants.SkinParamTypes.COLOR:case Constants.SkinParamTypes.COLOR_ALPHA:case Constants.SkinParamTypes.BG_COLOR:t=new this.imports.Color(t);break;case Constants.SkinParamTypes.SIZE:t=new this.imports.Size(t);break;case Constants.SkinParamTypes.BOX_SHADOW:t=new this.imports.BoxShadow(t);break;case Constants.SkinParamTypes.BORDER_RADIUS:t=new this.imports.BorderRadius(t);break;case Constants.SkinParamTypes.FONT:t=new this.imports.Font(t)}return t},_addExtraToParamByType:function(t,e,i){var n=i.getPropertyType(t.id);if("color"==n){var s=i.getPropertyExtraParamValue(t.id,"alpha");e.setAlpha(s)}return"boxShadow"==n&&e.setToggleOn(i.getPropertyExtraParamValue(t.id,"isOn")===!0),e},_applyParamMutators:function(t,e){if(e.mutators)for(var i=0;e.mutators.length>i;i+=2){var n=t[e.mutators[i]];if(n&&"function"==typeof n){var s=e.mutators[i+1];s&&"array"==typeOf(s)||(s=s?[s]:[]),t=n.apply(t,s)}else LOG.reportError(wixErrors.SKIN_PARAM_MUTATOR_FUNC_NOT_FOUND,"SkinRenderer","_applyParamMutators",n)()}return t},_paramValueToCss:function(t,e){var i=Constants.skinManager.FEATURES;if(void 0!==t&&null!==t){switch(e=e||{},e.type){case Constants.SkinParamTypes.BG_COLOR:var n=t,s=n.getAlpha();s>0?Modernizr.rgba===!0&&1>s?t="background-color:rgba("+n.getRgba()+");":(t="background-color:"+n.getHex(!1)+";",i.filter_alpha&&1>s&&(t+="filter:alpha(opacity="+100*s+");")):t="background-color:transparent;";break;case Constants.SkinParamTypes.BORDER_RADIUS:var a=W.Utils.getCSSBrowserFeature("border-radius");t=a?a+":"+t+";":"";break;case Constants.SkinParamTypes.TRANSITION:a=W.Utils.getCSSBrowserFeature("transition"),t=a?a+":"+t+";":"";break;case Constants.SkinParamTypes.BOX_SHADOW:t=W.Utils.getCSSBrowserFeature("box-shadow")?W.Utils.getCSSBrowserFeature("box-shadow")+":"+t.getCssValue()+";":"";break;case Constants.SkinParamTypes.FONT:t="font:"+t.getCssValue()+";";break;case Constants.SkinParamTypes.SIZE:t=t.getCssValue();break;case Constants.SkinParamTypes.COLOR:t=void 0!==t.getHex?t.getHex(!1):t;break;case Constants.SkinParamTypes.COLOR_ALPHA:n=t,s=n.getAlpha(),t=s>0?Modernizr.rgba===!0&&1>s?"rgba("+n.getRgba()+")":n.getHex(!1):"transparent"}return t}return null},buildSkinHTML:function(t,e,i){styleId=this.getStyleId(i);var n=t.html,s=this.replaceStylePlaceHolder(t.skinCSSName,styleId);e.empty(),e.set("html",n),e.set("styleId",styleId),e.set("skin",t.name),t.canFocus?e.tabIndex=0:0===e.tabIndex&&(e.tabIndex=-1),e._wixCSSName&&(e.removeClass(e._wixCSSName),delete e._wixCSSName),s&&(e.addClass(s),e._wixCSSName=s);for(var a={view:e},r=$$(e.getElements("[skinPart]")),o=t.compParts||{},h=t.skinPartClasses||{},l=0;r.length>l;++l){var c=r[l],d=c.getAttribute("skinPart");a[d]=c;var u=h[d];u&&c.addClass(this.replaceStylePlaceHolder(u,styleId));var _=c.getAttribute("skin");!_&&o[d]&&o[d].skin&&(_=o[d].skin,_&&c.setAttribute("skin",_))}var p=t.skinSpecificClasses||{};for(var m in p){var g=$(e).getElements("."+m);g.removeClass(m).addClass(this.replaceStylePlaceHolder(p[m],styleId))}return a},getStyleId:function(t){return t&&t.getId()||""},_skinStyleNodeId:null,_generateSkinsStylesSheet:function(){return t||(t=W.Utils.createStyleSheet("WIX_SKIN_STYLES")),this._skinStyleNodeId=t.styleNode.get("id"),t},getCssNodeId:function(){return this._skinStyleNodeId},removeCssRule:function(t){this._stylesheet.removeRuleBySelector(t)}})})}(),function(){var t={},e=document.createElement("div"),i=function(i,n,s){e.style.cssText=n,t[i]=s(e)};i("filter_alpha","filter:alpha(opacity=0.9);",function(t){return void 0!==t.style.filter&&-1!=t.style.filter.indexOf("alpha")}),i("opacity","opacity:0.7;",function(t){return void 0!==t.style.opacity&&"0.7"==t.style.opacity}),i("background-color_rgba","background-color:rgba(255,0,0,0.5);",function(t){return void 0!==t.style.backgroundColor&&-1!=t.style.backgroundColor.indexOf("rgba")}),i("border-radius","border-top-right-radius:0.1em;",function(t){return void 0!==t.style.borderTopRightRadius&&-1!=t.style.borderTopRightRadius.indexOf("0.1em")}),i("-webkit-border-radius","-webkit-border-top-right-radius:0.2em;",function(t){return void 0!==t.style.webkitBorderTopRightRadius&&-1!=t.style.webkitBorderTopRightRadius.indexOf("0.2em")}),i("-moz-border-radius","-moz-border-radius-topright:0.3em;",function(t){return void 0!==t.style.MozBorderRadiusTopright&&-1!=t.style.MozBorderRadiusTopright.indexOf("0.3em")}),define.Const("skinManager",{STYLE_CSS_PLACEHOLDER:"[STYLE_PH]",FEATURES:t})}(),define.Const("SkinParamCssTypesToGeneralTypesMap",{cssBorderRadius:"radius",cssBgColor:"color",boxShadow:"boxShadow",color:"color",color_alpha:"color",cssFont:"font",size:"size",cssStr:"string",url:"url",transition:"transition"}),define.Const("SkinParamTypes",{BORDER_RADIUS:"cssBorderRadius",BG_COLOR:"cssBgColor",BOX_SHADOW:"boxShadow",COLOR:"color",COLOR_ALPHA:"color_alpha",FONT:"cssFont",SIZE:"size",OTHER:"cssStr",URL:"url",TRANSITION:"transition"}),define.Class("core.managers.style.SkinExtraParamHandler",function(t){var e=t;e.inherits("bootstrap.utils.Events"),e.statics({PROPERTY_TYPE_EXTRA_PARAMS:{color:{alpha:{prefix:"alpha",defaultValue:1,type:"number"}},boxShadow:{isOn:{prefix:"boxShadowToggleOn",defaultValue:!0,type:"boolean"}}}}),e.methods({initialize:function(t,e,i){this._properties=t,this._propertiesTypes=e,this._propertiesCounter=i},getPropertyExtraParamValue:function(t,e){var i=this._getPropertyExtraParamDefinition(t,e);if(i){var n=this._getPropertyExtraParamId(t,i.prefix);return this._convertStringToType(this._properties[n],i.type)}},_getPropertyExtraParamDefinition:function(t,e){var i=this._propertiesTypes[t],n=this._getExtraParamDefinitionByType(i,e);return n?n:(LOG.reportError(wixErrors.STYLE_EXTRA_PARAM_DEFINITION_MISSING,"SkinExtraParamHandler","_getPropertyExtraParamDefinition",i+"-"+e)(),void 0)},_getExtraParamDefinitionByType:function(t,e){return this.PROPERTY_TYPE_EXTRA_PARAMS[t]&&this.PROPERTY_TYPE_EXTRA_PARAMS[t][e]},_getPropertyExtraParamId:function(t,e){return e+"-"+t},_convertStringToType:function(t,e){switch(e){case"number":t=Number(t);break;case"boolean":t="true"===(t+"").toLowerCase()}return t},setPropertyExtraParamValue:function(t,e,i){var n=this._getPropertyExtraParamDefinition(t,e);if(n){var s=this._getPropertyExtraParamId(t,n.prefix);return this._properties[s]=i+"",s}},setPropertyExtraParams:function(t,e){var i=e.type,n=this.PROPERTY_TYPE_EXTRA_PARAMS[i];if(n){var s=e.styleDefaults;for(var a in n){var r,o=n[a],h=this._getPropertyExtraParamId(t,o.prefix);r=this._properties[h]?this._properties[h]:s&&s[o.prefix]?s[o.prefix]:o.defaultValue,this._properties[h]=r,this._propertiesTypes[h]=i+"-"+a,this._increasePropertyUseCount(h)}}},_increasePropertyUseCount:function(t){this._propertiesCounter[t]?this._propertiesCounter[t]+=1:this._propertiesCounter[t]=1}})}),define.Class("core.managers.style.SkinParamMapper",function(t){var e=t;e.inherits("bootstrap.utils.Events"),e.utilize(["bootstrap.utils.BufferFunction","core.managers.style.SkinParamParser","core.managers.style.SkinParamRenderHandler"]),e.binds(["_onThemePropertiesChange"]),e.methods({initialize:function(t,e,i){this.SkinParserClass=this.imports.SkinParamParser,this.SkinParamRenderHandlerClass=this.imports.SkinParamRenderHandler,this._dataItem=t,this._rawData=e,this._mapId=this._dataItem.get("id")+"-"+this.getNewGroupIdCounter(),i="string"==typeof i?W.Skins.getSkin(i):i,this._skin=new i,this._initMapProperties(),this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this._garbageCollection(),this.resource.getResourceValue("W.Theme",function(t){t.getDataItem().addEvent(Constants.DataEvents.DATA_CHANGED,this._onThemePropertiesChange)}.bind(this))},_initMapProperties:function(){this._rawData.properties=this._rawData.properties||{},this._rawData.groups=this._rawData.groups||{},this._rawData.propertiesSource=this._rawData.propertiesSource||{}},setSkin:function(t){var e=new t;return this._skin.$className==e.$className?!1:(this._skin=e,this._dataItem.set("skin",this._skin.$className),this._rawData.properties={},this._rawData.propertiesSource={},this._rawData.groups={},this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY),!0)},getSkin:function(){return this.getSkinClassName()},getSkinClassName:function(){return this._skin.$className},getSkinClass:function(){return this._skin.$class},getDataItem:function(){return this._dataItem},getPropertyExtraParamValue:function(t,e){return this._skinParser.getPropertyExtraParamValue(t,e)},setPropertyExtraParamValue:function(t,e,i,n){var s=this._skinParser.setPropertyExtraParamValue(t,e,i),a={},r={};a[s]=this._skinParser.getProperty(s),this._dataItem.fireDataChangeEvent(t,a,r),n&&this._firePropertyChangesEvent(t,a)},_onThemePropertiesChange:function(t,e){for(var i in e){var n=this._skinParser.getProperties();for(var s in n)this.getPropertySource(s)==Constants.STYLE.SOURCE.THEME&&n[s]==i&&this._firePropertyChangesEvent(s)}},_firePropertyChangesEvent:function(t){this._changes||(this._changes={}),this._changes[t]=this._skinParser.getPropertyType(t),this.injects().Utils.clearCallLater(this._dispatchEventId),this._dispatchEventId=this.injects().Utils.callLater(this._dispatchChangeEventAndResetChanges,[],this,50)},_dispatchChangeEventAndResetChanges:function(){this.fireEvent(Constants.StyleEvents.PROPERTY_CHANGED,{style:this,properties:this._changes}),this._changes={}},updateCssRule:function(t,e){this._changedCssClasses||(this._changedCssClasses={}),this._changedCssClasses[t]=e,this._dispatchCssChanges()},_dispatchCssChanges:function(){this.fireEvent("cssChanged",this._changedCssClasses),this._changedCssClasses={}},setRedirectCssTarget:function(t){this._redirectCssTarget=t===!0},isCssRedirectedToStyle:function(){return this._redirectCssTarget},_garbageCollection:function(){this.setStyleRenderFlag(!1),this._skinParser.garbageCollection()},addInnerSkin:function(t,e,i){this._skinParser.parseSkinByInstance(t,e,i)},getNewGroupIdCounter:function(){return this._groupIdCounter=this._groupIdCounter||0,this._groupIdCounter++,this._groupIdCounter},getMapId:function(){return this._mapId},getId:function(){return this._dataItem.get("id")},getProperty:function(t){return this._skinParser.getProperty(t)},setProperty:function(t,e){this._skinParser.setProperty(t,e);var i={},n={};i[t]=e,n[t]=this.getProperty(t),this._dataItem.fireDataChangeEvent(t,i,n),this._firePropertyChangesEvent(t)},getProperties:function(){return this._skinParser.getProperties()},getGroups:function(){return this._skinParser.getInnerSkins()},isPropertyAvailable:function(t){return this._skinParser.getProperty(t)?!0:!1},getPropertySource:function(t){return this._skinParser.getPropertySource(t)},getPropertyType:function(t){return this._skinParser.getPropertyType(t)},getStyleByGroupName:function(t){return this._skinParser.getInnerSkin(t)},getSkinArray:function(){return this._skinParser.getUsedSkinArray()},changePropertySource:function(t,e,i){this._skinParser.setPropertySource(t,i),this.setProperty(t,e)},getPropertyLangKey:function(t){return this._skinParser.getPropertyLangKey(t)},isStyleRenderedForSkin:function(t){return this._skinParamRenderHandler.isSkinParamRenderedForSkin(t)},isStyleRenderedForAllSkins:function(){return this._skinParamRenderHandler.isSkinParamRenderedForAllSkins()},setStyleRenderFlag:function(t){this._skinParamRenderHandler.setSkinParamRenderFlag(t)},setStyleRenderFlagForSkin:function(t,e){this._skinParamRenderHandler.setSkinParamRenderFlagForSkin(t,e)},invalidateStyle:function(){this._skinParamRenderHandler.invalidateSkinParamMapper()},getStyleType:function(){return this._dataItem.get("styleType")},setStyleType:function(t){this._dataItem.set("styleType",t)},getIsCustomStyle:function(){return"custom"===this.getStyleType()},setIsCustomStyle:function(t){this.setStyleType(t?"custom":"system")},getCompClassName:function(){return this._dataItem.get("componentClassName")},setCompClassName:function(t){this._dataItem.set("componentClassName",t)},getPageId:function(){return this._dataItem.get("pageId")},setPageId:function(t){this._dataItem.set("pageId",t)},getCompId:function(){return this._dataItem.get("compId")},setCompId:function(t){this._dataItem.set("compId",t)},getRawData:function(){return this._rawData}})}),define.Class("core.managers.style.SkinParamParser",function(t){var e=t;e.utilize(["core.managers.style.SkinParamSourceHandler","core.managers.style.SkinExtraParamHandler"]),e.inherits("bootstrap.utils.Events"),e.statics({STYLE_PROPERTIES_FILTER:{color:[Constants.STYLE.SOURCE.THEME],font:[Constants.STYLE.SOURCE.THEME],radius:[Constants.STYLE.SOURCE.VALUE],size:[Constants.STYLE.SOURCE.VALUE],boxShadow:[Constants.STYLE.SOURCE.VALUE]}}),e.methods({initialize:function(t,e,i,n){this._innerSkinMaps={},this._properties=e.properties||{},this._propertiesTypes={},this._propertiesCounter={},this._propertiesLangKey={},this._usedSkinNamesArray=[],this.SkinMapperClass=n;var s=this.imports.SkinParamSourceHandler,a=this.imports.SkinExtraParamHandler;this._paramSourceHandler=new s(e.propertiesSource),this._extraParamHandler=new a(this._properties,this._propertiesTypes,this._propertiesCounter),this._parseSkinAndData(t,e,i)},parseSkinByInstance:function(t,e,i){var n=new i;this._parseSkinAndData(t,e,n)},_parseSkinAndData:function(t,e,i){this._addUsedSkinName(i.$className),this._saveSkinParams(i.getParams()),this._parseSkinInnerComponents(t,e,i.getCompPartsDefinition(),i.imports)},_addUsedSkinName:function(t){this._usedSkinNamesArray.push(t)},_saveSkinParams:function(t){for(var e=0;t.length>e;e++)this._addProperty(t[e])},_addProperty:function(t){var e=t.id,i=this._createParamDataObj(t);if("unknown"!=i.source&&!i.ignore){this._properties[e]=this._properties[e]||t.defaultTheme||t.defaultValue,this._propertiesTypes[e]=i.type,this._propertiesLangKey[e]=i.langKey;var n=this.getPropertySource(e)||i.source;this.setPropertySource(e,n),this._increasePropertyUseCount(e),this._extraParamHandler.setPropertyExtraParams(e,i)}},_createParamDataObj:function(t){var e={};t.defaultTheme?(e.source=Constants.STYLE.SOURCE.THEME,e.value=t.defaultTheme,e.type=W.Theme.getPropertyType(t.defaultTheme)):t.defaultValue&&(e.source=Constants.STYLE.SOURCE.VALUE,e.value=t.defaultValue,e.type=this._getGeneralTypeFromCssType(t.type)),e.langKey=t.lang||t.id,e.styleDefaults=t.styleDefaults||{};var i=t.noshow===!0,n=this.STYLE_PROPERTIES_FILTER[e.type],s=n&&n.contains(e.source);return e.ignore=i===!0||s!==!0,e.ignore=t.enableEdit===!0?!1:e.ignore,e},_getGeneralTypeFromCssType:function(t){return Constants.SkinParamCssTypesToGeneralTypesMap[t]||"unknown"},_increasePropertyUseCount:function(t){this._propertiesCounter[t]?this._propertiesCounter[t]+=1:this._propertiesCounter[t]=1},garbageCollection:function(){for(var t in this._properties)this._propertiesCounter[t]||delete this._properties[t]},_parseSkinInnerComponents:function(t,e,i,n){for(var s in i){var a=i[s].skin,r=i[s].styleGroup,o=this._findSkinByName(a,n);if(r)if("inherit"==r)this.parseSkinByInstance(t,e,o);else{var h=e.groups&&e.groups[r]?e.groups[r]:{properties:{},groups:{}};if(this._innerSkinMaps[r])this._innerSkinMaps[r].addInnerSkin(t,h,o);else{var l=new this.SkinMapperClass(t,h,o);this._innerSkinMaps[r]=l}}}},_findSkinByName:function(t,e){var i=t.substring(t.lastIndexOf(".")+1),n=Object.filter(e,function(t,e){return e==i});return n[i]},getInnerSkins:function(){return this._innerSkinMaps},getInnerSkin:function(t){return this._innerSkinMaps[t]},getProperties:function(){return this._properties},getProperty:function(t){return this._properties[t]},setProperty:function(t,e){this._properties[t]=e},getPropertiesTypes:function(){return this._propertiesTypes},getPropertySource:function(t){return this._paramSourceHandler.getPropertySource(t)},setPropertySource:function(t,e){return this._paramSourceHandler.setPropertySource(t,e)},getPropertyType:function(t){return this._propertiesTypes[t]},getUsedSkinArray:function(){return this._usedSkinNamesArray},setPropertyExtraParamValue:function(t,e,i){return this._extraParamHandler.setPropertyExtraParamValue(t,e,i)},getPropertyExtraParamValue:function(t,e){return this._extraParamHandler.getPropertyExtraParamValue(t,e)},getPropertyLangKey:function(t){return this._propertiesLangKey[t]}})}),define.Class("core.managers.style.SkinParamRenderHandler",function(t){var e=t;e.methods({initialize:function(t){this._innerSkinMaps=t,this._skinParamRenderFlags={}},isSkinParamRenderedForSkin:function(t){return this._skinParamRenderFlags[t]||!1},isSkinParamRenderedForAllSkins:function(){for(var t in this._skinParamRenderFlags)if(!this._skinParamRenderFlags[t])return!1;return!0},setSkinParamRenderFlag:function(t){for(var e in this._skinParamRenderFlags)this.setSkinParamRenderFlagForSkin(e,t)},setSkinParamRenderFlagForSkin:function(t,e){this._skinParamRenderFlags[t]=e},invalidateSkinParamMapper:function(){this.setSkinParamRenderFlag(!1);for(var t in this._innerSkinMaps)this._innerSkinMaps[t].invalidateStyle()}})}),define.Class("core.managers.style.SkinParamSourceHandler",function(t){var e=t;e.methods({initialize:function(t){this._propertiesSource=t||{}},getPropertiesSource:function(){return this._propertiesSource},getPropertySource:function(t){return this._propertiesSource[t]},setPropertySource:function(t,e){this._isPropertySourceValid(e)?this._propertiesSource[t]=e:LOG.reportError(wixErrors.STYLE_PROP_SRC_UNKNOWN,"SkinParamSourceHandler","setPropertySource",e)()},_isPropertySourceValid:function(t){var e=!1;for(var i in Constants.STYLE.SOURCE)Constants.STYLE.SOURCE[i]===t&&(e=!0);return e}})}),define.Class("core.managers.style.Style",function(t){var e=t;e.inherits("core.managers.style.StyleProperties"),e.methods({initialize:function(t){this._ready=!1,t&&this._setStyleDataItem(t)},_setStyleDataItem:function(t){this._skinName=t.get("skin"),this._resetDataCollection(),t.get("style")||t.set("style",{}),this._configStyle(t.get("style"),t,this._skinName,this)},_resetDataCollection:function(){this._groupIdCounter=0;var t=this._onProcessAllSkins.bind(this);this.unprocessedSkins={map:{},size:0,add:function(t){this.map[t]?this.map[t]=1:this.map[t]++,this.size++},remove:function(e){this.map[e]&&this.map[e]--,this.size--,0===this.size&&t()}}},_onProcessAllSkins:function(){this._garbageCollection(),this._oldSkinName!=this._skinName&&this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY,this),this._ready=!0},isReady:function(){return this._ready},getNewGroupId:function(){return this._groupIdCounter=this._groupIdCounter||0,this._groupIdCounter++,this._groupIdCounter},setSkin:function(t){return this._skinName==t?!1:(this._ready=!1,this._resetUsedSkinNameArray(),this.setStyleRenderFlag(!1),this._oldSkinName=this._skinName,this._skinName=t,this._styleDataItem.set("skin",t),this._styleRawData.properties={},this._styleRawData.propertiesSource={},this._styleRawData.groups={},this._resetData(this._styleRawData.properties,this._styleRawData.propertiesSource,this._styleRawData.groups),this.createStylesAndRawData(this._styleRawData,t),!0)},getSkin:function(){return this._skinName},getId:function(){return this._styleDataItem.get("id")}})}),define.Class("core.managers.style.StyleProperties",function(t){var e=t;e.utilize(["bootstrap.utils.BufferFunction"]),e.inherits("bootstrap.utils.Events"),e.binds(["_onThemePropertiesChange"]),e.statics({STYLE_PROPERTIES_FILTER:{color:[Constants.STYLE.SOURCE.THEME],font:[Constants.STYLE.SOURCE.THEME],radius:[Constants.STYLE.SOURCE.VALUE],size:[Constants.STYLE.SOURCE.VALUE],boxShadow:[Constants.STYLE.SOURCE.VALUE]},PROPERTY_TYPE_EXTRA_PARAMS:{color:{alpha:{prefix:"alpha",defaultValue:1,type:"number"}},boxShadow:{isOn:{prefix:"boxShadowToggleOn",defaultValue:!0,type:"boolean"}}}}),e.methods({initialize:function(t,e,i,n){t&&e&&i&&n&&this._configStyle(t,e,i,n)},setRedirectCssTarget:function(t){this._redirectCssTarget=t===!0},isCssRedirectedToStyle:function(){return this._redirectCssTarget},updateCssRule:function(t,e){this._changedCssClasses[t]=e,this._dispatchCssChanges()},_dispatchCssChanges:function(){this.fireEvent("cssChanged",this._changedCssClasses),this._changedCssClasses={}},_configStyle:function(t,e,i,n){this._redirectCssTarget=!1,this._changedCssClasses={};var s=new this.imports.BufferFunction(this,"_dispatchCssChanges");s.setBufferTime(50),this._resetUsedSkinNameArray(),this.StyleClass=W.Classes.get("core.managers.style.StyleProperties"),this._isStyleRendered={},this._groupId=e.get("id")+"-"+n.getNewGroupId(),this._topLevelStyle=n,this._styleDataItem=e,this._styleRawData=t,t.properties=t.properties||{},t.propertiesSource=t.propertiesSource||{},t.groups=t.groups||{},this._resetData(t.properties,t.propertiesSource,t.groups),this._changes={},this.createStylesAndRawData(t,i),this.resource.getResourceValue("W.Theme",function(t){t.getDataItem().addEvent(Constants.DataEvents.DATA_CHANGED,this._onThemePropertiesChange)}.bind(this))},_resetData:function(t,e,i){this._properties=t||{},this._propertiesSource=e||{},this._groups=i||{},this._propertiesTypes={},this._propertiesCounter={},this._propertiesLangKey={},this._groupsStyleObjects={}},_onThemePropertiesChange:function(t,e){for(var i in e)for(var n in this._properties)this._propertiesSource[n]==Constants.STYLE.SOURCE.THEME&&this._properties[n]==i&&this._firePropertyChangesEvent(n)},_firePropertyChangesEvent:function(t){this._changes[t]=this._propertiesTypes[t],this.injects().Utils.clearCallLater(this._dispatchEventId),this._dispatchEventId=this.injects().Utils.callLater(this._dispatchChangeEventAndResetChanges,[],this,50)},_dispatchChangeEventAndResetChanges:function(){this.fireEvent(Constants.StyleEvents.PROPERTY_CHANGED,{style:this,properties:this._changes}),this._changes={}},isStyleRenderedForSkin:function(t){return this._isStyleRendered[t]||!1},isStyleRenderedForAllSkins:function(){for(var t in this._isStyleRendered)if(!this._isStyleRendered[t])return!1;return!0},setStyleRenderFlag:function(t){for(var e in this._isStyleRendered)this.setStyleRenderFlagForSkin(e,t)},setStyleRenderFlagForSkin:function(t,e){this._isStyleRendered[t]=e},invalidateStyle:function(){this.setStyleRenderFlag(!1);for(var t in this._groupsStyleObjects)this._groupsStyleObjects[t].invalidateStyle()},get:function(t){return this._properties[t]},getStyleByGroupName:function(t){return this._groupsStyleObjects[t]},set:function(t,e){var i={},n={};i[t]=e,n[t]=this._properties[t],this._properties[t]=e,this._styleDataItem.fireDataChangeEvent(t,i,n),this._firePropertyChangesEvent(t)},changePropertySource:function(t,e,i){this._isPropertySourceValid(i)?(this._propertiesSource[t]=i,this.set(t,e)):LOG.reportError(wixErrors.STYLE_PROP_SRC_UNKNOWN,"StyleProperties","changePropertySource",i)()},_isPropertySourceValid:function(t){var e=!1;for(var i in Constants.STYLE.SOURCE)Constants.STYLE.SOURCE[i]===t&&(e=!0);return e},getPropertyExtraParamValue:function(t,e){var i=this.getPropertyType(t),n=this._getExtraParamDefinitionByType(i,e);if(!n)return LOG.reportError("STYLE_EXTRA_PARAM_DEFINITION_MISSING","StyleProperties","setPropertyExtraParamValue",i+"-"+e)(),void 0;var s=this._getPropertyExtraParamId(t,n.prefix);return this._convertStringToType(this._properties[s],n.type)},setPropertyExtraParamValue:function(t,e,i,n){var s=this.getPropertyType(t),a=this._getExtraParamDefinitionByType(s,e);if(!a)return LOG.reportError("STYLE_EXTRA_PARAM_DEFINITION_MISSING","StyleProperties","setPropertyExtraParamValue",s+"-"+e)(),void 0;var r=this._getPropertyExtraParamId(t,a.prefix);this._properties[r]=i+"";var o={},h={};o[r]=this._properties[r],this._styleDataItem.fireDataChangeEvent(t,o,h),n&&this._firePropertyChangesEvent(t,o,h)},_convertStringToType:function(t,e){switch(e){case"number":t=Number(t);break;case"boolean":t="true"===(t+"").toLowerCase()}return t},_getExtraParamDefinitionByType:function(t,e){return this.PROPERTY_TYPE_EXTRA_PARAMS[t]&&this.PROPERTY_TYPE_EXTRA_PARAMS[t][e]},_getPropertyExtraParamId:function(t,e){return e+"-"+t},isPropertyAvailable:function(t){return this._propertiesTypes.hasOwnProperty(t)},createStylesAndRawData:function(t,e){this._topLevelStyle.unprocessedSkins.add(e),W.Skins.getSkin(e,function(i){this._addUsedSkinName(e);var n=new i;this._saveSkinParamsAsProperties(n.getParams()),this._parseSkinInnerComponents(t,n.getCompPartsDefinition()),this._topLevelStyle.unprocessedSkins.remove(e)}.bind(this))},_saveSkinParamsAsProperties:function(t){for(var e=0;t.length>e;e++)this._addProperty(t[e])},_addProperty:function(t){var e=t.id,i=this._getParamData(t);"unknown"==i.source||i.ignore||(this._properties[e]=this._properties[e]||t.defaultTheme||t.defaultValue,this._propertiesTypes[e]=i.type,this._propertiesSource[e]=this._propertiesSource[e]||i.source,this._propertiesLangKey[e]=i.langKey,this._increasePropertyUseCount(e),this._setPropertyExtraParams(e,i))},_parseSkinInnerComponents:function(t,e){for(var i in e){var n=e[i].skin,s=e[i].styleGroup;if(s&&"undefined"!=s.toLowerCase())if("inherit"==s)this.createStylesAndRawData(t,n);
else{t.groups[s]||(t.groups[s]={properties:{},groups:{}});var a=t.groups[s];if(this._groupsStyleObjects[s])this._groupsStyleObjects[s].createStylesAndRawData(a,n);else{var r=new this.StyleClass(a,this._styleDataItem,n,this._topLevelStyle);this._groupsStyleObjects[s]=r}}}},_getParamData:function(t){var e={source:"unknown"};t.defaultTheme?(e.source=Constants.STYLE.SOURCE.THEME,e.value=t.defaultTheme,e.type=W.Theme.getPropertyType(t.defaultTheme)):t.defaultValue&&(e.source=Constants.STYLE.SOURCE.VALUE,e.value=t.defaultValue,e.type=this._getGeneralTypeFromCssType(t.type)),e.langKey=t.lang||t.id,e.styleDefaults=t.styleDefaults||{};var i=t.noshow===!0,n=t.enableEdit===!0,s=this.STYLE_PROPERTIES_FILTER[e.type],a=s&&s.contains(e.source);return e.ignore=i===!0||a!==!0,e.ignore=n?!1:e.ignore,e},_increasePropertyUseCount:function(t){this._propertiesCounter[t]?this._propertiesCounter[t]+=1:this._propertiesCounter[t]=1},_garbageCollection:function(){for(var t in this._properties)this._propertiesCounter[t]||delete this._properties[t];this.setStyleRenderFlag(!1);for(var e in this._groupsStyleObjects)this._groupsStyleObjects[e]._garbageCollection()},_getGeneralTypeFromCssType:function(t){return Constants.SkinParamCssTypesToGeneralTypesMap[t]||"unknown"},_setPropertyExtraParams:function(t,e){var i=e.type,n=this.PROPERTY_TYPE_EXTRA_PARAMS[i];if(n){var s=e.styleDefaults;for(var a in n){var r=n[a],o=this._getPropertyExtraParamId(t,r.prefix);this._properties[o]=this._properties[o]||s[r.prefix]||r.defaultValue,this._propertiesTypes[o]=i+"-"+a,this._increasePropertyUseCount(o)}}},getId:function(){return this._groupId},getProperties:function(){return this._properties},getGroups:function(){return this._groupsStyleObjects},getPropertyType:function(t){return this._propertiesTypes[t]},getPropertySource:function(t){return this._propertiesSource[t]},getPropertyLangKey:function(t){return this._propertiesLangKey[t]},_addUsedSkinName:function(t){this._usedSkinNamesArray.push(t)},_resetUsedSkinNameArray:function(){this._usedSkinNamesArray=[]},getSkinArray:function(){return this._usedSkinNamesArray}})}),define.Const("SKIN_PARAM",{SOURCE:{THEME:"theme",VALUE:"value"}}),define.Const("STYLE",{SOURCE:{THEME:"theme",VALUE:"value"}}),define.Const("StyleEvents",{SKIN_CHANGED:"skinChange",READY:"styleReady",PROPERTY_CHANGED:"propertyChange"}),define.experimentPlugin("ExperimentDataThemeItemPlugin",function(t){function e(t,e){var i=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),n=e(i),s=i._mergeField_(t,n);return s}function i(t,e){define.dataThemeItem(t,e())}var n=t;n.init("dataThemeItem","newDataThemeItem",e,i)}),define.Class("core.managers.theme.ThemeManager",function(t){var e=t;e.inherits("core.managers.data.DataManager"),e.utilize(["core.managers.style.SkinParamMapper","bootstrap.utils.Queue","core.utils.css.BorderRadius","core.utils.css.Color","core.utils.css.Size","core.utils.css.Font","core.utils.css.BoxShadow","core.utils.css.Background"]),e.binds(["_onDataChanged","_onDataReady","_onPropChange","_updateEffectedProps"]),e.statics({INIT_STYLE_RAW_DATA:{type:"TopLevelStyle",skin:"skin-name-place-holder",style:{properties:{},groups:{}}},TEXT_STYLE_SHEET:""}),e.fields({DEFINE_NAMESPACE:"dataThemeItem"}),e.methods({initialize:function(){this.parent(),this.SkinParamMapperClass=this.imports.SkinParamMapper,this._placeHoldersMap={},this._isReady=!0,this._isDataReady=!1,this._styleQueue=new this.imports.Queue,this._styleCache={},this._stylesInProcess={},this._isOperating=!1,this.getDataByQuery("#THEME_DATA",this._onDataReady)},getStyle:function(t,e,i){if(this._styleCache[t])e(this._styleCache[t]);else{if(this._styleQueue.add(t,e),this._styleQueue.getQueue(t).length>1)return;var n=function(e){this._styleCache[t]=e,this._styleQueue.getQueue(t).forEach(function(t){t(e)}),this._styleQueue.removeKey(t)}.bind(this);this.isStyleAvailable(t)?this.getDataByQuery("#"+t,function(t){t.get("style"),W.Skins.getSkin(t.get("skin"),function(e){var i=new this.SkinParamMapperClass(t,t.get("style"),e);n(i)}.bind(this))}.bind(this)):this.createStyle(t,"",i,n)}},isStyleAvailable:function(t){return this.isDataAvailable("#"+t)},invalidateStyle:function(t){this._styleCache[t]&&this._styleCache[t].invalidateStyle()},createStyle:function(t,e,i,n){this._styleCache[t]&&LOG.reportError(wixErrors.STYLE_ALREADY_EXISTS,"ThemeManager","createStyle",t)();var s=Object.clone(this.INIT_STYLE_RAW_DATA);s.skin=i;var a=this.addDataItem(t,s);W.Skins.getSkin(a.get("skin"),function(t){var e=new this.SkinParamMapperClass(a,a.get("style"),t),i=e.getId();this._styleCache[i]=e,n(e)}.bind(this))},createStyleFromData:function(t,e,i){var n=i||t.skin,s=Object.clone(t),a=e?e+"_":"",r=a+Date.now().toString(36),o=this.addDataItem(r,s),h=new this.SkinParamMapperClass(o,o.get("style"),n);return this._styleCache[o.get("id")]=h,h},cloneStyle:function(t,e){var i=t.getDataItem(),n=t.getSkinClass(),s=i.getData(),a=this.createStyleFromData(s,e,n);return a},getPropertyType:function(t){return this._data.getFieldSchema(t).type},_onDataReady:function(t){var e="Theme"===t.get("type");if(e){var i=t;t=this.addDataItem(i.get("id"),{type:this._getThemeSchemaTypeName()});var n=i.get("properties");for(var s in n)t.set(s,n[s].value)}this._setData(t),this._isDataReady=!0,this.fireEvent("dataReady")},isDataReady:function(){return this._isDataReady},_getThemeSchemaTypeName:function(){return"WFlatTheme"},_setData:function(t){this._flattenData(t),this._data&&this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChanged),this._data=t,this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChanged),this._indexAllPlaceholders()},_flattenData:function(t){this._flattenedDataItems={};var e,i,n,s=t.getData(),a=t.getSchema(),r={};for(n in s)if("array"==typeOf(s[n])){e=n;var o=s[n],h=o.length,l=a[n].defaultItems;if(l.length>h)for(var c=h;l.length>c;c++)o.push(l[c]),h++;for(i=0;h>i;i++)r[e+"_"+i]=o[i],this._flattenedDataItems[e+"_"+i]=e}else r[n]=s[n];t.setData(r);var d={};for(n in a)if("array"==a[n].type){e=n;var u=a[n].itemType,_=a[n].defaultItems;for(i=0;_.length>i;i++)d[e+"_"+i]={type:u,"default":_[i]},this._flattenedDataItems[e+"_"+i]||(this._flattenedDataItems[e+"_"+i]=e)}else d[n]=a[n];t.setSchema(d)},_indexAllPlaceholders:function(){this._placeHoldersMap={};var t=this._data.getSchema();for(var e in t)this._updatePlaceholdersInProperty(e,this.getRawProperty(e))},_updatePlaceholdersInProperty:function(t,e,i){var n=this._getPlaceholders(e,!0),s=i?this._getPlaceholders(i,!0):{},a=Object.merge({},s,n);for(var r in a)this._placeHoldersMap[r]=this._placeHoldersMap[r]||{},n[r]&&!s[r]?this._placeHoldersMap[r][t]=t:n[r]||delete this._placeHoldersMap[r][t]},_getPlaceholders:function(t,e){for(var i=/\[([^}]+)\]/g,n=/\{([^}]+)\}|\[([^}]+)\]/g,s=e?n:i,a={},r=s.exec(t);r;){var o=r[1]||r[2];o&&(a[o]=o),r=s.exec(t)}return a},clone:function(t){var e=this.parent(t);return e},isReady:function(){return this._isReady},getProperties:function(){var t={},e=this._data.getSchema();for(var i in e)t[i]={value:this.getRawProperty(i),type:this._data.getFieldSchema(i).type};return t},getProperty:function(t,e,i){var n=this._data.get(t),s="string"===typeOf(n)?n:n.clone?n.clone():Object.clone(n),a=this._data.getFieldSchema(t);if(!a)return LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"ThemeManager","getProperty",[t,this._data.getData(),null]),null;var r=this.getPropertyType(t);if(!e&&"string"==typeOf(s)&&-1!=s.indexOf("["))for(var o in this._data.getSchema())-1!=s.indexOf("["+o+"]")&&(s=s.split("["+o+"]").join(this.getProperty(o)));if(i)return s;switch(r){case"themeUrl":return W.Config.getImagesUrl()+"/web/";case"color":return new this.imports.Color(s);case"background":return new this.imports.Background(s,this);case"font":return new this.imports.Font(s,this);case"radius":return new this.imports.BorderRadius(s);case"webThemeUrl":return W.Config.getServiceTopologyProperty("staticThemeUrlWeb")+"/"+s+"/"}return s},_onDataChanged:function(t,e){if(!this._isOperating){if(this._isOperating=!0,this._indexAllPlaceholders(),"string"==typeof e)this._updateEffectedProps(e);else for(var i in e)this._updateEffectedProps(i);this._isOperating=!1}},getRawProperty:function(t){return this.getProperty(t,!0,!0)},clearOverrides:function(){this._data.reset()},getOverrides:function(){return this.getProperties()},getDataItem:function(){return this._data},setProperty:function(t,e){var i=this._data.getFieldSchema(t);if(!i)return LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"ThemeManager","setProperty",[t,this._data.getData(),null]),void 0;var n=i.type;"color"==n&&e&&e.getRgba&&(e=e.getRgba()),this._updatePlaceholdersInProperty(t,e,this.getRawProperty(t)),this._data.set(t,e),this._updateEffectedProps(t)},getPropertiesAccordingToType:function(t){var e=[],i=this._data.getSchema();for(var n in i)t==this._data.getFieldSchema(n).type&&e.push(n);return e},_onPropChange:function(t,e){var i=[t];e=e||this.getProperty(t),this.fireEvent("propertyChange",{name:t,newVal:e,type:"propertyChange"});var n=this._placeHoldersMap[t];for(var s in n)i.combine(this._onPropChange(s,this.getProperty(s)));return i},_updateEffectedProps:function(t){var e=this._onPropChange(t),i={};e.forEach(function(t){i[t]=this._data.get(t)}.bind(this)),this._data.fireDataChangeEvent(i)},getDirtyDataObjectsMap:function(){var t=this.parent();if(t&&t.THEME_DATA){t.THEME_DATA=this.createDataItem(Object.clone(t.THEME_DATA.getData()),this._getThemeSchemaTypeName());var e=t.THEME_DATA.getData();for(var i in e)if(this._flattenedDataItems&&this._flattenedDataItems[i]){var n=this._flattenedDataItems[i];e[n]||(e[n]=[]),e[n].push(e[i]),delete e[i]}}return t}})}),define.Const("Theme",{COLOR_PALETTE_INDEX:11,COLOR_SUB_PALETTE_SIZE:5}),define.Class("core.managers.viewmanager.ViewManagerBase",function(t){var e=t;e.inherits("bootstrap.managers.BaseManager"),e.binds(["_onTransitionFinished","_onEditModeChanged","_onHashChange"]),e.methods({initialize:function(){this._isReady=!0,this._isSiteReady=!1,this._pages=null,this._pagesData=null,this._mainPageData=null,this._siteStructureData=null,this._currentPageId=null,this._isFullScreen=null,this._fullScreenCallbacks=[],this._scrollLock=!1,this._isPageScrollToTopEnabled=!0,this._stopAnimation=null,this._loadedExtJS={},this._pendingExtJS=[],this._onSiteReady=this._onSiteReady.bind(this),this._loadNextPage=this._loadNextPage.bind(this),this._loadScript=this._loadScript.bind(this),this._onScriptLoaded=this._onScriptLoaded.bind(this);var t=W.Utils.getQueryParam("isEdited");"true"==t&&this.setPreviewMode(!0),this.addEvent("pageTransitionEnded",this._onTransitionFinished)},setPreviewMode:function(t){this._isPreview=t,t&&document&&document.body&&$(document.body).addClass("prevMode")},setStopAnimation:function(t){this._stopAnimation=t},getNewUniquePageId:function(t){var e;do e=W.Utils.getUniqueId(t+"Page");while(void 0!==this._pages[e]);return e},isScrollLock:function(){return this._scrollLock},setLinkTipFunc:function(t){this._linkTipFunc=t},getLinkTipFunc:function(){return this._linkTipFunc},getPreviewMode:function(){return!!this._isPreview},setSite:function(t,e,i){t||LOG.reportError(wixErrors.VM_INVALID_SITE_NODE,this.className,"setSite",""),e||LOG.reportError(wixErrors.VM_INVALID_SITE_DATA,this.className,"setSite",""),this._siteNode=t,this._siteStructureData=e,this.indexPages("#SITE_PAGES"),this._siteNode.addEvent(Constants.ComponentEvents.WIXIFIED,function(){e.addComponentWithInterest(this.getLogic())}),this._isInViewer()?this._wixifySiteLazily(t,i):this._wixifyEntireSite(t);var n=this._siteNode.getProperty("comp");n&&n.contains("components.SiteStructure")&&this._siteNode.wixify()},_isInViewer:function(){return"editor"!==this.getViewMode()},_getUrlSearchParameters:function(){return window.location.search},_wixifyEntireSite:function(t){var e=t.getElements("[comp]");if(window.adData){this.setAdData(window.adData);var i=document.getElementById("wixFooter");i&&e.push(i)}t.get("comp")&&e.push(t),new Async.Bulk(e,null,{timeout:2e4,completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){e.removeClass("initHidden"),this.updatePagesData();for(var t in this._pages){var i=this._pages[t].getLogic();i.setAsWixified()}this._onSiteReady()}.bind(this)}),e.wixify()},_getAllComponents:function(t,e){var i=t.getElements("[comp]");return t.get("comp")&&i.push(t),i.filter(e)},_notChildOfSelector:function(t,e){return null==t.getParent(e)},_notInPage:function(t){return this._notChildOfSelector(t,"[comp=mobile.core.components.Page],[comp=core.components.Page],[comp=wixapps.integration.components.AppPage]")},_getInitComponents:function(t){return this._getAllComponents(t,function(t){return this._notInPage(t)}.bind(this))},_wixifySiteLazily:function(t,e){var i=this._getInitComponents(t);if(window.adData){this.setAdData(window.adData);var n=document.getElementById("wixFooter");n&&i.push(n)}new Async.Bulk(i,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){i.removeClass("initHidden"),this.updatePagesData();var t=[];if(e===!1)for(var n in this._pages)t.push(this._pages[n].getLogic());else{var s=this._getPageDataFromHash(W.Utils.hash.getHash());t.push(this._pages[s.get("id")].getLogic())}new Async.Bulk(t,null,{completeEvent:"contentWixified",completeCallback:function(){this._onSiteReady()}.bind(this)});for(var a=0;t.length>a;++a)t[a].wixifyContent()}.bind(this)}),i.wixify()},_onSiteReady:function(){this.setPreviewMode(this._isPreview),this._isReady=!0,this._isSiteReady=!0,window.scrollTo(0,1),W.Utils.hash.addEvent("change",this._onHashChange),W.Utils.hash.fireHashChangeEvent(),this._loadNextPage(),this._reportBIEvents(),this.fireEvent("SiteReady"),"editor"==window.viewMode&&"#save=1"==window.location.hash&&(window.location.hash="",W.Commands.executeCommand("WEditorCommands.SaveSuccessDialog"))},_reportBIEvents:function(){switch(window.viewMode){case"preview":LOG.reportEvent(wixEvents.PREVIEW_READY);break;case"site":LOG.reportEvent(wixEvents.SITE_READY)}},getViewMode:function(){return window.viewMode},_loadNextPage:function(){},createElement:function(t,e){return new Element(t,e)},clone:function(t){return this.parent(t)},isReady:function(){return this._isReady},isSiteReady:function(){return this._isSiteReady},_onHashChange:function(t){if(t=t||{},this.isSiteReady()){var e=t.newHash,i=t.isIdChanged;W.Data.isDataAvailable("#"+e)?(W.Data.getDataByQuery("#"+e,function(t){this._setDataObjectFromHash(t,e,i)}.bind(this)),t.isForSureAfterChange&&LOG.reportPageEvent(window.location.href)):this._changePageFromHash(e)}},_setDataObjectFromHash:function(t,e,i){i&&t.getType&&"Page"===t.getType()&&e&&this._changePageFromHash(e)},_changePageFromHash:function(t){var e=this._getPageDataFromHash(t);if(null!==e){var i=e.get("id");i!=this._currentPageId&&i&&this._pageTransition(i)}},_getPageDataFromHash:function(t){t=t||W.Utils.hash.getHash();var e=this._mainPageData;for(var i in this._pagesData){var n=this._pagesData[i],s=n.getMeta("isHidden")&&!this._isPreview;if(n.get("id")==t&&!s){e=n;break}}return e},_pageTransition:function(t){var e=this.getCurrentPageNode(),i=this._siteNode.getElement("#"+t);if(i){if(W.Utils.clearCallLater(this._setVisiblePageCallId),this._currentPageId=t,this._isFullScreen&&this.exitFullScreenMode(),e)e.getLogic().collapse();else for(var n in this._pages){var s=this._pages[n];s!=i&&s.getLogic().collapse()}i.getLogic().uncollapse(),this._setVisiblePageCallId=W.Utils.callLater(function(){i.getLogic().wixifyContent(function(){W.Editor&&W.Editor.setKeysEnabled(!0),this.fireEvent("pageTransitionEnded"),W.Utils.callLater(function(){})}.bind(this))}.bind(this)),W.Editor&&W.Editor.setKeysEnabled(!1),this.fireEvent("pageTransitionStarted")}},getScrollTop:function(){return document.body.scrollTop},getPagesData:function(){return this._pagesData},_scrollToTopOnPageChange:function(){this._isPageScrollToTopEnabled&&(this._isPreview?(this._siteNode.setStyle("top","0px"),$(document.body).setStyle("background-position","0px 0px")):$(document.body).scrollTo(0,0))},goToPage:function(t){if(!this._scrollLock){null!==this._stopAnimation&&this._stopAnimation.stop(),this._scrollToTopOnPageChange();var e=this._pagesData[t];e&&this._currentPageId!=t&&(("preview"===window.viewMode||"editor"===window.viewMode)&&LOG.reportEvent(wixEvents.USER_REQUESTED_PAGE_MOVE,{c1:e._data&&e._data.pageUriSEO||"no-page-url"}),this._pageTransition(t))}},_onTransitionFinished:function(){this._setUrlHashToPage(this._currentPageId)},_setUrlHashToPage:function(t){var e=this._pagesData[t];e&&W.Utils.hash.setHash(t,e.get("pageUriSEO"))},goToHomePage:function(){this.goToPage(this.getHomePageId())},isHomePage:function(t){return t=t||this._currentPageId,this._isSiteReady?t==this.getHomePageId():!0},getHomePageId:function(){return this._isSiteReady&&this._mainPageData?this._mainPageData.get("id"):void 0},getCurrentPageId:function(){return this._currentPageId},getCurrentPageNode:function(){var t=null;return this._currentPageId&&this._siteNode&&(t=this._siteNode.getElement("#"+this._currentPageId)),t},indexPages:function(t){var e=this._siteNode.getElement(t);if(!e)return W.Utils.callLater(this.indexPages,[t],this,10);var i={},n=[],s="[comp=mobile.core.components.Page],[comp=core.components.Page]";e.getElements(s).each(function(t){var e=t.get("id")||W.Utils.getUniqueId("page");i[e]=t,t.addClass("sitePage");var s=t.get("dataQuery");s!=this._siteStructureData.get("mainPage")&&n.push(s)}.bind(this));var a=this._siteStructureData.getData().pages;a||(a=[]);for(var r=0;a.length>r;++r){var o=a[r],h=n.indexOf(o);-1!=h&&(n.splice(h,1),n.splice(r,0,o))}var l=W.Data.isDataChange();this._siteStructureData.set("pages",n),l&&W.Data.flagDataChange(),this._pages=i},loadExternalScript:function(t,e,i){return t in this._loadedExtJS?(e(),"ALREADY_LOADED"):t in this._pendingExtJS?(this._pendingExtJS[t].push(e),"PENDING_LOAD"):(this._pendingExtJS[t]=[e],this._loadScript(t,i),"FIRST_LOAD")},_loadScript:function(t){var e=document.createElement("script");e.type="text/javascript",e.async=!1,e.readyState?e.onreadystatechange=function(){("loaded"===e.readyState||"complete"===e.readyState)&&(e.onreadystatechange=null,this._onScriptLoaded(t))}.bind(this):e.onload=function(){this._onScriptLoaded(t)}.bind(this),e.src=t;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)},_onScriptLoaded:function(t){this._loadedExtJS[t]=!0;for(var e=this._pendingExtJS[t],i=0;e.length>i;i++)e[i]();delete this._pendingExtJS[t]},_getSiteViewMode:function(){var t=window.viewMode;return"preview"==t&&window.top===window?"site":t},isPublicMode:function(){return"site"==this._getSiteViewMode()},updatePagesData:function(){this._pagesData={};for(var t in this._pages){var e=this._pages[t].getLogic().getDataItem();this._pagesData[e.get("id")]=e,this._siteStructureData.get("mainPage")=="#"+e.get("id")&&(this._mainPageData=e)}},getSiteNode:function(){return this._siteNode},_onEditModeChanged:function(t){this._editorMode=t},getEditorMode:function(){return this._editorMode}})}),define.Const("ViewEvents",{ORIENTATION_CHANGE:"orientationchange"}),define.Const("ViewManager",{VIEW_MODE_SITE:"site",VIEW_MODE_EDITOR:"editor",VIEW_MODE_PREVIEW:"preview"}),define.component("core.components.BaseList",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.binds(["_onItemReady","_onDataItemsReady","_onChildAutoSized","_onChildAutoSizedAnimation"]),e.methods({initialize:function(t,e,i){this.parent(t,e,i),this._itemClassName=i&&i.itemClassName||this._itemClassName,this._itemsNodes=[]},_renderItems:function(t,e){t=t||[],0===t.length?(this.getItemsContainer().empty(),this._onAllItemsReady()):e?this._onDataItemsReady(null,t):this._data.getDataManager().getDataByQueryList(t,function(e){this._onDataItemsReady(t,e)}.bind(this))},_createHiddenItems:function(){return!0},_createItem:function(t,e,i,n){var s=this._skin.itemSkinClassName,a=this.getItemClassName();if(!s)return LOG.reportError(wixErrors.NO_SKIN,"BaseList","_createItem",{c1:this.className}),new Element("b");if(!a)return LOG.reportError(wixErrors.MISSING_METHOD,this.className,"_createItem",""),new Element("b");var r=W.Utils.getUniqueId(Constants.components.BASE_LIST_ITEM_PREFIX),o=new Element("div",{id:r});return this._getParamsToPassToItem(t,function(i){var r=t;this.injects().Data.isDataItem(t)||(r=null),this.injects().Components.createComponent(a,s,r,i,function(){e(o,!0,t,n)},void 0,void 0,o)}.bind(this)),o},getSkinElementByIndex:function(t){var e=this.getItemsContainer().getChildren();return e[t]},_getParamsToPassToItem:function(t,e){e(void 0)},_onItemReady:function(){},_onAllItemsReady:function(){},getItemClassName:function(){return this._itemClassName},getItemsContainer:function(){return this._view},_onChildAutoSizedAnimation:function(){this.fireEvent("autoSizedAnimation")},_onChildAutoSized:function(){this.fireEvent("autoSized")},_onDataItemsReady:function(t,e){var i=this._itemsNodes||[];this._itemsNodes=[],this.getItemsContainer().empty();var n,s,a,r=[],o=0,h=function(t,e,i,n){if(t){var s=t.getLogic();this.fireEvent("itemReady",[s,s.getDataItem(),e]),s.addEvent("autoSizedAnimation",this._onChildAutoSizedAnimation),s.addEvent("autoSized",this._onChildAutoSized),this._onItemReady(s,e,i)}if(++o>=n){var a=this._itemsNodes.clean();a.length>1&&(a[0].addClass("firstItem"),a[a.length-1].addClass("lastItem")),this._itemsNodes=a,this._onAllItemsReady()}}.bind(this),l=this.getItemsContainer(),c=function(t,e,n){if(!this._createHiddenItems()&&t.getMeta("isHidden"))return h(null,!1,t,n),void 0;var s=void 0;this.injects().Data;for(var a=0;i.length>a;++a){var r=i[a];if(r&&r.getLogic&&t===r.getLogic().getDataItem()){s=r,i.splice(a,1);break}}s?h(s,!1,t,n):s=this._createItem(t,h,e,n),this._itemsNodes[e]=s,s.removeClass("firstItem").removeClass("lastItem"),s.insertInto(l)}.bind(this);if(t)for(s=0,n=t.length;n>s;++s)a=e[t[s]],c(a,s,n);else for(s=0,n=e.length;n>s;++s)a=e[s],c(a,s,n);r.length>1&&(r[0].addClass("firstItem"),r[r.length-1].addClass("lastItem"))},_disposeItems:function(t){if(t)for(var e=t.length-1;e>=0;--e){var i=t[e],n=i.getLogic&&i.getLogic();n&&(this._disposeItem(n),n.dispose())}},_disposeItem:function(){}})}),define.component("core.components.BaseRepeater",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.statics({repeaterStates:{INITIATE:"init",LOADING:"loading",READY:"ready"}}),e.fields({_elementPool:[],_usedElementPool:[],_stillLoading:!1}),e.methods({_onDataChange:function(){this._allRepeatersReady=!1,this.parent()},_setSkinPartElements:function(t){this._allRepeatersReady=!1,this.parent(t)},_prepareForRender:function(){return this._data&&0!==this._data.length?(this._allRepeatersReady===!1&&(this._repeaterDefinitions=this._getRepeaterDefinitions(),this._startRepeaterCreations()),this._allRepeatersReady):!0},_getRepeaterDefinitions:function(){var t=[];for(var e in this._skinPartsSchema)if(this._skinPartsSchema[e].repeater&&this._skinPartsSchema[e].autoCreate!==!1){var i=this.getSkinPartDefinition(e);i.hookMethod&&"function"==typeOf(this[i.hookMethod])&&(i=this[i.hookMethod](i)),t.push(i)}return t},_startRepeaterCreations:function(){if(!this._stillLoading){this._usedElementPool=[],this._beforeRepeatersCreation(),this._repeatersDataOld=this._repeatersData,this._repeatersData={},this._stillLoading=!0;for(var t=0;this._repeaterDefinitions.length>t;++t){var e=this._repeaterDefinitions[t],i={};this._repeatersData[e.id]=i,i.definition=e,i.pendingItems=[],i.readyItems=[],i.readyItemsLogic=[],i.state=this.repeaterStates.INITIATE,this._loadRepeater(i)}this._checkIfRepeatersReady()}},_checkIfRepeatersReady:function(){for(var t in this._repeatersData){var e=this._repeatersData[t];if(e.state!=this.repeaterStates.READY)return!1}return!0},_loadRepeater:function(t){if(t.definition.autoCreate!==!1){var e=function(e,i){this._onLoadRepeaterReady(e,i,t)}.bind(this),i=this._getRepeaterContainer(t);i&&i.empty();var n,s=this._getRepeaterDataList(t.definition);if(s=this._processDataRefs(s),t.itemsAmount=s.length,s.length>0)for(var a=0;s.length>a;++a)n=Object.clone(t.definition),n.dataQuery=this._getDataQueryField(t.definition,s[a]),this._createRepeaterItem(n,t,i,e);else this._disposeOldRepeaters(),this._onRepeaterReady(t),this._stillLoading=!1,this._allRepeatersReady=!0,this._renderIfReady()}else t.state=this.repeaterStates.READY},_getDataQueryField:function(t,e){return t.repeaterDataQueryField?e.get(t.repeaterDataQueryField):e},_onLoadRepeaterReady:function(t,e,i){var n=!e,s=t.getViewNode(),a=i.pendingItems.indexOf(s),r=t.getDataItem();i.pendingItems.splice(a,1),i.readyItems.push(s),i.readyItemsLogic.push(t),i.definition.hideHidden&&r.getMeta("isHidden")&&s.collapse(),this._onRepeaterItemReady(i,t,r,n),i.readyItems.length==i.itemsAmount&&(i.state=this.repeaterStates.READY,this._checkIfRepeatersReady()&&(this._disposeOldRepeaters(),this._onRepeaterReady(i),this._stillLoading=!1,this._allRepeatersReady=!0,this._renderIfReady()))},_disposeOldRepeaters:function(){var t=[];this._elementPool.forEach(function(e){this._usedElementPool.contains(e)?t.push(e):e.getLogic().dispose()}.bind(this)),this._elementPool=t},_processDataRefs:function(t){return t},_createRepeaterItem:function(t,e,i,n){var s=this._getOldRepeaterItemMatchingDefinition(e.definition.id,t);if(s){i&&t.moveOldItemsToContainer!==!1&&s.insertInto(i),this._usedElementPool.push(s);var a,r,o=s.getLogic(),h=o.getSkin(),l=!1;if(t.styleGroup&&this._style&&(a="inherit"==t.styleGroup?this._style:this._style.getStyleByGroupName(t.styleGroup),r=h.getStyle(),l=a!==r),l){var c=function(){o.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,c),n(o,!0)};o.addEvent(Constants.ComponentEvents.READY_FOR_RENDER,c),h.applyStyle(a)}else n(o,!0)}else{var d=new Element("div");this._elementPool.push(d),this._usedElementPool.push(d),d.repeaterDefinition=t,e.pendingItems.push(d),i&&d.insertInto(i),this._createComponentbyDefinition(t,d,n)}},_getOldRepeaterItemMatchingDefinition:function(t,e){if(this._repeatersDataOld)for(var i=this._repeatersDataOld[t].readyItems,n=0;i.length>n;++n){var s=i[n].repeaterDefinition;if(s.skin==e.skin&&s.dataQuery===e.dataQuery)return i.splice(n,1)[0]}return null},_getRepeaterContainer:function(t){var e=t.definition.container;return e&&this._skinParts[e]?this._skinParts[e]:null},_getRepeaterDataList:function(t){if(t.dataRefList)return t.dataRefList;if(t.dataRefField){var e=[];return"*"==t.dataRefField||(e=this._data.get(t.dataRefField)),e}return t.inlineDataField?this._data.get(t.inlineDataField):void 0},dispose:function(){this._elementPool.forEach(function(t){t.getLogic().dispose()}),this._elementPool=[],this.parent()},_beforeRepeatersCreation:function(){},_onRepeaterItemReady:function(){},_onRepeaterReady:function(){}})}),define.component("core.components.Button",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.states(["up","over","selected","pressed"]),e.binds(["_onClick","_onOver","_onOut","_onMouseDown","_onMouseUp","render"]),e.dataTypes(["","Button"]),e.skinParts({icon:{type:"htmlElement",optional:"true"},label:{type:"htmlElement"}}),e.fields({_triggers:["click"],_canFocus:!0}),e.methods({initialize:function(t,e,i){this.parent(t,e,i),i=i||{},this.setParameters({label:i.label||e.getAttribute("label"),toggleMode:i.toggleMode||!1,disabled:i.disabled||!1,iconSrc:i.iconSrc||"",command:i.command||null,commandParameter:i.commandParameter||null})},_onDataChange:function(t){"Button"==t.getType()&&this.setParameters({label:t.get("label"),toggleMode:t.get("toggleMode"),disabled:t.get("disabled"),iconSrc:t.get("iconSrc"),command:t.get("command"),commandParameter:t.get("commandParameter")}),this.parent()},render:function(){this._setPreDefinedCommand(),this._skinParts.label.set("html",this._label||""),this._skinParts.icon&&(this._iconSrc?(this._skinParts.icon.setStyle("background","url("+this._iconSrc+") no-repeat 50% 50%"),this._skinParts.icon.uncollapse()):(this._skinParts.icon.setStyle("background",""),this._skinParts.icon.collapse()))},_setPreDefinedCommand:function(){this._tmpCommand&&this.setCommand(this._tmpCommand,this._tmpCommandParameter),this._tmpCommand=null,this._tmpCommandParameter=null},_onEnabled:function(){var t=this._skinParts.view;t.addEvent(Constants.CoreEvents.CLICK,this._onClick),t.addEvent(Constants.CoreEvents.MOUSE_OVER,this._onOver),t.addEvent(Constants.CoreEvents.MOUSE_OUT,this._onOut),t.addEvent(Constants.CoreEvents.MOUSE_DOWN,this._onMouseDown),t.addEvent(Constants.CoreEvents.MOUSE_UP,this._onMouseUp)},_onDisabled:function(){var t=this._skinParts.view;t.removeEvent(Constants.CoreEvents.CLICK,this._onClick),t.removeEvent(Constants.CoreEvents.MOUSE_OVER,this._onOver),t.removeEvent(Constants.CoreEvents.MOUSE_OUT,this._onOut),t.removeEvent(Constants.CoreEvents.MOUSE_DOWN,this._onMouseDown),t.removeEvent(Constants.CoreEvents.MOUSE_UP,this._onMouseUp)},setLabel:function(t){this._label=t,this._renderIfReady()},setIcon:function(t){this._iconSrc=t,this._renderIfReady()},setTextContent:function(t){this.setLabel(t)},setToggleMode:function(t){this._toggleMode=t},setDisabled:function(t){this._disabled=!!t,this._renderIfReady()},setParameters:function(t){t=t||{},this._label=t.label||this._label,this._toggleMode=t.toggleMode||this._toggleMode,this._disabled=t.disabled||this._disabled,this._iconSrc=t.iconSrc||this._iconSrc,this._tmpCommand=t.command||this._tmpCommand,this._tmpCommandParameter=t.commandParameter||this._tmpCommandParameter,this._renderIfReady()},getLabel:function(){return this._label},toggleSelected:function(t){var e=!1;t!==void 0?e=t:this.getState().contains("selected")||(e=!0),e?this.setState("selected"):this.removeState("selected")},_onClick:function(t){if(this.isEnabled()&&(this._command||(t=t||{},t.target=this.getViewNode(),this.fireEvent(Constants.CoreEvents.CLICK,t)),this._toggleMode)){var e=this.getState().contains("selected")?"over":"selected";this.setState(e)}},_onOver:function(t){this.isEnabled()&&!this.getState().contains("selected")&&(this.fireEvent("over",t),this.setState("over"))},_onOut:function(t){this.isEnabled()&&!this.getState().contains("selected")&&(this.fireEvent("up",t),this.setState("up"))},_onMouseDown:function(){this.isEnabled()&&!this.getState().contains("selected")&&this.setState("pressed")},_onMouseUp:function(){this.removeState("pressed")}})}),define.component("core.components.Container",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.skinParts({inlineContent:{type:"htmlElement"}}),e.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0}},Z_INDEX_CHANGE_TYPES:{BACK:"BACK",FORWARD:"FORWARD",TOP:"TOP",BOTTOM:"BOTTOM"},_allowDragChildren:!0}),e.methods({initialize:function(t,e,i){i&&null!=i.allowDragChildren&&(this._allowDragChildren=i.allowDragChildren),this.parent(t,e,i),this.setMaxH(8e3)},getInlineContentContainer:function(){return this._skinParts.inlineContent?this._skinParts.inlineContent:this._view},getChildren:function(){return this.getInlineContentContainer().getChildren()},addChild:function(t){var e=t.getParentComponent(),i=e.getChildComponents().map(function(t){return t.getLogic().getComponentId()});t.getViewNode().insertInto(this.getInlineContentContainer()),this._reportComponentsZOrderChanged(t,e,i),this.moveChild(t,this.Z_INDEX_CHANGE_TYPES.TOP)},moveChildFromIndexToIndex:function(t,e,i){var n=this.getChildComponents().map(function(t){return t.getLogic().getComponentId()});W.Utils.setChildIndex(this.getInlineContentContainer(),e,i),this._reportComponentsZOrderChanged(t,this,n)},_reportComponentsZOrderChanged:function(t,e,i){var n=e.getChildComponents().map(function(t){return t.getLogic().getComponentId()}),s={subType:"explicitZOrderChange",changedComponentIds:[t.getComponentId()],oldState:{children:i},newState:{children:n}};this.injects().Commands.executeCommand("WViewerCommands.ComponentZIndexChanged",{editedComponent:t,urmData:s})},removeChild:function(t){var e=t.getViewNode?t.getViewNode():t;this.getInlineContentContainer().removeChild(e)},canMoveForward:function(t){var e=this.getChildren(),i=e.indexOf(t.getViewNode());
return-1==i?!1:e.length-1>i},canMoveBack:function(t){var e=this.getChildren().indexOf(t.getViewNode());return-1==e?!1:e>0},moveChild:function(t,e){var i,n=this.getChildren(),s=this._getChildIndex(t);switch(e){case this.Z_INDEX_CHANGE_TYPES.BACK:i=s-1;break;case this.Z_INDEX_CHANGE_TYPES.FORWARD:i=s+1;break;case this.Z_INDEX_CHANGE_TYPES.BOTTOM:i=0;break;case this.Z_INDEX_CHANGE_TYPES.TOP:i=n.length-1}this.moveChildFromIndexToIndex(t,s,i)},_getChildIndex:function(t){var e=this.getChildren(),i=t.getViewNode();return e.indexOf(i)},hasChildren:function(){return!0},isContainer:function(){return this._allowDragChildren},getChildComponents:function(){return this.getInlineContentContainer().getChildren("[comp]")},getContainerComponents:function(t){for(var e=this.getChildComponents(),i=0;e.length>i;i++){var n=e[i].getLogic();t.push(n),n.isInstanceOfClass("core.components.Container")&&t.concat(n.getContainerComponents(t))}return t},getDescendantComponents:function(){return this.getDescendantComponentsRecurse(this,[])},getDescendantComponentsRecurse:function(t,e){for(var i=t.getChildComponents(),n=0;i.length>n;n++)e.push(i[n]),i[n].getLogic&&i[n].getLogic().getChildComponents&&this.getDescendantComponentsRecurse(i[n].getLogic(),e);return e},disposeChildren:function(){for(var t=this.getChildren(),e=0;t.length>e;e++)t[e].getLogic&&t[e].getLogic().dispose()},dispose:function(){this.disposeChildren(),this.parent()}})}),define.component("core.components.Image",function(t){var e=t;e.utilize(["core.components.image.ImageDimensions","core.components.image.ImageUrl"]),e.inherits("mobile.core.components.base.BaseComponent"),e.states(["loading","loaded"]),e.binds(["_onImageLoaded","_onOrientationChange"]),e.dataTypes(["Image",""]),e.statics({unitOptions:{EM:"em",PX:"px",PERCENT:"%"}}),e.skinParts({image:{type:"htmlElement"}}),e.fields({_renderTriggers:[Constants.DisplayEvents.DISPLAY_CHANGED],_invalidProps:{}}),e.methods({initialize:function(t,e,i){this._initGlobalResources(),this.parent(t,e,i),this.lockRefresh(),this._imageDimensions=new this.imports.ImageDimensions,this._imageUrl=new this.imports.ImageUrl,this._setParametersToDefaults(),this._initializeParametersFromArgs(i),this._requestExactSize=this._globals.viewer&&this._globals.viewer.getPreviewMode()!==!0,this._globals.viewer&&this._globals.viewer.addOrientationEvent(this._onOrientationChange)},_initGlobalResources:function(){this._globals={};var t=this.injects();this._globals.viewer=t.Viewer,this._globals.utils=t.Utils},_setParametersToDefaults:function(){this._sizeOfComponentInPx={x:0,y:0},this._units={x:this.unitOptions.PERCENT,y:this.unitOptions.PERCENT},this._sizeOfComponentInUnits={x:100,y:100},this._uri=""},_initializeParametersFromArgs:function(t){t=t||{},this.setCropMode(t.cropMode),this.setAlign(t.align,t.valign),this._passedUnit=this._isValueInObject(this.unitOptions,t.unit)?t.unit:null,this.setSize(t.width,t.height),this._renderDelay=t.renderDelay||1,this._useWebUrl=t.useWebUrl||!1},_onOrientationChange:function(){setTimeout(this.refresh.bind(this,!0),50)},render:function(){this.unLockRefresh(),0===this._renderDelay?this.refresh(!0):this._globals.utils.callLater(this.refresh,[!0],this,this._renderDelay)},_needsRender:function(){var t=this._data&&this._data.get("uri")&&this._uri!==this._data.get("uri"),e=this._getComponentSizeInPx();return t||this._sizeOfComponentInPx.x!=e.x||this._sizeOfComponentInPx.y!=e.y||this._isPropInvalid("size")||this._isPropInvalid("cropMode")},_onAllSkinPartsReady:function(){this._skinParts.image.setStyle("position","absolute"),this._skinParts.view.setStyles({position:"relative",overflow:"hidden"})},lockRefresh:function(){this._isLock=!0},unLockRefresh:function(){this._isLock=!1},refresh:function(t){(t||this._needsRender())&&(0===this._renderDelay?this._onRefresh(t):this._globals.utils.callLater(this._onRefresh,[t],this,this._renderDelay))},_onRefresh:function(t){if((!this._isLock||t)&&this._data){this._skinParts.image.set("alt",this._data.get("alt"));var e=this._getImageDimensionsAndSetCompSize(t),i=this._validateImageDimensions(e);if(i){var n={isSameImage:null,isSameImageWithBiggerPyramidSize:null},s=this._getImageFullUrl(e.imageRequestSize,n);this.fireEvent("loading",{url:s,imgWidth:e.imageObjectSize.x,imgHeight:e.imageObjectSize.y,requestSize:this._pyramidRequestSize,imgX:e.imagePosition.x,imgY:e.imagePosition.y}),this._skinParts.image.setStyles({width:e.imageObjectSize.x+"px",height:e.imageObjectSize.y+"px",top:e.imagePosition.y+"px",left:e.imagePosition.x+"px"}),s!=this._skinParts.image.get("src")?((!n.isSameImage||n.isSameImageWithBiggerPyramidSize)&&this.setState("loading"),this._skinParts.image.addEvent("load",this._onImageLoaded),this._skinParts.image.removeEvents("error"),this._skinParts.image.addEvent("error",this._onImageError.bind(this,s)),this._skinParts.image.set("src",s)):this._moveImageToBackground()}else this._globals.utils.callLater(this._renderIfReady,[],this,50);this._validate()}},_validateImageDimensions:function(t){if(!t||!t.imageRequestSize)return!1;var e=t.imageRequestSize,i=0===e.x||0===e.y;return i?this._isLastImageRequestZero=!0:(this._isLastImageRequestZero&&LOG.reportError(wixErrors.IMG_VALID_SIZE_AFTER_ZERO,this.$className,"_validateImageDimensions",this._data.get("uri")),this._isLastImageRequestZero=!1),!i},_getImageDimensionsAndSetCompSize:function(t){var e=null,i=parseInt(this._data.get("width"),10),n=parseInt(this._data.get("height"),10);if(i||n||(i=n=128),t||this._isPropInvalid("size")){var s=this._getComponentSizeInUnits();this._skinParts.view.setStyles({width:s.x,height:s.y})}return(t||this._isPropInvalid("size")||this._isPropInvalid("cropMode"))&&(this._sizeOfComponentInPx=this._getComponentSizeInPx(),e=this._imageDimensions.getDimensionsForContainerSize({x:i,y:n},this._sizeOfComponentInPx)),e},_getImageFullUrl:function(t,e){var i=this._uri;this._uri=this._data.get("uri"),e.isSameImage=i===this._uri;var n=this._uri,s=this._uri.test(/(^https?)|(^data)/);if(this._useWebUrl||s)n=n;else if(this._isGIF())n=this._imageUrl.getImageUrlExactSize(this._getOriginalSizeFromData(),this._uri);else if(this._requestExactSize)n=this._imageUrl.getImageUrlExactSize(t,this._uri);else{var a=this._imageUrl.getImageUrlFromPyramid(t,this._uri,e.isSameImage,this._pyramidRequestSize);n=a.url,e.isSameImageWithBiggerPyramidSize=e.isSameImage&&a.pyramidRequestSize>this._pyramidRequestSize,this._pyramidRequestSize=a.pyramidRequestSize}return n},_getOriginalSizeFromData:function(){return{x:this._data.get("width"),y:this._data.get("height")}},_isGIF:function(){return this._data.get("uri").test(/(\.gif$)/)},_onImageLoaded:function(){var t=window.Browser.ie7?7e3:1;this._globals.utils.callLater(this._validateResultImageSize,[],this,t),this.setState("loaded"),this._moveImageToBackground(),this._renderIfReady()},_validateResultImageSize:function(){this._renderIfReady()},_moveImageToBackground:function(){var t=this._skinParts.image;if(0!==this._sizeOfComponentInPx.x&&0!==this._sizeOfComponentInPx.y&&Modernizr.backgroundsize){var e=this._globals.utils.getCSSBrowserFeature("backgroundSize"),i={};i["background-image"]="url('"+t.get("src")+"')",i[e]=t.getStyle("width")+" "+t.getStyle("height"),i["background-position"]=parseInt(t.getStyle("left"),10)+"px "+parseInt(t.getStyle("top"),10)+"px",i["background-repeat"]="no-repeat",this._skinParts.view.setStyles(i),t.setStyles({visibility:"hidden"})}},_onImageError:function(t){LOG.reportError(wixErrors.IMAGE_LOAD_ERROR,"Image","refresh",t),this._renderIfReady()},_getComponentSizeInUnits:function(){return{x:this._sizeOfComponentInUnits.x+this._units.x,y:this._sizeOfComponentInUnits.y+this._units.y}},_getComponentSizeInPx:function(){return null!==this._skinParts?this._units.x!==this.unitOptions.PX||this._units.y!==this.unitOptions.PX?this._skinParts.view.getSize():{x:Number(this._sizeOfComponentInUnits.x),y:Number(this._sizeOfComponentInUnits.y)}:void 0},_invalidate:function(t){switch(typeOf(t)){case"string":this._invalidProps[t]="invalid";break;case"array":for(var e=0;t.length>e;++e)this._invalidProps[t[e]]="invalid"}},_validate:function(t){switch(typeOf(t)){case"string":delete this._invalidProps[t];break;case"array":for(var e=0;t.length>e;++e)delete this._invalidProps[t[e]];break;default:this._invalidProps={}}},_isPropInvalid:function(t){return Boolean(this._invalidProps[t])},setCropMode:function(t){this._imageDimensions.setCropMode(t)&&(this._invalidate("cropMode"),this._renderIfReady())},setAlign:function(t,e){var i=!1;this._imageDimensions.setHorizontalAlign(t)&&(i=!0),this._imageDimensions.setVerticalAlign(e)&&(i=!0),i&&(this._invalidate("align"),this._renderIfReady())},setSize:function(t,e,i){var n=!1;this._passedUnit=i||this._passedUnit,t&&(n=this._passedUnit&&this._passedUnit!==this._units.x||this._sizeOfComponentInUnits.x!==parseInt(t,10),this._units.x=this._passedUnit||this._units.x,this._sizeOfComponentInUnits.x=parseInt(t,10)),e&&(n=n||this._passedUnit&&this._passedUnit!==this._units.y||this._sizeOfComponentInUnits.y!==parseInt(e,10),this._units.y=this._passedUnit||this._units.y,this._sizeOfComponentInUnits.y=parseInt(e,10)),n&&(this._invalidate("size"),this._renderIfReady())},_isValueInObject:function(t,e){for(var i in t)if(t[i]===e)return!0;return!1}})}),define.component("core.components.MenuButton",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.skinParts({label:{type:"htmlElement"},icon:{type:"htmlElement",optional:!0},description:{type:"htmlElement",optional:!0},bullet:{type:"htmlElement",optional:!0}}),e.binds(["_buttonClick","_onMouseOver","_onMouseOut","_setImages","_onThemePropChange"]),e.states(["selected","idle","up","over","down","disable"]),e.dataTypes(["Link","Page","","AppPage","Text"]),e.fields({_renderTriggers:[Constants.DisplayEvents.DISPLAY_CHANGED],_selected:!1,_dropdownOpen:!1,_menu:null,_transitionValue:null,dropdownMode:!1,children:[]}),e.methods({initialize:function(t,e,i){this.parent(t,e,i),this._listSubType="NONE",i&&i.listSubType&&this.setListSubtype(i.listSubType),this.injects().Theme.addEvent("propertyChange",this._onThemePropChange)},createSubButton:function(t,e,i){var n=this;t(e,null,function(t){n.children.push(t),i(t)})},setMenu:function(t){this._menu=t},getMinimalWidth:function(){return Math.max(this.getOffsetWidth(),this._skinParts.label.offsetWidth)},fillWidthByPadding:function(t){this.setPadding(0);var e=t-this.getOffsetWidth();this.setPadding(e)},getPads:function(){return{left:parseInt(this._skinParts.bg.getStyle("padding-left"),10),right:parseInt(this._skinParts.bg.getStyle("padding-right"),10)}},disableTransition:function(){this._transitionValue=this.getViewNode().getStyle("-webkit-transition-duration"),this.getViewNode().setStyle("-webkit-transition-duration","0s")},enableTransition:function(){null!=this._transitionValue&&this.getViewNode().setStyle("-webkit-transition-duration",this._transitionValue)},setPadding:function(t){0>+t&&(t=0);var e,i=t/2;switch(0===i-Math.floor(i)?e=i:(i=Math.floor(i),e=i+1),this._menu.getComponentProperty("alignText")){case"center":this._skinParts.bg.setStyle("padding-left",i+"px"),this._skinParts.bg.setStyle("padding-right",e+"px");break;case"right":this._skinParts.bg.setStyle("padding-left",t+"px"),this._skinParts.bg.setStyle("padding-right","0px");break;case"left":this._skinParts.bg.setStyle("padding-left","0px"),this._skinParts.bg.setStyle("padding-right",t+"px")}},getMinimalDropdownWidth:function(){var t=0,e=this.getViewNode().getElements(".dropSizeTarget");return e&&e.length>0?e.forEach(function(e){t+=e.offsetWidth}):t=this.getViewNode().offsetWidth,t},isHidden:function(){var t=!1;return 1==this._data.get("hidePage")&&(t=!0),t},compareRefID:function(t){return this._data?this._data.get("id")===t.substr(1):!1},alignText:function(){var t=this.getPads();this.setPadding(t.left+t.right)},getOffsetWidth:function(){return this.getViewNode().offsetWidth},getOffsetLeft:function(){return this.getViewNode().offsetLeft},_onThemePropChange:function(t){this._setImages(t)},_onDataChange:function(t){return this._updateButtonView(),this.fireEvent("dataChanged"),this.parent(t)},render:function(){this._updateButtonView()},setSelected:function(t){this._selected=t,this._selected?this.setState("selected"):(this.removeState("selected"),this._dropdownOpen&&this.setState("over"))},setDropdownOpen:function(t){this._dropdownOpen=t,this._selected||(this._dropdownOpen?this.setState("over"):this.removeState("over"))},_getButtonLabelTextField:function(){return"Page"==this._data.getType()?"title":"text"},_updateButtonView:function(){if(this._data&&this._skinParts){var t=this._getButtonLabelTextField(),e=this._data.get(t);this._skinParts.label.set("html",this._getNonEmptyText(e));var i=this._skinParts.description;if(i){var n=this._data.get("target");i.set("html",this._getNonEmptyText(n))}this._setImages()}},getID:function(){return this._data?this._data.get("id"):""},_getNonEmptyText:function(t){return t=t.trim().replace(/ /g,"&nbsp;"),t||"&nbsp;"},_onAllSkinPartsReady:function(t){this.injects().Theme.addEvent(Constants.ComponentEvents.PROPERTY_CHANGE,this._setImages);var e=t.hitArea||t.view;e.addEvent(Constants.CoreEvents.CLICK,this._buttonClick),e.addEvent("mouseenter",this._onMouseOver),e.addEvent("mouseleave",this._onMouseOut)},_setImages:function(t){var e,i=this._listSubType+"_DIRECTORY";if(!t||t.name==i){var n=this.injects().Theme.getProperty(i);if("Link"==this._data.getType())this._skinParts.icon.uncollapse(),e="PAGES"==this._listSubType?n+this._data.get("icon"):n+this.injects().LinkTypes.getLinkIcon(this._data.get("linkType")),this._skinParts.icon.set("src",e);else if(this._skinParts.icon){var s=this._data.get("icon");s?(e=n+this._data.get("icon"),this._skinParts.icon.set("src",e)):this._skinParts.icon.setStyle("display","none")}}},getWidthOnLayout:function(){return this.getViewNode().offsetWidth+parseInt(this.getViewNode().getStyle("margin-left"),10)+parseInt(this.getViewNode().getStyle("margin-right"),10)},setLabel:function(t){this._skinParts.label.set("html",this._getNonEmptyText(t))},setListSubtype:function(t){this._listSubType=t},_buttonClick:function(){this.fireEvent("click")},_onMouseOver:function(){this.dropdownMode&&(this._selected||this.setState("over")),this.fireEvent("over")},_onMouseOut:function(){this.dropdownMode&&(this._selected||this._dropdownOpen||this.removeState("over")),this.fireEvent("out")}})}),define.component("core.components.Page",function(t){var e=t;e.inherits("core.components.Container"),e.resources(["W.Layout","W.Viewer"]),e.binds(["_notifyPageComponentsOnPageVisibilityChange","_doNotification"]),e.statics({MAX_HEIGHT:6e4,MIN_HEIGHT:500}),e.methods({initialize:function(t,e,i){this.parent(t,e,i),this._isContentWixified=!1,this._isContentWixifyStarted=!1,this._wixifyCBList=[],this._contentReady=!1,this.setMaxH(this.MAX_HEIGHT),this.setMinH(this.MIN_HEIGHT),e.collapse(),this.resources.W.Viewer.addEvent("pageTransitionEnded",this._notifyPageComponentsOnPageVisibilityChange)},delayedDispose:function(t){this.disposeChildren(),this._view.setStyle("visibility","hidden");var e=this,i=function(){e.dispose(),t&&t()};setTimeout(i,500)},dispose:function(){this.resources.W.Viewer.removeEvent("pageTransitionEnded",this._notifyPageComponentsOnPageVisibilityChange),this.parent()},getPageComponents:function(){var t=[];return this.getContainerComponents(t)},listenForContentRendered:function(){for(var t=this._view.getElements("[comp]"),e=[],i=0;t.length>i;i++){var n=t[i];n.getLogic&&n.getLogic().isRendered()===!0||void 0===n.$viewProxy&&e.push(n)}0===e.length?this._setContentRendered():new Async.Bulk(e,null,{completeEvent:Constants.ComponentEvents.RENDER,completeCallback:function(){this._setContentRendered()}.bind(this)})},getAcceptableDataTypes:function(){return["Page"]},wixifyContent:function(t){if(t&&this._wixifyCBList.push(t),this._isContentWixified)this._setWixified();else{if(this._isContentWixifyStarted)return;this._isContentWixifyStarted=!0;var e=this._view.getElements("[comp]");if(0===e.length)return this._setWixified(),this.listenForContentRendered(),void 0;new Async.Bulk(e,null,{completeEvent:"wixified",completeCallback:function(){this._setWixified()}.bind(this)}),this.listenForContentRendered(),e.wixify()}},render:function(){if(this.resources.W.Layout&&this.resources.W.Layout.getComponentMinResizeHeight){var t=this.resources.W.Layout.getComponentMinResizeHeight(this);this.setHeight(t)}},isContentWixify:function(){return this._isContentWixified},_setWixified:function(){this._isContentWixified||(this._view.getElements(".initHidden").removeClass("initHidden"),this._view.removeClass("initHidden"),this._isContentWixified=!0),this.fireEvent("contentWixified",this);for(var t=0;this._wixifyCBList.length>t;++t)this._wixifyCBList[t]();this._wixifyCBList=[],this.resources.W.Layout&&this.resources.W.Layout.attachSavedAnchors(this._view)},_setContentRendered:function(){this._contentReady=!0,this._findAndEnforceInvalidatedAnchors(this),this.render(),this.fireEvent("pageContentReady",this)},_findAndEnforceInvalidatedAnchors:function(t){if(t.getChildComponents){for(var e=t.getChildComponents(),i=[],n=0;e.length>n;n++)this._findAndEnforceInvalidatedAnchors(e[n].getLogic()),e[n].getLogic().isAnchorsInvalidated&&e[n].getLogic().isAnchorsInvalidated()&&i.push(e[n].getLogic());this.resources.W.Layout&&this.resources.W.Layout.enforceAnchors&&this.resources.W.Layout.enforceAnchors(i)}},setAsWixified:function(){this._setWixified()},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.NEVER},from:!1}},isSelectable:function(){return!1},isContentReady:function(){return this._contentReady},getInlineContentContainer:function(){return this._skinParts.inlineContent?this._skinParts.inlineContent:this._view},getThirdPartyApplicationComponent:function(){var t=this._view.getElement("[comp*='TPASection']");return t.getLogic()},isThirdPartyApplicationPage:function(){return this._data.get("tpaApplicationId")?!0:void 0},_doNotification:function(){var t=$$("#"+this._newPageId)[0].getLogic(),e=this.getPageComponents(),i=!1;this._compId==this._newPageId&&(i=!0),e.forEach(function(e){e.onPageVisibilityChange(i,t)})},_notifyPageComponentsOnPageVisibilityChange:function(t){var e=$$("#"+t)[0];e&&e.getLogic&&(this._newPageId=t,this._isContentWixified?this._doNotification():this.addEvent("contentWixified",this._doNotification))}})}),define.component("core.components.ServiceItem",function(t){var e=t;e.inherits("mobile.core.components.base.BaseComponent"),e.utilize([]),e.resources([]),e.binds(["_toggleOpen","_onImageReady"]),e.traits([]),e.skinParts({icon:{type:"htmlElement"},label:{type:"htmlElement"},readMore:{type:"htmlElement"},description:{type:"htmlElement"}}),e.dataTypes([]),e.states(["uncut","cutClosed","cutOpened"]),e.propertiesSchemaType(""),e.statics({}),e.fields({}),e.methods({initialize:function(t,e,i){this.parent(t,e,i),this._opened=!1,this._uncut=!0,this.imageDataQuery=void 0},render:function(){this._skinParts.label.set("html",this._data.get("title"));var t=this._data.get("description");t=t.replace(/\n/g,"<br/>"),this._skinParts.description.set("html",t);var e=$(this._skinParts.description).getElements("a");this._sanitizeLinks(e),this._disableLinks(e),this._skinParts.readMore.set("html","Read More"),this._testOpenState(),this._view.addEvent("click",this._toggleOpen);var i=this._data.get("image");i!=this.imageDataQuery&&(this._imageSkinContainer=this.injects().Components.createComponent("core.components.Image","mobile.core.skins.ImageSkin",i,{width:6,height:6,unit:"em",align:"center",valign:"top",cropMode:"fill"},this._onImageReady),this._skinParts.icon.empty(),this._imageSkinContainer.insertInto(this._skinParts.icon),this.imageDataQuery=i)},_testOpenState:function(){var t=this._skinParts.allText.getSize(),e=parseInt(this.injects().Utils.getComputedStyle(this._skinParts.description).fontSize,10);t.y>6.5*e?(this._opened=!this._opened,this._uncut=!1,this._toggleOpen()):(this._uncut=!0,this.setState("uncut"))},_toggleOpen:function(){this._uncut||W.Viewer.isScrollLock()||(this._opened?(this._skinParts.readMore.set("html","Read More"),this.setState("cutClosed")):(this._skinParts.readMore.set("html","Close"),this.setState("cutOpened")),this.fireEvent("autoSizedAnimation"),this._opened=!this._opened)},_onAutoSizedAnimtion:function(){},_onImageReady:function(t){t._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onImageDataChange.bind(this,t._data)),this._onImageDataChange(t._data)},_onImageDataChange:function(t){t.getMeta("isHidden")?(this._skinParts.icon.collapse(),this._skinParts.view.removeClass("showImage"),this._skinParts.view.addClass("hideImage")):(this._skinParts.icon.uncollapse(),this._skinParts.view.addClass("showImage"),this._skinParts.view.removeClass("hideImage"))},getAcceptableDataTypes:function(){return["Service"]}})}),define.component("core.components.SimpleBaseList",function(t){var e=t;e.inherits("core.components.BaseList"),e.methods({initialize:function(t,e,i){this.parent(t,e,i),this._allItemsLoaded=!1,this._isLoadingItems=!1},getAcceptableDataTypes:function(){return["PropertyList"]},getItemsContainer:function(){return this._skinParts.itemsContainer||this._view},_prepareForRender:function(){if(this._allItemsLoaded)return!0;if(this._isLoadingItems)return!1;this._isLoadingItems=!0;var t=this._getItemsData();return this._renderItems(t),this._allItemsLoaded},_onDataChange:function(){this._allItemsLoaded=!1,this._isLoadingItems=!1,this.parent()},_getItemsData:function(){return this._data?this._data.get("items"):void 0},_onAllItemsReady:function(){this._isLoadingItems=!1,this._allItemsLoaded=!0,this._renderIfReady()}})}),define.component("core.components.SimpleButton",function(t){var e=t;e.utilize(["mobile.core.components.base.BaseComponent"]),e.binds(["_buttonClick"]),e.skinParts({label:{type:"htmlElement"},hitArea:{type:"htmlElement"}}),e.states(["up","over","down","disable"]),e.methods({render:function(){var t="Page"==this._data.getType()?"title":"text";this._skinParts.label.set("html",this._data.get(t))},_onAllSkinPartsReady:function(t){t.hitArea.addEvent("click",this._buttonClick)},_buttonClick:function(){this.fireEvent("click")},getAcceptableDataTypes:function(){return["Button","Link","Page"]}})}),function(){var t="BG_USES_CUSTOM_IMAGE",e="BG_USES_THEME_IMAGE";define.component("mobile.core.components.SiteStructure",function(i){var n=i;n.inherits("core.components.Container"),n.binds(["changeBGImage"]),n.fields({_bgSizes:[{w:204,h:309},{w:320,h:452},{w:320,h:646},{w:320,h:800},{w:400,h:591},{w:480,h:480},{w:533,h:239},{w:683,h:334},{w:768,h:896},{w:1024,h:640}]}),n.methods({initialize:function(t,e,i){this.parent(t,e,i),window.onorientationchange&&window.addEvent("orientationchange",this.changeBGImage),window.addEvent("resize",this.changeBGImage),W.Theme.addEvent("propertyChange",this.changeBGImage),this.changeBGImage({type:"init"})},render:function(){this.sitePagesNode=this._view.getElement("#SITE_PAGES"),this.sitePagesNode||LOG.reportError(wixErrors.SITE_STRUCTURE_NO_SITE_PAGES,"core.components.SiteStructure","render");var t=this.injects().Theme.getProperty("padding1");t=t.split(" ");var e="0";switch(t.length){case 1:e="0 "+t[0];break;case 2:case 3:e="0 "+t[1];break;case 4:e="0 "+t[1]+" 0 "+t[3]}this.sitePagesNode.setStyle("margin",e)},_getReformattedBgColor:function(){var t=this.injects().Theme.getProperty("bgSize").split(",");return{width:t[0],height:t[1]}},changeBGImage:function(){var i,n=this.injects().Utils.getWindowSize(),s=this._getBestFit(n,this._bgSizes),a=this.injects().Theme.getProperty("bgType");switch(a){case e:i=this.injects().Theme.getProperty("BG_DIRECTORY")+"bg_"+s.w+"x"+s.h+".jpg",$(document.body).setStyle("background",'url("'+i+'") repeat');break;case t:var r=this.injects().Config.getServiceTopologyProperty("staticMediaUrl")+"/",o=this.injects().Theme.getProperty("bgId"),h=this._getReformattedBgColor(),l=h.width,c=h.height;if(l>100){l=s.w;var d=h.width/h.height;c=Math.round(l/d)}var u=r+o+"_crp_0"+"_0"+"_"+h.width+"_"+h.height+"_"+l+"_"+c+"_crp";$(document.body).setStyle("background",'url("'+u+'") repeat');break;default:$(document.body).setStyle("background","")}i=this.injects().Theme.getProperty("siteBgColor"),$(document.body).setStyle("background-color",i.getHex(!1))},_getWantedBgSize:function(){var t,e,i,n=this._getReformattedBgColor(),s=n.width,a=n.height,r=this._view.clientWidth,o=this._view.clientHeight,h=a/s,l=o/r;l>h?(e=o,t=e/h):(t=r,e=t*h);for(var c=t>e?e:t,d=0;this._bgSizes.length>d;d++)if(this._bgSizes[d]>=c){i=this._bgSizes[d];break}return i},_getBestFit:function(t,e){for(var i=e[0],n=1;e.length>n;++n){var s=e[n],a=s.w-t.width,r=i.w-t.width;a>=0?i=0>r?e[n]:r>a?e[n]:i:0>r&&(i=a>r?e[n]:i)}return i}})})}(),define.component("core.components.TwitterFollow",function(t){var e=t;e.utilize(["mobile.core.components.base.BaseComponent"]),e.skinParts({twitter:{type:"htmlElement"}}),e.fields({propertiesSchema:{showCount:{type:"string","enum":["true","false"],"default":"true",description:"Followers count display"},button:{type:"string","enum":["blue","gray"],"default":"blue",description:"Button color"},textColor:{type:"string","default":"",description:"HEX color code for the text color"},linkColor:{type:"string","default":"",description:"HEX color code for the Username link color"},width:{type:"string","default":"",description:"width of the Follow Button"},align:{type:"string","default":"",description:"alignment of the Follow Button"},dataLang:{type:"string","enum":["en","fr","de","it","es","ko","ja"],"default":"en",description:"The language for the Tweet Button"}}}),e.methods({initialize:function(t,e){this.parent(t,e)},render:function(){this._runTwitterScript(),this._rebuildTwitterElement()},_onComponentPropertyChange:function(){this._rebuildTwitterElement()},_rebuildTwitterElement:function(){this._skinParts.twitter.empty();var t=this._data.get("accountToFollow").replace("@","");t||(t="wix");var e={"class":"twitter-follow-button",href:"https://twitter.com/"+t,"data-show-count":this.getComponentProperty("showCount"),"data-button":this.getComponentProperty("button"),"data-text-color":this.getComponentProperty("textColor"),"data-link-color":this.getComponentProperty("linkColor"),"data-lang":this.getComponentProperty("dataLang"),"data-width":this.getComponentProperty("width"),"data-align":this.getComponentProperty("align")},i=new Element("a",e);this._skinParts.twitter.adopt(i),void 0!==window.twttr&&twttr.widgets.load()},getAcceptableDataTypes:function(){return["TwitterFollow"]},_runTwitterScript:function(){this.injects().Viewer.loadExternalScript("//platform.twitter.com/widgets.js")}})}),define.component("core.components.base.BaseComp",function(t){var e=t;e.inherits("bootstrap.managers.events.EventDispatcher"),e.utilize(["core.managers.component.ComponentDefinition"]),e.traits(["core.components.base.traits.BaseCompInvalidation","core.components.base.traits.BaseCompSkinHandler","core.components.base.traits.BaseCompChildCompHandler","core.components.base.traits.BaseCompStates","core.components.base.traits.BaseCompDataHandler","core.components.base.traits.BaseCompProperties","core.components.base.traits.BaseCompLayout","core.components.base.traits.OldBaseCompIntegration","core.components.base.traits.OldBaseCompLayoutIntegration","core.components.base.traits.OldBaseCompEditorPropIntegration"]),e.resources(["W.ComponentLifecycle"]),e.skinParts({}),e.dataTypes([""]),e.states({}),e.statics({NEW_BASE_COMP:!0,INVALIDATIONS:{SKIN_CHANGE:"skinChange",DATA_CHANGE:"dataChange",DISPLAY:"display",WIDTH_REQUEST:"widthRequest",HEIGHT_REQUEST:"heightRequest",X_REQUEST:"xRequest",Y_REQUEST:"yRequest",SIZE:"sizeChanged",POSITION:"positionChanged",PART_SIZE:"partSize",PART_POSITION:"partPosition"}}),e.methods({initialize:function(t){this._compId=t,this.on(Constants.LifecycleSteps.RENDER,this,this._onRender)},getComponentId:function(){return this._compId},isRenderNeeded:function(t){var e=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.WIDTH_REQUEST,this.INVALIDATIONS.HEIGHT_REQUEST];return t.isInvalidated(e)},_onRender:function(){},isDisplayed:function(){var t=this.resources.W.ComponentLifecycle.getComponentInfo(this);return t.isDisplayed},getComponentStatus:function(){var t=this.resources.W.ComponentLifecycle.getComponentInfo(this);return t.state},exterminate:function(){return this._isExterminated?LOG.reportError(wixErrors.COMPONENT_ALREADY_DISPOSED,this.$className,"exterminate",this.getComponentId()):(this._isExterminated=!0,this.parent(),void 0)}})}),define.Class("core.components.base.BaseLayoutEngine",function(t){var e=t;e.methods({initialize:function(t){this._viewNode=t},updateLayoutFromViewNode:function(){},setSize:function(){},setPosition:function(){},getSize:function(){},getPosition:function(){}})}),define.Const("ComponentEvents",{DISPLAYED:"displayed",READY:"componentReady",WIXIFIED:"wixified",PROPERTY_CHANGE:"componentPropertyChange",READY_FOR_RENDER:"readyForRender",RENDER:"render",COMPONENT_SEQUENCER_COMP_SETUP:"componentSetup",COMPONENT_SEQUENCER_PRODUCTION_FINISHED:"productionFinished"}),define.Const("ComponentPartTypes",{HTML_ELEMENT:"htmlElement"}),define.Class("core.components.base.InvalidationCollector",function(t){var e=t;e.methods({initialize:function(){this._invalidations={}},invalidate:function(t,e){if(t){var i=this._invalidations[t]||[];i.push(e),this._invalidations[t]=i}},clearInvalidationType:function(t){delete this._invalidations[t]},isInvalidated:function(t){for(var e=0;t.length>e;++e)if(type=t[e],void 0!==this._invalidations[type])return!0;return!1},getInvalidationByType:function(t){return this._invalidations[t]},getLastInvalidationByType:function(t){var e=this._invalidations[t];return e?e[e.length-1]:null}})}),define.Class("core.components.base.SizeLimits",function(t){var e=t;e.methods({initialize:function(){this.minW=null,this.minH=null,this.maxW=null,this.maxH=null},clone:function(){var t=new this.$class;return t.minW=this.minW,t.minH=this.minH,t.maxW=this.maxW,t.maxH=this.maxH,t}})}),define.Const("BaseComponent",{ResizeSides:{TOP:"RESIZE_TOP",LEFT:"RESIZE_LEFT",BOTTOM:"RESIZE_BOTTOM",RIGHT:"RESIZE_RIGHT"},MoveDirections:{HORIZONTAL:"HORIZONTAL_MOVE",VERTICAL:"VERTICAL_MOVE"},AnchorLock:{NEVER:"never",BY_THRESHOLD:"threshold",ALWAYS:"always"}}),define.Class("core.components.base.traits.BaseCompChildCompHandler",function(t){var e=t;e.utilize(["core.managers.components.ComponentBuilder"]),e.resources(["W.ComponentLifecycle","W.Data"]),e.binds(["_onChildComponentReady"]),e.fields({SKIN_PART_ATTR_NAME:"skinPart"}),e.methods({_createInnerComponent:function(t,e,i){e=e||new Element("div"),e.setProperty(this.SKIN_PART_ATTR_NAME,t.id);var n=t.argObject||{},s=this._getInnerComponentData(t),a=this._getInnerComponentStyle(t),r=t.skin,o=t.type,h=new this.imports.ComponentBuilder(e);return h.withType(o).withSkin(r).withData(s).withArgs(n).withSkinParamMapper(a).onCreated(this._onChildComponentReady).create(),i&&!e.$logic,e.$logic},_onChildComponentReady:function(t){console.log("created "+t),this.resources.W.ComponentLifecycle.setParentComponentProcess(t,this)},_getInnerComponentData:function(t){var e;if(t.dataQuery)e=t.dataQuery;else if(t.dataRefField){var i=t.dataRefField;e="*"==i?this._data:this._data.get(i)}else if(t.dataType){var n=this._data?this._data.getDataManager():this.resources.W.Data;e=n.addDataItemWithUniqueId("",{type:t.dataType}).dataObject,e.setMeta("isPersistent",!1)}return e},_getInnerComponentStyle:function(t){var e,i=this._skin&&this._skin.getParamMapper();return t.styleGroup&&i&&(e="inherit"==t.styleGroup?i:i.getStyleByGroupName(t.styleGroup)),e}})}),define.Class("core.components.base.traits.BaseCompDataHandler",function(t){var e=t;e.binds(["_onDataChange"]),e.statics({_definitionFieldName_:"_dataTypes_",_fieldName_:"dataTypes",_aggregateSchema_:function(t,e,i){if((!t||t&&"array"!==typeOf(t))&&(t=[""]),e&&"array"===typeOf(e)&&(t=t.combine(e)),"array"===typeOf(i)){for(var n=[],s=0;t.length>s;++s)-1===i.indexOf(t[s])&&n.push(t[s]);
t=n}return t}}),e.methods({initialize:function(){this._data=null,this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateData),this.$compSchema.dataTypes||(this.$compSchema.dataTypes=[""])},_getDataManager:function(){return this._data?this._data.getDataManager():null},getRawData:function(){return this._data?this._data.getData():void 0},getDataItem:function(){return this._data},setDataItem:function(t){this.isDataTypeValid(t)&&t!=this._data&&(this._removeCurrentData(),this._data=t,t&&(this._data.addComponentWithInterest(this),this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)),this._onDataChange(t))},_removeCurrentData:function(){if(this._data)try{this._data.removeComponentWithInterest(this),this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange);var t=this._data.getDataManager();t&&t.removeDataItem(this._data),this._data=null}catch(e){}},setDataByQuery:function(t){this.injects().Data.getDataByQuery(t,function(t){this.setDataItem(t)}.bind(this))},isDataTypeValid:function(t){var e=t?t.getType():"";return!this.$compSchema.dataTypes.contains,this.$compSchema.dataTypes.contains(e)},_setDataField:function(t,e){this._data.set(t,e,!0)},_setMetaDataField:function(t,e){this._data.setMeta(t,e)},_onDataChange:function(t,e,i){var n={dataItem:t,field:e,value:i};this.invalidate(this.INVALIDATIONS.DATA_CHANGE,n,!0)},_exterminateData:function(){this._removeCurrentData()}})}),define.Class("core.components.base.traits.BaseCompInvalidation",function(t){var e=t;e.utilize(["core.components.base.InvalidationCollector"]),e.methods({initialize:function(){this._invalidations_=new this.imports.InvalidationCollector},invalidate:function(t,e,i){t&&(this._invalidations_.invalidate(t,e),i&&this.trigger(t,e))},isInvalidated:function(t){return this._invalidations_.isInvalidated(t)},getInvalidationByType:function(t){return this._invalidations_.getInvalidationByType(t)},getLastInvalidationByType:function(t){return this._invalidations_.getLastInvalidationByType(t)}})}),define.Class("core.components.base.traits.BaseCompLayout",function(t){var e=t;e.methods({initialize:function(){this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateLayout)},setWidth:function(t){value=parseInt(t,10),isNaN(value)||(value=this._limitWidth(value),this._setWidth_(value),this.getRequestDimensions().width=value,this.invalidate(this.INVALIDATIONS.WIDTH_REQUEST,{width:value,requestedWeight:t},!0),this.resources.W.ComponentLifecycle.forceRender())},setHeight:function(t){value=parseInt(t,10),isNaN(value)||(value=this._limitHeight(value),this._setHeight_(value),this.getRequestDimensions().height=value,this.invalidate(this.INVALIDATIONS.HEIGHT_REQUEST,{height:value,requestedHeight:t},!0),this.resources.W.ComponentLifecycle.forceRender())},setX:function(t){value=parseInt(t,10),isNaN(value)||(this._setX_(value),this.getRequestDimensions().left=value,this.invalidate(this.INVALIDATIONS.X_REQUEST,{x:value,requestedX:t},!0),this.resources.W.ComponentLifecycle.forceRender())},setY:function(t){value=parseInt(t,10),isNaN(value)||(this._setY_(value),this.getRequestDimensions().top=value,this.invalidate(this.INVALIDATIONS.Y_REQUEST,{y:value,requestedY:t},!0),this.resources.W.ComponentLifecycle.forceRender())},getWidth:function(){return this.getRequestDimensions().width},getHeight:function(){return this.getRequestDimensions().height},getX:function(){return this.getRequestDimensions().left},getY:function(){return this.getRequestDimensions().top},getInvalidatedWidth:function(){var t=this.getLastInvalidationByType(this.INVALIDATIONS.WIDTH_REQUEST);return t?t.width:null},getInvalidatedHeight:function(){var t=this.getLastInvalidationByType(this.INVALIDATIONS.HEIGHT_REQUEST);return t?t.height:null},getInvalidatedX:function(){var t=this.getLastInvalidationByType(this.INVALIDATIONS.X_REQUEST);return t?t.x:null},getInvalidatedY:function(){var t=this.getLastInvalidationByType(this.INVALIDATIONS.Y_REQUEST);return t?t.y:null},_setWidth_:function(t){t=this._limitWidth(t),this.$view.style.minWidth=t+"px"},_setHeight_:function(t){t=this._limitHeight(t),this.$view.style.minHeight=t+"px"},_setX_:function(t){this.$view.style.left=t+"px"},_setY_:function(t){this.$view.style.top=t+"px"},getPhysicalHeight:function(){var t=this.getMeasure().height,e=this.getInvalidatedHeight();return Math.max(t,e)},getPhysicalWidth:function(){var t=this.getMeasure().width,e=this.getInvalidatedWidth();return Math.max(t,e)},getRequestDimensions:function(){return this.$view.$requestDimensions=this.$view.$requestDimensions||{width:0,height:0,top:0,left:0},this.$view.$requestDimensions},getMeasure:function(){return this.$view.$measure||{width:0,height:0,top:0,left:0}},getMinDragY:function(t){return W.Layout&&W.Layout.getComponentMinDragY(this,t)},isSizeInvalidated:function(){return!!this.getInvalidatedWidth()||!!this.getInvalidatedHeight()},_limitWidth:function(t){return this._limitDimension(t,this.getSizeLimits().minW,this.getSizeLimits().maxW)},_limitHeight:function(t){return this._limitDimension(t,this.getSizeLimits().minH,this.getSizeLimits().maxH)},_limitDimension:function(t,e,i){return Math.min(Math.max(t,e),i)},disableReportLayoutChange:function(){this._isReportLayoutChangeDisabled=!0},enableReportLayoutChange:function(){this._isReportLayoutChangeDisabled=!1},isFixedPositioned:function(){return!1},reportLayoutChange:function(){if(!this._isReportLayoutChangeDisabled){var t=!0;null==this.getAnchors()||W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getAnchors())?t=!1:null!=this.getHorizontalGroup()&&W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getHorizontalGroup())?t=!1:this._areAnchorsAlreadySet||(t=!1),this._anchorTargetsReady||t?(this._anchorsInvalidated=!1,this._anchorTargetsReady=!0,W.Layout&&W.Layout.enforceAnchors([this])):this._anchorsInvalidated=!0}},_exterminateLayout:function(){W.Layout&&W.Layout.deleteSavedAnchorsById(this.getComponentId())}})}),define.Class("core.components.base.traits.BaseCompProperties",function(t){var e=t;e.resources(["W.ComponentData"]),e.statics({_definitionFieldName_:"_propertiesSchemaType_",_fieldName_:"propertiesSchemaType",_aggregateSchema_:function(t){return t||""}}),e.methods({initialize:function(){this._properties=null,this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateProperties)},setComponentProperties:function(t){t&&t!==this._properties&&(this._removeCurrentProperties(),this._properties=t,this._properties.addComponentWithInterest(this),this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this.$view.setProperty("propertyQuery",this._properties.get("id")))},_removeCurrentProperties:function(){if(this._properties){this._properties.removeComponentWithInterest(this),this._properties.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange);var t=this._properties.getDataManager();t&&t.removeDataItem(this._properties),this._properties=null}},getComponentProperties:function(){return this._properties||this._createComponentProperties(),this._properties},getComponentProperty:function(t){return this._properties||this._createComponentProperties(),this._properties.get(t)},setComponentProperty:function(t,e,i){this._properties||this._createComponentProperties(),this._properties.set(t,e,i)},_createComponentProperties:function(){if(this.$view){var t=this._compId,e=this.$compSchema.propertiesSchemaType;if(!e)return null;var i=this.resources.W.ComponentData.addDataItem(t,{type:e},this);this.setComponentProperties(i)}},deleteComponentProperty:function(){},_onComponentPropertyChange:function(){},_loadComponentProperties:function(){},_exterminateProperties:function(){this._removeCurrentProperties()}})}),define.Class("core.components.base.traits.BaseCompSkinHandler",function(t){var e=t;e.statics({_definitionFieldName_:"_skinParts_",_fieldName_:"skinParts",_aggregateSchema_:function(t,e,i){if((!t||t&&"object"!==typeOf(t))&&(t={}),e&&"object"===typeOf(e)&&Object.merge(t,e),i&&"object"===typeOf(i))for(var n in i)delete t[n];return t}}),e.methods({initialize:function(t,e,i){this.$view=e,this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateView),this._styleNameSpace=i&&i.styleNameSpace,this.$compSchema.skinParts||(this.$compSchema.skinParts={})},setSkin:function(t){this._removeOldSkinAndExtractInlineContent(),this._skin=t,this._skin._setLogic_(this)},getSkin:function(){return this._skin||null},setSkinMapper:function(t){if(this._skin.getOriginalClassName()===t.getSkin())this._skin.setParamMapper(t);else{var e=t.getSkinClass(),i=new e;i.setParamMapper(t),this.setSkin(i)}},getSkinMapper:function(){return this._skin&&this._skin.getParamMapper()||null},getStyleNameSpace:function(){return this._styleNameSpace||this.$className},getInlineContent:function(){return this._skinParts&&this._skinParts.inlineContent?this._skinParts.inlineContent.getChildren():!this._skinParts&&this.$view?this.$view.getChildren():null},_removeOldSkinAndExtractInlineContent:function(){var t=this.getInlineContent();t&&(this.$view.empty(),this.$view.adopt(t)),this._skin&&this._skin._removeLogic_()},_updateSkinParts_:function(t){this._validateSkinParts(t),this._skinParts=this._processCompParts(t),this.invalidate(this.INVALIDATIONS.SKIN_CHANGE)},_validateSkinParts:function(t){var e=this.$compSchema.skinParts;if(e)for(var i in e){var n=e[i];t[i]||n.optional||n.autoCreate===!1||LOG.reportError(wixErrors.SKIN_PART_MISSING,this.getOriginalClassName()+" / "+this._skin.getOriginalClassName(),"_validateSkinParts",i)()}},_processCompParts:function(t){var e=Object.clone(t),i=this.$compSchema.skinParts;for(var n in i){var s=i[n];if("htmlElement"!==s.type&&s.autoCreate!==!1){var a=this.getSkinPartDefinition(n),r=t[n];e[n]=this._createInnerComponent(a,r,!1)}}return e},getSkinPartDefinition:function(t){var e=this.$compSchema.skinParts[t],i=this._skin&&this._skin.getCompPartsDefinition()[t]||{},n={id:t};return e?n=Object.merge(n,i,e):(n.partDefinitionNotFound="maybe you missed a letter?",LOG.reportError(wixErrors.CM_NO_PART,this.getOriginalClassName(),"getSkinPartDefinition",t)()),n.hookMethod&&"function"==typeOf(this[n.hookMethod])&&(n.argObject=n.argObject||{},n=this[n.hookMethod](n)),n},_exterminateView:function(){this._skin&&this._skin.exterminate(),this.$view&&(this.$view.cleanup(),this.$view.destroy(),this.$view=null)}})}),define.Class("core.components.base.traits.BaseCompStates",function(t){var e=t;e.fields({DEFAULT_GROUP_NAME:"DEFAULT",ATTR_NAME:"state"}),e.statics({_definitionFieldName_:"_states_",_fieldName_:"states",_aggregateSchema_:function(t,e,i){if(t=t||[],"array"===typeOf(t)&&(t={DEFAULT:t}),e&&("array"===typeOf(e)?t.DEFAULT=e:Object.merge(t,e)),i)if("array"===typeOf(i))t.DEFAULT=[];else for(var n in i)delete t[n];var s={};for(var a in t)Array.each(t[a],function(t){return s[t]?(LOG.reportError(wixErrors.CM_DUPLICATE_STATE_NAME,"BaseCompStates","_aggregateSchema_",t)(),null):(s[t]=1,void 0)}.bind(this));return t}}),e.methods({initialize:function(){this._selectedStates={},this._groupNames=[],this.$compSchema.states||(this.$compSchema.states={}),this._initializeCurrentState()},_initializeCurrentState:function(){this._selectedStates={},Object.each(this.$compSchema.states,function(t,e){this._selectedStates[e]=t[0]},this),this._syncViewNodeWithStates()},getState:function(t){var e=t||this.DEFAULT_GROUP_NAME,i=this._selectedStates[e];return i||null},setState:function(t,e){var i=t,n=e;return n||(n=this._getGroupNameByState(i)),n?this._selectedStates[n]?this.$compSchema.states[n].contains(i)?(this._selectedStates[n]=i,this._syncViewNodeWithStates(),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,"BaseCompStates","setState",this.getOriginalClassName()+"{"+e+":"+t+"}"),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,"BaseCompStates","setState",this.getOriginalClassName()+"{"+e+"}"),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,"BaseCompStates","setState",this.getOriginalClassName()+"{"+e+":"+t+"}"),void 0)},hasState:function(t,e){return e||(e=this._getGroupNameByState(t)),e?this.$compSchema.states?this.$compSchema.states[e]?this.$compSchema.states[e].contains(t)?!0:!1:!1:!1:!1},_getGroupNameByState:function(t){for(var e in this.$compSchema.states)if(this.$compSchema.states[e].contains(t))return e;return null},_syncViewNodeWithStates:function(){var t=this.getViewNode();if(t){var e=Object.values(this._selectedStates).join(" ");t.setAttribute(this.ATTR_NAME,e),t.addClass("FOCRE_REFLOW_PLEASE"),t.removeClass("FOCRE_REFLOW_PLEASE")}}})}),define.Class("core.components.base.traits.OldBaseCompEditorPropIntegration",function(t){var e=t;e.utilize(["core.components.base.SizeLimits"]),e.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),e.methods({initialize:function(){this._showOnAllPagesChangeability=!0,this._usesExternalData=!1,this._resizableSides||(this._resizableSides=[Constants.BaseComponent.ResizeSides.TOP,Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.BOTTOM,Constants.BaseComponent.ResizeSides.RIGHT]),this._moveDirections=[Constants.BaseComponent.MoveDirections.HORIZONTAL,Constants.BaseComponent.MoveDirections.VERTICAL],this.on(this.INVALIDATIONS.Y_REQUEST,this,this._OBCEI_onMovement),this.on(this.INVALIDATIONS.X_REQUEST,this,this._OBCEI_onMovement)},getSelectableX:function(){return this.getX()},getSelectableY:function(){return this.getY()},getSelectableWidth:function(){return this.getPhysicalWidth()},getSelectableHeight:function(){return this.getPhysicalHeight()},isSelectable:function(){return!0},getHorizontalGroup:function(){return this._horizontalGroup},_OBCEI_onMovement:function(){this.fireEvent("componentMoved")},allowHeightLock:function(){return this.isVertResizable()},getResizableSides:function(){return this._resizableSides},isResizable:function(){return this._resizableSides.length>0},isHorizResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.RIGHT)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.LEFT)},isVertResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.TOP)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.BOTTOM)},isHorizontallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.HORIZONTAL)},isVerticallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.VERTICAL)},getSizeRefNode:function(){return this._getEditBoxReferenceNode().getSize()},_getEditBoxReferenceNode:function(){return this.$view},getExtraPixels:function(t){return this.getDivExtraPixels(this.$view,t)},getDivExtraPixels:function(t,e){var i=Number.from(t.getStyle("border-top"))+Number.from(t.getStyle("padding-top")),n=Number.from(t.getStyle("border-bottom"))+Number.from(t.getStyle("padding-bottom")),s=Number.from(t.getStyle("border-left"))+Number.from(t.getStyle("padding-left")),a=Number.from(t.getStyle("border-right"))+Number.from(t.getStyle("padding-right"));return e&&(i+=Number.from(t.getStyle("margin-top")),n+=Number.from(t.getStyle("margin-bottom")),s+=Number.from(t.getStyle("margin-left")),a+=Number.from(t.getStyle("margin-right"))),{top:i,bottom:n,left:s,right:a,height:i+n,width:s+a}},isSiteSegment:function(){return this.isInstanceOfClass("wysiwyg.viewer.components.SiteSegmentContainer")},isInstanceOfClass:function(t){if(this.className==t)return!0;for(var e=this.$parentPrototype;e;){if(e.className==t)return!0;e=e.$parentPrototype}return!1},useLayoutOnDrag:function(){return!1},useLayoutOnResize:function(){return!1},isDraggable:function(){return!0},isEditableInPlace:function(){return!1},getGlobalPosition:function(){return this.$view.getPosition()},getGlobalPositionRefNode:function(){return this._getEditBoxReferenceNode().getPosition()},getParentComponent:function(){var t=this.getViewNode().getParent("[comp]");return t&&t.getLogic?t.getLogic():null},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD},from:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD}}},isContainable:function(){return!0},isDeleteable:function(){return!0},isDuplicatable:function(){return!0},isDeleteableRecurse:function(){if(!this.isDeleteable())return!1;for(var t=this.getViewNode().getElements("[comp]"),e=0;t.length>e;e++)if(t[e].getLogic&&!t[e].getLogic().isDeleteable())return!1;return!0},isMultiSelectable:function(){return!0},getShowOnAllPagesChangeability:function(){return this._showOnAllPagesChangeability},setShowOnAllPagesChangeability:function(t){this._showOnAllPagesChangeability=t},hasChildren:function(){return!1},canMoveToOtherScope:function(){return!0},isUsingExternalData:function(){return this._usesExternalData},onPageVisibilityChange:function(){},getID:function(){return this.$view.getProperty("id")}})}),define.Class("core.components.base.traits.OldBaseCompIntegration",function(t){var e=t;e.inherits("bootstrap.utils.Events"),e.methods({initialize:function(t,e){this._view=e,this._isRendered=!1,this.on(Constants.LifecycleSteps.RENDER,this,this._OBCI_onRender),this.on(this.INVALIDATIONS.SIZE,this,this._OBCI_onSizeChange)},_OBCI_onRender:function(){this.off(Constants.LifecycleSteps.RENDER,this,this._OBCI_onRender),this._isRendered=!0,setTimeout(function(){this.fireEvent(Constants.ComponentEvents.RENDER),this.$view.fireEvent(Constants.ComponentEvents.RENDER),this.fireEvent(Constants.ComponentEvents.READY),this.$view.fireEvent(Constants.ComponentEvents.READY)}.bind(this),1)},_OBCI_onSizeChange:function(){this.fireEvent("autoSizeChange")},setStyle:function(t){this.setSkinMapper(t)},getStyle:function(){return this.getSkinMapper()},getIsDisposed:function(){return this._isExterminated},isRendered:function(){return this._isRendered},getViewNode:function(){return this.$view},dispose:function(){this.exterminate()}})}),define.Class("core.components.base.traits.OldBaseCompLayoutIntegration",function(t){var e=t;e.utilize(["core.components.base.SizeLimits"]),e.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),e.methods({initialize:function(){this._actualHeight=-1,this._anchors=[],this._reverseAnchors=[],this.initComponentLayout()},initComponentLayout:function(){this.$view.setStyle("visibility","visible"),this.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout),this._valueFetchingRegex=/[-\d\.]+/;for(var t=["x","y","width","height"],e=!1,i=0;t.length>i;i++){var n=t[i],s=this.$view.get(n);if(null!=s&&""!=s)switch(e=!0,s=Number(s),n){case"width":this.getRequestDimensions().width=s,this._setWidth_(s);break;case"height":this.getRequestDimensions().height=s,this._setHeight_(s);break;case"x":this.getRequestDimensions().left=s,this._setX_(s);break;case"y":this.getRequestDimensions().top=s,this._setY_(s)}}if(e&&this.$view.hasAttribute("pos")===!1)"relative"!=this.$view.getStyle("position")&&this.$view.setStyle("position","absolute");else{var a=this.$view.getAttribute("pos");a&&this.$view.setStyle("position",a)}this.saveCurrentDimensions(),this.saveCurrentCoordinates()},getMinPhysicalHeight:function(){return 1},saveCurrentDimensions:function(){this._lastDimensions={w:this.getWidth(),h:this.getHeight()}},getCurrentDimensions:function(){return this._lastDimensions={w:this.getWidth(),h:this.getHeight()},this._lastDimensions},getLastDimensions:function(){return this._lastDimensions||this.saveCurrentDimensions(),this._lastDimensions},getCurrentCoordinates:function(){return this._lastCoords={x:this.getX(),y:this.getY()},this._lastCoords},getLastCoordinates:function(){return this._lastCoords||this.saveCurrentCoordinates(),this._lastCoords},saveCurrentCoordinates:function(){this._lastCoords={x:this.getX(),y:this.getY()}},_onAutoSized:function(){},getIsDisplayed:function(){return this.isDisplayed()},checkVisibility:function(){return this.isDisplayed()},getSizeLimits:function(){return void 0===this._sizeLimits&&(this._sizeLimits=new this.imports.SizeLimits,this._sizeLimits.minW=this._sizeLimits.minW||this.MINIMUM_WIDTH_DEFAULT,this._sizeLimits.minH=this._sizeLimits.minH||this.MINIMUM_HEIGHT_DEFAULT,this._sizeLimits.maxW=this._sizeLimits.maxW||this.MAXIMUM_WIDTH_DEFAULT,this._sizeLimits.maxH=this._sizeLimits.maxH||this.MAXIMUM_HEIGHT_DEFAULT,this._originalSizeLimits=this._sizeLimits.clone()),this._sizeLimits},setMinW:function(t){this.getSizeLimits().minW=t,this._originalSizeLimits.minW=t,this._applySizeLimitsIfNeeded()},setMinH:function(t){this.getSizeLimits().minH=t,this._originalSizeLimits.minH=t,this._applySizeLimitsIfNeeded()},setMaxW:function(t){this.getSizeLimits().maxW=t,this._originalSizeLimits.maxW=t,this._applySizeLimitsIfNeeded()},setMaxH:function(t){this.getSizeLimits().maxH=t,this._originalSizeLimits.maxH=t,this._applySizeLimitsIfNeeded()},_applySizeLimitsIfNeeded:function(){(this._$width<this.getSizeLimits().minW||this._$width>this.getSizeLimits().maxW)&&this.setWidth(this._$width),(this._$height<this.getSizeLimits().minH||this._$height>this.getSizeLimits().maxH)&&this.setHeight(this._$height)},_onResize:function(){this.fireEvent("resize")},flushPhysicalHeightCache:function(){delete this._actualHeight},flushMinPhysicalHeightCache:function(){delete this._minPhysicalHeight},getAnchors:function(){return this._anchors},setAnchors:function(t){this._areAnchorsAlreadySet=!0,this._anchors=t,t.forEach(this.addReverseAnchor)},addAnchor:function(t){this._anchors.push(t),this.addReverseAnchor(t)},addReverseAnchor:function(t){t.toComp===this?this._reverseAnchors.include(t):t.toComp.addReverseAnchor(t)},getReverseAnchors:function(){return this._reverseAnchors},getHorizontalGroup:function(){return this._horizontalGroup},setHorizontalGroup:function(t){this._horizontalGroup=t}})}),define.Class("core.components.image.ImageDimensions",function(t){var e=t;e.statics({settingOptions:{crop:{FILL:"fill",FULL:"full",STRETCH:"stretch"},align:{LEFT:"left",CENTER:"center",RIGHT:"right"},v_align:{TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"}}}),e.methods({initialize:function(){this._imageSettings={crop:this.settingOptions.crop.FILL,align:this.settingOptions.align.CENTER,v_align:this.settingOptions.v_align.MIDDLE}},getDimensionsForContainerSize:function(t,e){var i=this._getImageRequestSize(t,e),n=this._getImageObjectSize(i,e),s=this._getImageLeftPosition(n.x,e.x),a=this._getImageTopPosition(n.y,e.y);return{imageRequestSize:i,imageObjectSize:n,imageVisibleSize:{x:Math.min(e.x,i.x),y:Math.min(e.y,i.y)},imagePosition:{x:s,y:a}}},_getImageRequestSize:function(t,e){var i,n,s=t.x/t.y,a=e.x/e.y;switch(this._imageSettings.crop){case this.settingOptions.crop.FILL:case this.settingOptions.crop.STRETCH:s>a?(n=e.y,i=n*s):(i=e.x,n=i/s);break;case this.settingOptions.crop.FULL:a>s?(n=e.y,i=n*s):(i=e.x,n=i/s)}return{x:Math.ceil(i),y:Math.ceil(n)}},_getImageObjectSize:function(t,e){var i=t;return this._imageSettings.crop===this.settingOptions.crop.STRETCH&&(i=e),i},_getImageLeftPosition:function(t,e){var i;switch(this._imageSettings.align){case this.settingOptions.align.LEFT:i=0;break;case this.settingOptions.align.CENTER:i=e/2-t/2;break;case this.settingOptions.align.RIGHT:i=e-t}return Math.ceil(i)},_getImageTopPosition:function(t,e){var i;switch(this._imageSettings.v_align){case this.settingOptions.v_align.TOP:i=0;break;case this.settingOptions.v_align.MIDDLE:i=e/2-t/2;break;case this.settingOptions.v_align.BOTTOM:i=e-t}return Math.ceil(i)},getCropMode:function(){return this._imageSettings.crop},getHorizontalAlign:function(){return this._imageSettings.align},getVerticalAlign:function(){return this._imageSettings.v_align},setCropMode:function(t){return this._setSettingsProperty(this.settingOptions.crop,"crop",t)},setHorizontalAlign:function(t){return this._setSettingsProperty(this.settingOptions.align,"align",t)},setVerticalAlign:function(t){return this._setSettingsProperty(this.settingOptions.v_align,"v_align",t)},_setSettingsProperty:function(t,e,i){return this._imageSettings[e]!==i&&this._isValueInObject(t,i)?(this._imageSettings[e]=i,!0):!1},_isValueInObject:function(t,e){for(var i in t)if(t[i]===e)return!0;return!1}})}),define.Class("core.components.image.ImageDimensionsNew",function(t){var e=t;e.utilize(["core.components.image.ImageSettings"]),e.methods({initialize:function(){this.ImageSettings=this.imports.ImageSettings},getDimensionsForExactSize:function(t,e){return this._getImageDimensions(t,e,!0)},getDimensionsForPyramid:function(t,e){return this._getImageDimensions(t,e,!1)},_getImageDimensions:function(t,e,i){var n=e.x/e.y,s=this._getContainerSize(t,n),a=this._getWholeImageSize(t,n,s,i),r=this._getImagePosition(a,s,t);return{containerSize:s,imageSize:a,imagePosition:r}},_getContainerSize:function(t,e){var i=t.getCropMode(),n=Object.clone(t.getSize());return i===this.ImageSettings.CropModes.FIT_WIDTH?n.y=this._getHeightByWidth(n.x,e):i===this.ImageSettings.CropModes.FIT_HEIGHT&&(n.x=this._getWidthByHeight(n.y,e)),n},_getWholeImageSize:function(t,e,i,n){var s=i.x/i.y,a=Object.clone(i),r=t.getCropMode();return r===this.ImageSettings.CropModes.CONTAINS?s>e?a.x=this._getWidthByHeight(i.y,e):a.y=this._getHeightByWidth(i.x,e):(r===this.ImageSettings.CropModes.STRETCH||!n&&r===this.ImageSettings.CropModes.COVER)&&(s>e?a.y=this._getHeightByWidth(i.x,e):a.x=this._getWidthByHeight(i.y,e)),a},_getImagePosition:function(t,e,i){if(i.getCropMode()==this.ImageSettings.CropModes.STRETCH)return{x:0,y:0};var n={};return n.y=Math.ceil((e.y-t.y)/2),n.x=Math.ceil((e.x-t.x)/2),n},_getHeightByWidth:function(t,e){return Math.ceil(t/e)},_getWidthByHeight:function(t,e){return Math.ceil(t*e)}})}),define.component("core.components.image.ImageNew",function(t){var e=t;e.utilize(["core.components.image.ImageDimensionsNew","core.components.image.ImageUrlNew","core.components.image.ImageSettings"]),e.skinParts({image:{type:"htmlElement"}}),e.inherits("mobile.core.components.base.BaseComponent"),e.methods({initialize:function(t,e,i){this._initGlobalResources(),this.parent(t,e,i),this._useWebUrl=i.useWebUrl||!1,this._settings=i.settings,this._requestExactSize="boolean"==typeof i.requestExactSize?i.requestExactSize:!0,this._imageDimensions=new this.imports.ImageDimensionsNew,this._imageSrcBuilder=new this.imports.ImageUrlNew,this._imageUrl="",this._isSameImage=!1},_initGlobalResources:function(){this._utils=this.injects().Utils},setSettings:function(t){t&&(this._settings=t,this._renderIfReady())},_onDataChange:function(t,e,i){this._isSameImage=this._imageUrl===t.get("uri"),this._imageUrl=t.get("uri"),this.parent(t,e,i)},_prepareForRender:function(){return this._settings&&this._imageUrl?(this._refreshImage(),!0):!0},_refreshImage:function(){this._skinParts.image.set("alt",this._data.get("alt")),this._handleImageLoadingError();var t=this._getImageDimensions();this._setContainerSize(t.containerSize);var e=this._imageUrl;this._isGIF()?e=this._getImageSrc(this._getOriginalSizeFromData()):this._useWebUrl||this._imageUrl.test(/(^https?)|(^data)/)||this._isGIF()||(e=this._getImageSrc(t.imageSize,!this._isSameImage)),this._isSameImage=!0,this._setImageSrc(e);var i=this._settings.getCropMode()===this._settings.CropModes.STRETCH?t.containerSize:t.imageSize;this._setImagePositionAndSize(t.imagePosition,i)},_getImageDimensions:function(){var t,e=this._getOriginalSizeFromData();return t=this._requestExactSize&&!this._isGIF()?this._imageDimensions.getDimensionsForExactSize(this._settings,e):this._imageDimensions.getDimensionsForPyramid(this._settings,e)},_isGIF:function(){return this._imageUrl.test(/(\.gif$)/)},_getImageSrc:function(t,e){var i;if(this._requestExactSize)i=this._imageSrcBuilder.getImageUrlExactSize(t,this._imageUrl,this._getOriginalSizeFromData());else{var n=e?this._imageSrcBuilder.getImageUrlFromPyramidFirstTime(t,this._imageUrl):this._imageSrcBuilder.getImageUrlFromPyramidForSameImage(t,this._imageUrl,this._pyramidRequestSize);i=n.url,this._pyramidRequestSize=n.pyramidRequestSize}return i},_getOriginalSizeFromData:function(){var t={};return t.x=parseInt(this._data.get("width"),10),t.y=parseInt(this._data.get("height"),10),t.x||t.y||(t.x=t.y=128),t},_setContainerSize:function(t){this._utils.isEquivalent(this._containerSize,t)||(this.getViewNode().setStyles({width:t.x+"px",height:t.y+"px"}),this._containerSize=t)},getSize:function(){return this._containerSize},_setImageSrc:function(t){this._imgSrc!=t&&(this._skinParts.image.set("src",t),this._imgSrc=t)},_setImagePositionAndSize:function(t,e){this._skinParts.image.setStyles({"margin-top":t.y+"px","margin-left":t.x+"px",width:e.x+"px",height:e.y+"px"})},_handleImageLoadingError:function(){this._skinParts.image.removeEvents("error"),this._skinParts.image.addEvent("error",function(){LOG.reportError(wixErrors.IMAGE_LOAD_ERROR,"ImageNew","refresh",this._imageUrl),this._renderIfReady()}.bind(this))}}),e.dataTypes(["Image",""])}),define.Class("core.components.image.ImageSettings",function(t){var e=t;e.statics({CropModes:{COVER:"fill",CONTAINS:"full",FIT_WIDTH:"fitWidth",FIT_HEIGHT:"fitHeight",STRETCH:"stretch"}}),e.methods({initialize:function(t,e,i){return this.setSettings(t,e,i)},setSettings:function(t,e,i){return this._validateSettings(t,e,i)?(this._cropMode=t,this._containerWidth=e,this._containerHeight=i,this):null},getCropMode:function(){return this._cropMode},getSize:function(){return{x:this._containerWidth,y:this._containerHeight}},setCropMode:function(t){this._validateSettings(t,this._containerWidth,this._containerHeight)&&(this._cropMode=t)},setSize:function(t,e){this._validateSettings(this._cropMode,t,e)&&(this._containerWidth=t,this._containerHeight=e)},setWidth:function(t){this._containerWidth=t},setHeight:function(t){this._containerHeight=t},setContainerHeight:function(t){this._validateSettings(this._cropMode,this._containerWidth,t)&&(this._containerHeight=t)},setContainerWidth:function(t){this._validateSettings(this._cropMode,t,this._containerHeight)&&(this._containerWidth=t)},_validateSettings:function(t,e,i){switch(t){case this.CropModes.FIT_WIDTH:return this._isValidNumber(e);case this.CropModes.FIT_HEIGHT:return this._isValidNumber(i);case this.CropModes.COVER:case this.CropModes.CONTAINS:case this.CropModes.STRETCH:return this._isValidNumber(i)&&this._isValidNumber(e);default:return!1}},_isValidNumber:function(t){return t&&"number"==typeof t&&!isNaN(t)&&t>0},_getErrorDescString:function(t,e,i){return"_cropMode: "+t+" width: "+e+" height: "+i}})}),define.Class("core.components.image.ImageUrl",function(t){var e=t;e.resources(["W.Config"]),e.methods({getImageUrlExactSize:function(t,e){var i=this.resources.W.Config.getMediaStaticUrl(e)+e,n=this._getFileExtension(i);return i+"_srz_"+parseInt(t.x,10)+"_"+parseInt(t.y,10)+"_85_22_0.50_1.20_0.00_"+n+"_srz"},getImageUrlFromPyramid:function(t,e,i,n){var s=this.resources.W.Config.getMediaStaticUrl(e)+e,a=t.y>t.x?t.y:t.x,r=this._getPyramidSize(a,i,n);return s=s+"_"+r,{url:s,pyramidRequestSize:r}},_getPyramidSize:function(t,e,i){for(var n=[128,256,400,512,650,850,1024],s=n[n.length-1],a=0;n.length>a;++a)if(n[a]>=t){s=n[a];break}return e&&(s=Math.max(s,i)||s),s},_getFileExtension:function(t){var e=/[.]([^.]+)$/.exec(t);return e&&/[.]([^.]+)$/.exec(t)[1]||""}})}),define.Class("core.components.image.ImageUrlNew",function(t){var e=t;e.methods({initialize:function(){this._initGlobalResources()},_initGlobalResources:function(){this._config=this.injects().Config},getImageUrlExactSizeKeepRatio:function(t,e){var i=this._config.getMediaStaticUrl(e)+e,n=this._getFileExtension(i),s=[i];return s.push("srb"),s.push(parseInt(t.x,10)),s.push(parseInt(t.y,10)),s.push("75_22_0.50_1.20_0.00"),s.push(n),s.push("srb"),s.join("_")},getImageUrlExactSize:function(t,e,i){var n=this._config.getMediaStaticUrl(e)+e,s=this._getFileExtension(n),a=[n];a.push("srz");
var r=this._getRequestSizeSmallerThanOriginal(t,i);return a.push(parseInt(r.x,10)),a.push(parseInt(r.y,10)),a.push("75_22_0.50_1.20_0.00"),a.push(s),a.push("srz"),a.join("_")},getImageAbsoluteUrlFromRelativeUrl:function(t){return this._config.getMediaStaticUrl(t)+t},getImageUrlFromPyramidFirstTime:function(t,e){return this._getUrlForPyramid(t,e)},getImageUrlFromPyramidForSameImage:function(t,e,i){return this._getUrlForPyramid(t,e,!0,i)},_getRequestSizeSmallerThanOriginal:function(t,e){var i=e.x/t.x,n=e.y/t.y;if(i>=1&&n>=1)return t;var s={};return n>i?(s.x=e.x,s.y=e.x*(t.y/t.x)):(s.y=e.y,s.x=e.y*(t.x/t.y)),s},_getUrlForPyramid:function(t,e,i,n){var s=this._config.getMediaStaticUrl(e)+e,a=t.y>t.x?t.y:t.x,r=this._getPyramidSize(a,i,n);return s=s+"_"+r,{url:s,pyramidRequestSize:r}},_getPyramidSize:function(t,e,i){var n,s=[128,256,400,512,650,850,1024],a=s[s.length-1];for(n=0;s.length>n;++n)if(s[n]>=t){a=s[n];break}return e&&(a=Math.max(a,i)||a),a},_getFileExtension:function(t){var e=/[.]([^.]+)$/.exec(t);return e&&/[.]([^.]+)$/.exec(t)[1]||""}})}),define.Class("core.components.traits.SwipeSupport",function(t){var e=t;e.binds(["_onTouchDown","_onTouchMove","_onTouchUp"]),e.fields({_swipeMovementSpeedProp:"_movementSpeed",_swipeOrientation:"horizontal",_swipeEmulate:!1,_swipeLastPos:[],_swipeActive:!1,_swipeFrameCount:0,_touchSupported:!1}),e.methods({initialize:function(){this._touchSupported="ontouchend"in document||this._swipeEmulate,this._touchSupported&&(this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this._view.addEvent(this._swipeEmulate?"mousedown":"touchstart",this._onTouchDown,!0),this._Tween=this.injects().Utils.Tween)},_onComponentReady:function(){this._skinParts.swipeLeftHitArea.setStyle("display","none"),this._skinParts.swipeRightHitArea.setStyle("display","none")},_onTouchDown:function(t){this._view.addEvent(this._swipeEmulate?"mousemove":"touchmove",this._onTouchMove,!0),this._view.addEvent(this._swipeEmulate?"mouseup":"touchend",this._onTouchUp,!0),this._swipeLastPos=[{x:t.client.x,y:t.client.y,time:(new Date).getTime()}],this._swipeActive=!0,this._swipeFrameCount=0,this._enableMovement(!0)},_setSwipeMovementSpeed:function(t){this[this._swipeMovementSpeedProp]=t},_addLastPos:function(t){this._swipeLastPos.unshift(t),this._swipeLastPos.length>5&&this._swipeLastPos.pop()},_onTouchMove:function(t){t.preventDefault();var e={x:t.client.x,y:t.client.y,time:(new Date).getTime()},i=this._getSwipeDistance(e,this._swipeLastPos[0]);this._shiftOffset-=i,this._Tween.to(this,1,{_shiftOffset:this._shiftOffset-i,ease:"strong_easeInOut"}),this._addLastPos(e)},_onTouchUp:function(t){var e={x:t.client.x,y:t.client.y,time:(new Date).getTime()};e=this._swipeLastPos[0],this._view.removeEvent(this._swipeEmulate?"mouseup":"touchend",this._onTouchUp,!0),this._view.removeEvent(this._swipeEmulate?"mousemove":"touchmove",this._onTouchMove,!0);var i=this._calculateSwipeSpeed(this._swipeLastPos[this._swipeLastPos.length-1],e);this._Tween.killTweensOf(this),this._setSwipeMovementSpeed(20*-i);var n={ease:"linear",onComplete:function(){this._enableMovement(!1)}.bind(this)};n[this._swipeMovementSpeedProp]=0,this._Tween.to(this,1,n)},_getSwipeDistance:function(t,e){return"horizontal"==this._swipeOrientation?e.x-t.x:"vertical"==this._swipeOrientation?e.y-t.y:void 0},_calculateSwipeSpeed:function(t,e){return this._getSwipeDistance(t,e)/(e.time-t.time)}})}),define.oldTrait({name:"core.components.traits.TouchRollOverSupport",trait:{Binds:["_onComponentTouchStart","_onStageTouchStart","_onRender","_onComponentReady"],initialize:function(){this._touchSupported="ontouchend"in document||this._swipeEmulate,this._touchSupported&&(this._states.touchRollOverSupport=["touchRollOver","touchRollOut"],this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this.addEvent(Constants.ComponentEvents.RENDER,this._onRender))},_onComponentReady:function(){this.setState("touchRollOut")},_onRender:function(){this._view.addEvent("touchstart",this._onComponentTouchStart),document.addEvent("touchstart",this._onStageTouchStart)},_onComponentTouchStart:function(t){-1!==this.getState().indexOf("touchRollOut")&&(t.preventDefault(),t.stopPropagation(),this.setState("touchRollOver"))},_onStageTouchStart:function(t){-1!==this.getState().indexOf("touchRollOver")&&-1===t.target.getParents().indexOf(this._view)&&t.target!==this._view&&this.setState("touchRollOut")},dispose:function(){document.removeEvent("touchstart",this._onStageTouchStart),this.parent()}}}),define.experiment.Class("core.components.Container.NBC_WCD.New",function(t,e){var i=t;i.methods({addChild:function(t){var e,i=t.getParentComponent();if(i)var e=i.getChildComponents().map(function(t){return t.getLogic().getComponentId()});t.getViewNode().insertInto(this.getInlineContentContainer()),i&&this._reportComponentsZOrderChanged(t,i,e),this.moveChild(t,this.Z_INDEX_CHANGE_TYPES.TOP)}})}),define.experiment.component("core.components.MenuButton.LimitRecursiveDDM.New",function(t){var e=t;e.methods({getWidthOnLayout:function(){function t(t){var i=e.getStyle(t);return""!=i?parseInt(i,10):0}var e=this.getViewNode();return e.offsetWidth+t("margin-right")+t("margin-left")}})}),define.experiment.component("core.components.MenuButton.WixAppsPage.New",function(t,e){var i=t;i.skinParts({label:{type:"htmlElement"},icon:{type:"htmlElement",optional:!0},description:{type:"htmlElement",optional:!0},bullet:{type:"htmlElement",optional:!0}}),i.methods({_getButtonLabelTextField:function(){return this._data.getType().contains("Page")?"title":"text"}})}),define.experiment.component("core.components.Page.GridLines.New",function(t,e){var i=t;i.statics({MAX_HEIGHT:6e4}),i.methods({initialize:function(t,e,i){this.parent(t,e,i),this._isContentWixified=!1,this._isContentWixifyStarted=!1,this._wixifyCBList=[],this._contentReady=!1,this.setMaxH(this.MAX_HEIGHT),e.collapse(),this.resources.W.Viewer.addEvent("pageTransitionEnded",this._notifyPageComponentsOnPageVisibilityChange)},getPageMinHeight:function(){var t=this.getMinHeight();return t?t:500},render:function(){this.setMinH(this.getPageMinHeight()),this.parent(),this._fixSkinsWith20pxBottom()},_fixSkinsWith20pxBottom:function(){this._isPageSkinUsedToBeWith20pxBottom()&&void 0===this.getPaddingBottom()&&this.setPaddingBottom(20)},_isPageSkinUsedToBeWith20pxBottom:function(){var t=["wysiwyg.viewer.skins.page.BasicPageSkin","wysiwyg.viewer.skins.page.BorderPageSkin","wysiwyg.viewer.skins.page.LiftedBottomPageSkin","wysiwyg.viewer.skins.page.LiftedShadowPageSkin","wysiwyg.viewer.skins.page.LiftedTopPageSkin","wysiwyg.viewer.skins.page.ShinyIPageSkin"];return t.contains(this.getSkin().className)}})}),define.experiment.component("core.components.Page.JITPageLoader.New",function(t,e){var i=t,n=e;i.methods({initialize:n.after(function(t,e){e.setStyle("position","absolute").setStyle("top","0px").setStyle("left","0px")}),wixifyContent:function(t){t&&this._wixifyCBList.push(t);var e=this._view.getAttribute("id");W.Pages.isPageLoaded(e)?this._oldWixifyContent():W.Pages.loadPageById(e,this._oldWixifyContent.bind(this),this)},_oldWixifyContent:function(){if(this._isContentWixified)return this._setWixified(),void 0;if(!this._isContentWixifyStarted){this._isContentWixifyStarted=!0;var t=this._view.getElements("[comp]");if(0===t.length)return this._setWixified(),this.listenForContentRendered(),void 0;new Async.Bulk(t,null,{completeEvent:"wixified",completeCallback:function(){this._setWixified()}.bind(this)}),this.listenForContentRendered(),t.wixify()}}})}),define.experiment.Class("core.components.traits.SwipeSupport.FixTouchSupportBug.New",function(t){var e=t;e.methods({initialize:function(){this._touchSupported=Modernizr.touch||this._swipeEmulate,this._touchSupported&&(this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this._view.addEvent(this._swipeEmulate?"mousedown":"touchstart",this._onTouchDown,!0),this._Tween=this.injects().Utils.Tween)}})}),define.experiment.Class("core.components.traits.SwipeSupport.MobileSliderGallery.New",function(t,e){var i=t,n=e;i.binds([]),i.fields({}),i.methods({initialize:n.remove(),_onComponentReady:n.remove(),_onTouchDown:n.remove(),_setSwipeMovementSpeed:n.remove(),_addLastPos:n.remove(),_onTouchMove:n.remove(),_onTouchUp:n.remove(),_getSwipeDistance:n.remove(),_calculateSwipeSpeed:n.remove()})}),define.experiment.Class("core.components.traits.TouchRollOverSupport.FixTouchSupportBug.New",function(t){var e=t;e.methods({initialize:function(){this._touchSupported=Modernizr.touch||this._swipeEmulate,this._touchSupported&&(this._states.touchRollOverSupport=["touchRollOver","touchRollOut"],this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this.addEvent(Constants.ComponentEvents.RENDER,this._onRender))}})}),define.experiment.component("core.editor.components.UploadButton.NativeUploadButton.New",function(t,e){var i=t;i.utilize(["core.editor.managers.uploadmanager.DragAndDrop","core.editor.managers.uploadmanager.Uploader"]),window.$Uploader=null,i.resources(["W.Config","mode"]),i.statics({fleshUploader:{render:function(){this._flashLocation=W.Config.getServiceTopologyProperty("scriptsRoot")+"/flash/MediaUploader.swf";var t={},e={};e.quality="high",e.bgcolor="#FAFAFA",e.allowscriptaccess="always",e.allowfullscreen="true",e.wMode="window",e.scale="noScale",e.flashVars="serverRoot="+this.injects().Config.getServiceTopologyProperty("mediaServerRoot");var i={};i.id="UploadBTN",i.name="UploadBTN",i.align="middle",this._flashObjID=W.Utils.getUniqueId("UploadBTNFlashCont"),this._skinParts.flashContainer.setProperty("id",this._flashObjID),this._flashObj=swfobject.embedSWF(this._flashLocation,this._flashObjID,141,30,"10.0.0","playerProductInstall.swf",t,e,i)},setUploadFileType:function(t){this._message="setFileType",this._content=t,setTimeout(this._doCallFlash.bind(this),1)},_doCallFlash:function(){var t=this._getFlashObj("UploadBTN");t&&t.sendToFlash?t.sendToFlash(this._message,this._content):setTimeout(this._doCallFlash.bind(this),1)},_getFlashObj:function(t){var e=-1!=navigator.appName.indexOf("Microsoft");return e?window[t]:document[t]}},nativeUploader:{_onAllSkinPartsReady:function(){this.uploader=window.$Uploader||new this.imports.Uploader({addQueryParam:function(){return"&s="+this.context._content.mediaS},ticketUrl:this.baseUrl+"/media/tickets/get",uploadUrl:this.baseStaticUrl+"/api/add_file",getValidationRules:function(){return this.context._content||{}},parallelUploads:6,events:{onInit:function(){},onUploadStart:function(){},onSelectedFiles:function(){var t=document.createElement("ul");this.inQ.forEach(this.context._attachProgressNode.bind(this.context,t));var e=this.badFiles.filter(function(t){return t.$validation_errors_displayed?!1:t.$validation_errors_displayed=!0});e.length&&(e.forEach(this.context._attachErrorNode.bind(this.context,t)),this.context.injects().UserMedia.fireEvent("UploadError","<>"+this.context._createErrorMessage(e))),this.progressOutputNode&&this.progressOutputNode.appendChild(t)},onUploadProgress:function(t,e){var i,n,s=0,a=this.inProgress.indexOf(t),r=-1!==a?t:{};r.uploadprogress=~~(100*(e.loaded/e.total)),r&&r.getNode&&(n=r.getNode(),n.querySelector(".uploader-progress-bar").innerHTML=r.uploadprogress+"%"),i=this.inQ.concat(this.inProgress,this.done),i.forEach(function(t){s+=t.uploadprogress||0}),s/=i.length,this.context.injects().UserMedia.fireEvent("UploadProgressUpdate",s)},onFileUploaded:function(t,e){t.uploadResponse=this.context._parseMediaResponseXML(e.responseXML);var i=t.getNode();i.style.background="rgba(0,255,0,0.2)"},onUploadEnd:function(){function t(t){var e=t.getNode();setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e),delete t.getNode},1500),this.context.resources.mode.debug&&this.history.push(t)}this.done.forEach(t,this),this.context._finleizeUpload(this.done),this.done.length=0},onUploadError:function(t){this.context.injects().UserMedia.fireEvent("UploadError",'<><ul class="uploader-error-message"><li>'+t+"</li></ul>")}}}),window.Uploader=this.uploader,this.uploader.context=this,this.uploader.progressOutputNode=this._createUploadStatusNode(),this._skinParts.flashContainer.appendChild(this.uploader.progressOutputNode),this._skinParts.flashContainer.appendChild(this.uploader.uploadButton)},setUploadFileType:function(t){this._content=t,this.uploader.uploadButton.setTitle(t.label)},_createUploadStatusNode:function(){var t=document.createElement("div");t.innerHTML='<div>Debug Upload Status <button data-action="close">X</button></div>',t.onclick=function(t){"close"===t.target.getAttribute("data-action")&&this.parentNode&&this.parentNode.removeChild(this)},t.className="uploader-status-updater",t.id="uploader-status-updater-view";var e="background:rgba(255,255,255,0.8);text-align:left;padding:10px;overflow:auto;max-height:600px;position:fixed;z-index:100000000000;top:36px;right:0;display:none";return this.resources.mode.debug&&(e+="display:block"),t.style.cssText=e,t},_createErrorMessage:function(t){var e=t.map(function(t){return t.$validation_errors?"<li>"+t.name+"<br>"+t.$validation_errors.join("<br>")+"</li>":"<li>"+t.name+"<br> invalid file </li>"});return'<ul class="uploader-error-message">'+e.join("<br>")+"</ul>"},_attachProgressNode:function(t,e){if(!e.getNode){var i=document.createElement("li");i.style.padding="5px",i.style.background="hsla(200,100%,50%,0.2)";var n="<span>File Name: "+e.name+"</span><span>Size: "+e.size+'</span><div class="uploader-progress-bar">0%<div>';i.innerHTML=n,e.getNode=function(){return i},t.appendChild(i)}},_attachErrorNode:function(t,e){if(!e.getNode){var i=document.createElement("li");i.style.background="hsla(0,100%,50%,0.2)",i.style.padding="5px";var n="Error: <br>"+this._createErrorMessage([e]);i.innerHTML=n,e.getNode=function(){return i},t.appendChild(i),setTimeout(function(){delete e.getNode,i.parentNode&&i.parentNode.removeChild(i)},1e4)}},_finleizeUpload:function(t){var e=this,i=this._createMediaAddRequsetXML(t,this._content.wixType.replace("media","picture"),this._content.compType),n=new XMLHttpRequest;n.onload=function(){W.UserMedia.updateMedia(e._content.wixType)},n.onerror=function(){e.injects().UserMedia.fireEvent("UploadError",'<><ul class="uploader-error-message"><li>Upload Error</li></ul>')},n.open("POST",this.baseUrl+"/media/private/add"),n.withCredentials="true",n.setRequestHeader("Content-Type","application/xml"),n.send(i)},_createMediaAddRequsetXML:function(t,e,i){for(var n,s="<mediaItemList>",a=0;t.length>a;a++)n=t[a].uploadResponse,s+="<mediaItem",s+=' mediaType="'+e,s+='" componentType="'+i,s+='" fileName="'+n.fileName,s+='" originalFileName="'+n.originalName,s+='" fileSize="'+n.fileSize,s+='" width="'+(n.width||""),s+='" height="'+(n.height||""),s+='" mimeType="'+n.mimeType,s+='" iconURL="'+n.iconUrl,s+='" version="'+n.ver,s+='" />\n';return s+="</mediaItemList>"},_parseMediaResponseXML:function(t){var e,i;if(t?(e=t.querySelector("upload"),i=e.getAttribute("success")):(e={getAttribute:function(){return"No Response Error"}},i=!1),"true"===i){var n=t.querySelector("properties"),s=t.querySelector("sys_meta");return{status:e.getAttribute("errorDescription"),originalName:s.getAttribute("original_file"),mimeType:s.getAttribute("mime_type"),fileUrl:s.getAttribute("file_url"),iconUrl:s.getAttribute("icon_url"),fileSize:s.getAttribute("file_size"),width:s.getAttribute("width"),height:s.getAttribute("height"),ver:s.getAttribute("ver"),fileName:n.getAttribute("file_name")}}return{status:"error",origin:e.getAttribute("origin"),errorCode:e.getAttribute("errorCode"),errorDescription:e.getAttribute("errorDescription")}}}}),i.methods({initialize:function(t,e,i){if(this.parent(t,e,i),this.scriptsRoot=W.Config.getServiceTopologyProperty("scriptsRoot"),this.mediaServerRoot=W.Config.getServiceTopologyProperty("mediaServerRoot"),this.imports.Uploader.isAllApiExists()){var n=window.location.host.split(".").shift();n="editor",this.baseUrl="//"+n+"."+this.mediaServerRoot,this.baseStaticUrl="//0.static."+this.mediaServerRoot,Object.append(this,this.nativeUploader)}else Object.append(this,this.fleshUploader)},render:function(){},_doCallFlash:void 0,_getFlashObj:void 0,setUploadFileType:void 0})}),define.experiment.Class("core.editor.managers.editormanager.EditorManagerBase.FirstSave.New",function(t,e){var i=t;i.statics({MILLISECONDS_TO_POP_UP_AUTO_FIRST_SAVE:12e5})}),define.experiment.newDataSchema("ContactInformation.MobileQuickActions.New",function(){return{logoUrl:{type:"ref","default":""},companyName:{type:"string","default":""},phone:{type:"string","default":""},email:{type:"string","default":""},address:{type:"string","default":""},fax:{type:"string","default":""}}}),define.experiment.newDataSchema("QuickActions.MobileQuickActions.New",function(){return{quickActionsMenuEnabled:{type:"boolean","default":!1},navigationMenuEnabled:{type:"boolean","default":!0},phoneEnabled:{type:"boolean","default":!1},emailEnabled:{type:"boolean","default":!1},addressEnabled:{type:"boolean","default":!1},socialLinksEnabled:{type:"boolean","default":!1},colorScheme:{type:"string","enum":["dark","light"],"default":"dark"}}}),define.experiment.newDataSchema("SocialLinks.MobileQuickActions.New",function(){return{facebook:"string",twitter:"string",pinterest:"string",google_plus:"string",tumblr:"string",blogger:"string",linkedin:"string",youtube:"string",vimeo:"string",flickr:"string"}}),define.experiment.Class("core.editor.managers.editormanager.EditorManagerBase.MobileQuickActions.New",function(t,e){var i=t,n=e;i.resources(n.merge(["W.Data"])),i.methods({_siteLoaded:function(t){LOG.reportEditorLoadingEvent("SITE LOADED"),this.fireEvent(Constants.EditorEvents.SITE_LOADED,t),this._siteStructure=t,this._setMetaSiteData(),this._setSiteMetaData(),this._siteLoadedExtra(t)},_setSiteMetaData:function(){if(window.editorModel&&window.editorModel.siteMetaData){var t=window.editorModel.siteMetaData,e=t.contactInfo,i={type:"ContactInformation"};for(var n in e)i[n]=e[n];t.preloader&&(i.logoUrl=this.resources.W.Data.createDataItem({type:"Image",uri:t.preloader.uri,width:256,height:256,borderSize:0,title:"",description:"",alt:""}).getData()),this.resources.W.Data.addDataItem("CONTACT_INFORMATION",i);var s=t.quickActions,a=s.configuration,r={type:"QuickActions",colorScheme:s.colorScheme};for(var o in a)r[o]=a[o];this.resources.W.Data.addDataItem("QUICK_ACTIONS",r);var h=t.quickActions.socialLinks,l={type:"SocialLinks"};h.forEach(function(t){t.id&&t.url&&(l[t.id]=t.url)}),this.resources.W.Data.addDataItem("SOCIAL_LINKS",l)}else this.resources.W.Data.addDataItem("QUICK_ACTIONS",{type:"QuickActions"}),this.resources.W.Data.addDataItem("CONTACT_INFORMATION",{type:"ContactInformation"}),this.resources.W.Data.addDataItem("SOCIAL_LINKS",{type:"SocialLinks"})}})}),define.experiment.Class("core.editor.managers.serverfacade.ServerApiUrls.FirstSaveServerApi.New",function(t,e){var i=t,n=e;i.methods({initialize:n.after(function(){this._constants.FIRST_SAVE_URL_PART="/api/first_save"}),getFirstSaveUrl:function(){return this._getUrlWithQueryParams(this._constants.FIRST_SAVE_URL_PART)}})}),define.experiment.Class("core.editor.managers.serverfacade.ServerApiUrls.SiteVersion.New",function(t,e){var i=t;i.methods({getOverrideSaveUrl:function(){return this._constants.OVERRIDE_SAVE_URL_PART="/api/override_save",this._getUrlWithQueryParams(this._constants.OVERRIDE_SAVE_URL_PART)}})}),define.experiment.Class("core.managers.ConfigurationManager.ImagesFromTopology.New",function(t,e){var i=t;i.binds(["_saveTopology"]),i.methods({initialize:e.after(function(){this.resource.getResourceValue("topology",this._saveTopology)}),_saveTopology:function(t){this._topology=t},getLocationMapProperty:function(t){return this._topology[t]}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.GridLines.New",function(t){var e=t;e.methods({initComponentLayout:function(){this._view.setStyle("visibility","visible"),this.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout),this._valueFetchingRegex=/[-\d\.]+/;for(var t=["x","y","width","height","paddingBottom","minHeight"],e=!1,i=0;t.length>i;i++){var n=t[i],s=this._view.get(n);if(null!=s&&""!=s){e=!0;var a="set"+n.capitalize();this[a](s,!0)}}if(this._layoutInitialized=!0,e&&this._view.hasAttribute("pos")===!1)"relative"!=this._view.getStyle("position")&&this._view.setStyle("position","absolute");else{var r=this._view.getAttribute("pos");r&&this._view.setStyle("position",r)}this.saveCurrentDimensions(),this.saveCurrentCoordinates()},getPaddingBottom:function(){return this._$paddingBottom},getMinHeight:function(){return this._$minHeight},setPaddingBottom:function(t){return this._$paddingBottom!=parseInt(t,10)?isNaN(parseInt(t,10))?(W.Utils.debugTrace("WbaseComp","setPaddingBottom","NaN passed as value"),!1):(this._$paddingBottom=parseInt(t,10),!0):void 0},setMinHeight:function(t){return this._$minHeight!=parseInt(t,10)?isNaN(parseInt(t,10))?(W.Utils.debugTrace("WbaseComp","setMinHeight","NaN passed as value"),!1):(this._$minHeight=parseInt(t,10),!0):void 0},getSizeLimits:function(){return void 0===this._sizeLimits&&(this._sizeLimits=new this.imports.SizeLimits,this._sizeLimits.minW=this._sizeLimits.minW||this.MINIMUM_WIDTH_DEFAULT,this._sizeLimits.minH=this._sizeLimits.minH||this.MINIMUM_HEIGHT_DEFAULT,this._sizeLimits.maxW=this._sizeLimits.maxW||this.MAXIMUM_WIDTH_DEFAULT,this._sizeLimits.maxH=this._sizeLimits.maxH||this.MAXIMUM_HEIGHT_DEFAULT,this._originalSizeLimits=this._sizeLimits.clone()),this._$minHeight&&(this._sizeLimits.minH=this._$minHeight),this._sizeLimits}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.PartialComponentPreview.New",function(t,e){var i=t;i.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0,previewable:!1},custom:[]}}),i.methods({isPreviewable:function(){return this.EDITOR_META_DATA.general.previewable},getPreviewableActionsContainer:function(){return"itemsContainer"}})}),define.experiment.Class("core.managers.component.ComponentManager.SyncWixify.New",function(t){var e=t;e.methods({getComponent:function(t,e){if(t=this.getNameOverride(t),this._componentMap[t])return e&&e(this._componentMap[t]),this._componentMap[t];var i=this.define.getDefinition("component"),n=nsUtil.getNameSpace(i,t),s=this._componentQue.hasQueue(t)===!1;return this._componentQue.add(t,e),s&&(n?this.registerNewComponent(t,n):this._classManager.getClass(t,function(){})),null}})}),define.experiment.Class("core.managers.ConfigurationManager.MobileRecognition.New",function(t,e){var i=t;i.utilize(["core.managers.configuration.MobileConfigurationManager"]),i.methods({initialize:function(){this.mobileConfig=new this.imports.MobileConfigurationManager}})}),define.experiment.newClass("core.managers.configuration.MobileConfigurationManager.MobileRecognition.New",function(t,e){var i=t;i.statics({MOBILE_MAX_WIDTH:600,TABLET_MAX_WIDTH:1100}),i.methods({_getScreenWidth:function(){var t=this.isAppleMobileDevice();return t?screen.width:screen.width/window.devicePixelRatio},isAppleMobileDevice:function(){return/iphone|ipod|ipad/i.test(navigator.userAgent.toLowerCase())},isAndroidMobileDevice:function(){return/android/i.test(navigator.userAgent.toLowerCase())},isMobile:function(){if("boolean"==typeof this._isMobile)return this._isMobile;var t=Math.min(screen.width,screen.height);return this.isAppleMobileDevice()||(t/=window.devicePixelRatio),this._isMobile=this.MOBILE_MAX_WIDTH>t&&this.isTouchScreen(),this._isMobile},isTablet:function(){if("boolean"==typeof this._isTablet)return this._isTablet;var t=this._getScreenWidth();return this._isTablet=t>=this.MOBILE_MAX_WIDTH&&this.TABLET_MAX_WIDTH>t&&this.isTouchScreen(),this._isTablet},isMobileOrTablet:function(){return this.isMobile()||this.isTablet()},isTouchScreen:function(){return this._isTouch=this._isTouch||Modernizr.touch,this._isTouch},isPortrait:function(t){var e=100;setTimeout(function(){var e=0===window.orientation||180===window.orientation;t(e)},e)}})}),define.experiment.Class("core.managers.css.CssManager.RichTextViewer.New",function(t,e){var i=t;i.methods({_updateThemeGlobalCssByPropertyName:function(t,e){var i=this.getThemeGlobalPropertyCssRules(t,e);if(i.forEach(function(t){this._themeStyleSheet.updateRule(t.selector,t.rules)},this),"font"==e){var n=this._themeManager.getProperty(t).getFontFamily(),s=this.getFontType(n);"custom"==s&&this.loadFont(n)}},getThemeGlobalPropertyCssRules:function(t,e,i){e=e||this._themeManager.getPropertyType(t);var n=this._themeManager.getProperty(t),s=[];switch(e){case"font":var a="."+t,r="";r=i?"font: "+n.getCssValue():n.getCssRule(),s.push({selector:a,rules:r});break;case"color":var o="."+t,h="color:"+n.getHex(!1),l=".back"+t,c="background-color:"+n.getHex(!1);s.push({selector:o,rules:h}),s.push({selector:l,rules:c})}return s},getCustomUsedFontsUrl:function(){return this._readyFonts&&0!=Object.keys(this._readyFonts).length?{missingFontsNames:this._readyFonts,missingFontsUrl:this._getFontsUrl(this._readyFonts)}:null},getFontUrl:function(t){if(0>this._customFontsNames.indexOf(t))return null;var e={};return e[t]=1,this._getFontsUrl(e)},_getFontsUrl:function(t){return this.FONT_SERVICE_URL+this._getFontsQuery(t)},_loadFonts:function(){delete this._fontLoadCallLater;var t=this._getFontsUrl(this._loadedFonts);for(var e in this._loadedFonts)this._readyFonts[e]=e,delete this._loadedFonts[e];this._addFontsLoaderCssTag(t)}})}),define.experiment.Class("core.managers.css.CssManager.Staff.Wix",function(t,e){var i=t,n=e;i.methods({_configureSystemFonts:n.before(function(){Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-UltLt"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-UltLt"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-25UltL"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-35Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-95Blac"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-95Blac"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-95Blac"]);var t=this.getHelveticaCssUrl();t&&this._addFontsLoaderCssTag(t)})})}),define.experiment.Class("core.managers.data.DataItemBase.RichText.New",function(t){var e=t;e.methods({set:function(t,e,i,n,s){if(e=this.injects().Utils.sanitizeUnicode(e),this._data[t]!==e){var a=this._getDataOldValue(t,s);if(this._data[t]=e,this.setMeta("isPreset",!1),!i){var r={};r[t]=e,this.fireDataChangeEvent(t,r,a,n)}}},_getDataOldValue:function(t,e){if(!e){var e={};e[t]=this._data[t]}return e}})}),define.experiment.Class("core.managers.data.DataItemBase.StylePerComponent.New",function(t){var e=t;e.methods({markDataAsClean:function(){var t=this.get("id");this._dataManager.clearDirtyObject(t)}})}),define.experiment.Class("core.managers.data.DataItemBase.SyncWixify.New",function(t){var e=t;e.methods({isReady:function(){return!0}})}),define.experiment.Class("core.managers.data.DataItemWithSchema.SyncWixify.New",function(t){var e=t;e.methods({isReady:function(){if(this._isReady)return!0;var t=this.getWaitingForReadyList();return this._isReady=t.length>0?!1:!0,this._isReady},getWaitingForReadyList:function(){var t=[],e=this.getData(),i=this.getDataManager();for(var n in e){var s,a,r=this.getFieldType(n);if("ref"==r)s=this.get(n),a=i.isDataAvailable(s),a||t.push(s);else if("refList"==r)for(var o=this.get(n),h=0;o.length>h;h++)s=o[h],a=i.isDataAvailable(s),a||t.push(s)}return t}})}),define.experiment.Class("core.managers.data.DataManager.StylePerComponent.New",function(t){var e=t;e.methods({clearDirtyObject:function(t){delete this.dirtyDataObjectsMap[t]}})}),define.experiment.Class("core.managers.data.DataManager.SyncWixify.New",function(t,e){var i=t,n=e;i.methods({initialize:n.after(function(){this._notReadyDataMap={},this._waitingForReadyDataMap={}}),addDataItem:function(t,e){e=this.resources.W.Experiments.applyExperiments(t,e);var i=this.createDataItem(e);i._data.id=t,this.markDirtyObject(i);var n=i.isReady();return n?this._setDataReady(i):this._addToWaitingForReady(i),i},_addToWaitingForReady:function(t){var e=t.get("id");this._notReadyDataMap[e]=t;for(var i=t.getWaitingForReadyList(),n=0;i.length>n;n++){var s=i[n];0===s.indexOf("#")&&(s=s.substr(1)),this._waitingForReadyDataMap[s]||(this._waitingForReadyDataMap[s]=[]),this._waitingForReadyDataMap[s].push(e)}},_setDataReady:function(t){var e=t.get("id");this.dataMap[e]=t,this._runCallbacks(e,t),this._updateDataWaitingList(t),this._notReadyDataMap[e]&&delete this._notReadyDataMap[e]},_updateDataWaitingList:function(t){var e=t.get("id"),i=this._waitingForReadyDataMap[e];if(i){delete this._waitingForReadyDataMap[e];for(var n=0;i.length>n;n++){var s=this._notReadyDataMap[i[n]];s&&s.isReady()&&this._setDataReady(s)}}},getDataByQuery:function(t,e){var i=null;if(0===t.indexOf("#")){var n=t.substr(1);if(i=this.dataMap[n],e=e||function(){},i)return e(i),i;this.callbackQueue.add(n,e);var s=this.define.getDefinition(this.DEFINE_NAMESPACE),a=nsUtil.getNameSpace(s,n);if(a)return this.addDataItem(n,a)}else LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","getDataByQuery",t),W.Utils.callLater(e,[null])},isReady:function(){return Object.getLength(this._notReadyDataMap)>0&&Object.getLength(this._waitingForReadyDataMap)>0?!1:!0}})}),define.experiment.Class("core.managers.data.DataManager.URM4.New",function(t){var e=t;e.methods({reportDataItemChangeEvent:function(t,e,i,n,s){if(this.fireEvent(Constants.DataEvents.DATA_CHANGED,[t,e,i,n]),!s&&void 0!==e&&void 0!==i&&t._data.id&&!this.injects().Utils.areObjectsEqual(e,i)){if("core.managers.theme.ThemeManager"===this.getOriginalClassName()&&!n)return;this.fireEvent("undoDataChangedEvent",[t,e,i,n])}}})}),define.experiment.Class("core.managers.serverfacade.CorsRESTClient.ShowOneMnMessage.New",function(t,e){var i=t;i.methods({get:function(t,e,i){var n=this._createCorsXhr(t);n.onabort=function(){this._onXhrEvent("abort",n,i)}.bind(this),n.ontimeout=function(){this._onXhrEvent("timeout",n,i)}.bind(this),n.onerror=function(){this._onXhrEvent("error",n,i)}.bind(this),n.onload=function(){this._onXhrEvent("load",n,i)}.bind(this),n.onprogress=function(){},e&&Object.each(e,function(t){t.key&&t.value&&n.setRequestHeader(t.key,t.value)}),n.send()}})}),define.experiment.Class("core.managers.skin.SkinManager.SyncWixify.New",function(t){var e=t;e.methods({getSkin:function(t,e){if(t=this.getNameOverride(t),this._skinClassMap[t])return e&&e(this._skinClassMap[t]),this._skinClassMap[t];var i=this._skinQue.hasQueue(t)===!1;if(this._skinQue.add(t,e),i){var n=this.define.getDefinition("skin"),s=nsUtil.getNameSpace(n,t);s?this.registerNewSkin(t,s):this._classManager.getClass(t,function(){})}return null}})}),define.experiment.Class("core.managers.style.SkinParamMapper.AdvancedStylingCancel.New",function(t,e){var i=t;i.methods({resetStyleFromData:function(t,e){this._skin=new e,this._rawData=Object.clone(t),this._dataItem.set("skin",this._skin.$className),this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY)
}})}),define.experiment.Class("core.managers.viewmanager.ViewManagerBase.LazyMasterPage.New",function(t,e){var i=t;i.methods({_isInPage:function(t){return!this._notChildOfSelector(t,"[comp=mobile.core.components.Page],[comp=core.components.Page],[comp=wixapps.integration.components.AppPage]")},_isPage:function(t){return"mobile.core.components.Page"===t.get("comp")||"core.components.Page"===t.get("comp")||"mobile.core.components.Page"===t.get("comp")},_getPagesWithoutContent:function(t){return this._getAllComponents(t,function(t){return this._isPage(t)}.bind(this))},_getMasterPageComponentsWithoutPages:function(t){var e=this._getAllComponents(t,function(t){return!this._isInPage(t)&&!this._isPage(t)}.bind(this));if(window.adData){this.setAdData(window.adData);var i=document.getElementById("wixFooter");i&&e.push(i)}return e},_wixifySiteLazily:function(t,e){var i=this._getPagesWithoutContent(t),n=this._getMasterPageComponentsWithoutPages(t),s=!1,a=!1;new Async.Bulk(i,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){i.removeClass("initHidden"),this.updatePagesData();var t=[];if(e===!1)for(var n in this._pages)t.push(this._pages[n].getLogic());else{var r=this._getPageDataFromHash(W.Utils.hash.getHash());t.push(this._pages[r.get("id")].getLogic())}new Async.Bulk(t,null,{completeEvent:"contentWixified",completeCallback:function(){s=!0,a&&this._onSiteReady()}.bind(this)});for(var o=0;t.length>o;++o)t[o].wixifyContent()}.bind(this)}),new Async.Bulk(n,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){a=!0,s&&this._onSiteReady()}.bind(this)}),i.wixify(),n.wixify()}})}),define.experiment.Class("core.managers.viewmanager.ViewManagerBase.PageLoadReport.New",function(t,e){var i=t,n=e;i.methods({_wixifySiteLazily:function(t,e){var i=this._getInitComponents(t);if(window.adData){this.setAdData(window.adData);var n=document.getElementById("wixFooter");n&&i.push(n)}this._logViewerRender("master page render"),new Async.Bulk(i,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){i.removeClass("initHidden"),this.updatePagesData();var t=[];if(e===!1)for(var n in this._pages)t.push(this._pages[n].getLogic());else{var s=this._getPageDataFromHash(W.Utils.hash.getHash());t.push(this._pages[s.get("id")].getLogic())}this._logViewerRender("page render"),new Async.Bulk(t,null,{completeEvent:"contentWixified",completeCallback:function(){this._onSiteReady()}.bind(this)});for(var a=0;t.length>a;++a)t[a].wixifyContent()}.bind(this)}),i.wixify()},_onSiteReady:n.before(function(){this._logViewerRender("site ready")}),_logViewerRender:function(t){deployStatus("viewerRender",{step:t,time:LOG.getSessionTime()})}})});