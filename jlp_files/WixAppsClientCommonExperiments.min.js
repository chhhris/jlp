define.experiment.Class("wixapps.core.data.DataMigrator.AppBuilderLinks.New",function(e,t){var i=e,n={FIELD_DELETED:"FieldDeleted",FIELD_TYPE_CHANGED:"FieldTypeChanged",FIELD_VALIDATIONS_CHANGED:"FieldValidationsChanged",FIELD_DEFAULT_VALUE_CHANGED:"FieldDefaultValueChanged",FIELD_ADDED:"FieldAdded",VALUE_CHANGED:"ValueChanged"};i.methods({migrateItem:function(e,t){for(var i=Object.clone(t),a=0;e.length>a;a++){var o=e[a],s=o.fieldName;switch(o.op){case n.FIELD_DELETED:delete i[s],delete i.links[s];break;case n.FIELD_TYPE_CHANGED:i[s]=this._convertType(i[s],o.oldField.type,o.newField.type,o.newField.defaultValue);break;case n.FIELD_VALIDATIONS_CHANGED:this._typesManager.validateValue(i[s],o.newField)||(i[s]=o.newField.defaultValue);break;case n.FIELD_DEFAULT_VALUE_CHANGED:if("links"===s){var r=o.newField.defaultValue;for(var l in r)r.hasOwnProperty(l)&&"_type"!==l&&(i.links.hasOwnProperty(l)||(i.links[l]=r[l]))}break;case n.FIELD_ADDED:void 0!==o.newField.defaultValue&&(i[s]=o.newField.defaultValue)}}return i}})}),define.experiment.dataItem("WIXAPPS_EXTERNAL_APPS.EcomRepo.New",function(e){var t=e;return t.merge({items:{ecommerce:{descriptorResourceName:"ecommerceDescriptor"}}})}),define.experiment.Class("wixapps.core.data.providers.wixdb.WixDbDraftDataProvider.AppBuilderLinks.New",function(e,t){var i=e;i.methods({adminTypeMigration:function(e){var t=Object.clone(e);this._ensureLinksFieldOnTypes(t),this.updateType(t)},_ensureLinksFieldOnTypes:function(e){if(e){var t=e.fields.some(function(e){return"links"===e.name});t||e.fields.push({name:"links",type:"wix:Object",defaultValue:{_type:"wix:Object"}})}}})}),define.experiment.Class("wixapps.integration.components.ClippedParagraph.RichTextViewer.New",function(e,t){var i=e;i.methods({_onAllSkinPartsReady:function(){this.parent(),this.resources.W&&this.resources.W.Theme&&this.resources.W.Theme.addEvent("propertyChange",function(e){if(0===e.name.indexOf("font_")){var t=this._data.get("text"),i=this.getRichTextContainer();this._paragraphClipping.rebuildCache(t,i),this._clipTextContent()}}.bind(this)),this._view.setStyles({overflow:"hidden",position:"absolute",width:this.getWidth(),"white-space":"normal"})},_onDataChange:function(){this.parent(),this._skinParts&&this._clipTextContent()}})}),define.experiment.Class("wixapps.integration.components.editor.DataEditorDialog.AppsDispose.New",function(e,t){var i=e;i.methods({_onDialogClosing:function(e){if(this._inSaveProcess)return!1;var t=this.resources.W.Commands.getCommand("WAppsEditorCommands.DataEditorFinish"),i={appId:this._targetComp.getDataItem().get("appInnerID")},n=this._appsEnvironment;if("DISCARD"==e.result||"CANCEL"==e.result){var a=function(){i.dataChanged=!1,t.execute(i),this._dialogWindow.closeDialog(),n.popDataServiceContext(),this.dispose()}.bind(this);return this.injects().EditorDialogs.openPromptDialog("Discard Changes","Are you sure you want delete all the edits you just made?","",this.resources.W.EditorDialogs.DialogButtonSet.YES_NO,function(e){e.result==this.resources.W.EditorDialogs.DialogButtons.YES&&setTimeout(a,0)}.bind(this),!1),!1}$$("body").removeEvent("click",this._closeAddItemCombo);var o=n.getDataService();if("SAVE"==e.result){var s,r=o.getItemCache(),l=[],p=[],d=[],h=r.getItemsMarkedAsDeleted(),c=h.length;r.each(function(e,t){(e.isDirty()||!e.getChildValue("_hash"))&&l.push(t)});var u=function(){if(this._inSaveProcess=!1,d.length>0)this.injects().EditorDialogs.openErrorDialog("Error Saving Data","Please try again in a few minutes",s.code+"\n"+s.description,null);else{n.popDataServiceContext();try{var e=n.getItemCache();p.forEach(function(t){if(r.isItemMarkedAsDeleted(t))e.remove(t);else{var i=e.put(t,r.get(t).getValue(0));i.resetDirtyFlag()}})}catch(a){var o=n.getLogger();o.reportError(o.Errors.UNABLE_TO_REFRESH_AFTER_SAVE,this.$className,"onSuccess",o.SubCategory.DATA_EDITING)}var l=this.injects().EditorDialogs;l.openPromptDialog("Saved Successfully!","Data is saved successfully and published","",l.DialogButtonSet.OK),i.dataChanged=!0,t.execute(i),this._dialogWindow.closeDialog(),this._appsEnvironment.getAppInstance().fireEvent(Constants.WixAppEvents.FULL_DATA_EDITOR_SAVED,{}),this.dispose()}}.bind(this),g=function(e,t){return function(){"create"==t?p.unshift(e):p.push(e),l.length+c==p.length+d.length&&u()}},m=function(e){return function(t){s=t,d.push(e),l.length+c==p.length+d.length&&u()}};if(l.forEach(function(e){var t=r.get(e);t.getChildValue("_hash")?o.updateItem(r.idsFromKey(e).collectionId,t,g(e,"update"),m(e)):o.createItem(r.idsFromKey(e).collectionId,t,g(e,"create"),m(e))}),h.forEach(function(e){var t=r.idsFromKey(e);o.deleteItem(t.collectionId,t.itemId,g(e,"delete"),m(e))}),l.length>0||h.length>0)return this._inSaveProcess=!0,this.setState("saving"),!1;i.dataChanged=!1,t.execute(i),n.popDataServiceContext(),this._resizeHandler.deactivateResizeHandler(),this.dispose()}},dispose:function(){for(;this._listProxies.length;){var e=this._listProxies.pop();e.dispose()}}})}),define.experiment.Class("wixapps.integration.components.editor.DataItemEditorDialog.AppsDispose.New",function(e,t){var i=e;i.methods({_startEditItem:function(e){this._containmentOptions=this._model.getChildContainmentOptions(e.getTypeName()),this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.NONE?(this._skinParts.addToBtn.collapse(),this.setState("parentNonEditable","parentsEditing")):this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.ONE_TO_MANY_REFERENCE?(this._skinParts.addToBtn.setLabel("Move to"),this._skinParts.addToHeader.appendText("Cancel move"),this._allowMultiParents=!1):(this._skinParts.addToBtn.setLabel("Add to"),this._skinParts.addToHeader.appendText("Add to"),this._allowMultiParents=!0);var t=this._model.getTypeFriendlyName(e.getTypeName());this._isNewItem?this._dialogWindow.setTitle("Add "+t):this._dialogWindow.setTitle("Edit "+t),this._dialogWindow.clearTabs(),this._eventDispatcher=new this.imports.ProxyEventBus,this._resizeHandler=new this.imports.AppResizeHandler,this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._view),this._proxyFactory=new this.imports.ProxyFactory(this._appsEnvironment.getDataItemFactory(),this._appsEnvironment.getTypesManager(),this._appsEnvironment.getViewDefRepo(),this._eventDispatcher,this._appsEnvironment.getAppInstance().resolveResourcePath,this._appsEnvironment.getAppInstance().getPackageName(),new this.imports.LifecycleManager(this._eventDispatcher)),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory),this._originalItem=e,this._editedItem=this._createEditableCopy(this._appsEnvironment.getDataItemFactory(),e),this._autoAddToParent&&this._connectToParent(this._autoAddToParent),this._showContainmentControls(),this.proxy=this._proxyFactory.createView(this._editedItem,"editorForm","edit");var i=this.proxy.createComponent();this.proxy.setupProxy(),window.requestAnimFrame(function(){this.proxy.updateLayoutWhenReady()}.bind(this)),this._skinParts.editViewContainer.empty(),this._skinParts.editViewContainer.grab(i)},_onDialogClosing:function(e){if("CANCEL"==e.result)this._onCloseCallback&&this._onCloseCallback([{action:"cancel",originalItem:this._originalItem,editedItem:this._editedItem}]);else if("DELETE"==e.result)this._deleteItem();else{var t=this._appsEnvironment.getTypesManager().validateDataItem(this._editedItem);if(!t)return!1;if(W.Commands.executeCommand("WAppsEditorCommands.FinalizeDataItemEditing"),"DUPLICATE"==e.result)this._saveAsDuplicate();else if(("OK"==e.result||"OK_ADD_ANOTHER"==e.result)&&(this._isNewItem&&this._isRef&&(this._originalItem=this._model.addToCache(this._model.getItemDefaultCollection(this._originalItem.getTypeName()),this._originalItem.getValue(0))),this._editedItem.isDirty()&&(this._originalItem.isRef()?this._originalItem.setReferencedValue(this._editedItem.getValue(0)):this._originalItem.setValue(this._editedItem.getValue(0))),this._applyReparentingActions(this._originalItem),this._onCloseCallback&&this._onCloseCallback([{action:"update",originalItem:this._originalItem,editedItem:this._editedItem}]),"OK_ADD_ANOTHER"==e.result)){var i=this._model.getItemTemplate(this._editedItem.getTypeName(),this._isRef);return this._startEditItem(i),!1}}$(document.body).setStyle("overflow",this._bodyOverFlow),this._resizeHandler.deactivateResizeHandler(),this.dispose()},dispose:function(){this.proxy.dispose()}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderManageDialog.AppsDispose.New",function(e,t){var i=e;i.methods({_removeCursor:function(){this._selectionHandler.dispose(),this._listCursor.removeEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_disposeSkinParts:function(){var e=this._skinParts;e.manageItemsPane.dispose(),e.customizeItemTemplatePane.dispose(),e.itemDataPane.dispose()},_closeDialog:function(){this._dialogWindow.closeDialog(),this.dispose()},dispose:function(){this._skinParts.customizeItemTemplatePane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("expandIconClicked",this._expandCollapse),this._skinParts.tabs.addEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._removeListeners(),this._disposePresenters(),this._removeCursor(),this._disposeSkinParts()}})}),define.experiment.component("wixapps.integration.components.panels.BuilderDialogPanel.AppsDispose.New",function(e,t){var i=e;i.methods({dispose:function(){this._presenter.removeEvent&&this._presenter.removeEvent(Constants.WixAppsGUIEvents.MODEL_REPLACED,this._onModelReplaced),this._presenter.dispose(),this._eventBinding.dispose(),this._varBindings.forEach(function(e){e.dispose()}),this._viewHolder.dispose()}})}),define.experiment.component("wixapps.integration.components.panels.ChooseTextStylePanel.SyncWixify.New",function(e,t){var i=e;i.methods({setEditedComponent:function(e,t){this.disposeFields(),this._appPart=e,this._editedComponent=t,this._currentlySelectedStyle=this._originalStyle;for(var i,n,a,o,s=this._editedComponent.getViewNode().getViewProxy(),r=[],l=-1,p=this._originalStyle.split(/\s/),d=p.filter(function(e){return 0===e.indexOf("font_")}).pick(),h=0;10>=h;h++){i="font_"+(h+""),n="FONT_"+(h+"")+"_LABEL",a=new this.imports.Font(i,W.Preview.getPreviewManagers().Theme);var c=W.Data.createDataItem({type:"Button",label:this.injects().Resources.get("EDITOR_LANGUAGE",n),commandParameter:i},"Button");if(r.push(c),i===d){l=h,o=a;var u=W.Preview.getPreviewManagers().Theme.getProperty(i);this._setFontColor(o,u.getColorReference(),u.getColor())}}this._overrideStyleCheckBox=this.addCheckBoxField("Override text styles:");var g=this;this._overridesGroup=this.addInputGroupField(function(){this.setNumberOfItemsPerLine(0,10),g._fontStyle=this.addFontStyleField(),g._colorPicker=this.addFontColorField();var e=g._setFontStyles(o,p),t=s.getViewDefinition().getChildValue("bold"),i=s.getViewDefinition().getChildValue("italic");g._colorPicker.setValue(o),g._fontStyle.setValue(o);var n=g.addSelectionListInputField("",r,null,{type:"wixapps.integration.components.editor.ChooseTextStyleButton",skin:"wixapps.integration.skins.editor.ChooseTextStyleButtonSkin",numRepeatersInLine:1});n.addEvent("inputChanged",g._itemClick),n.addEvent("editStyleClicked",g._editStyleClicked),g._overrideStyleCheckBox.addEvent("inputChanged",g._colorOverrideChange),g._colorPicker.addEvent("inputChanged",g._colorSelected),g._fontStyle.addEvent("inputChanged",g._fontStyleSelected),g._setFontStyle(o,t,i),n.selectItemAtIndexAndUpdate(l),g._overrideStyleCheckBox.setValue(e);var a=this;a&&e?a.uncollapse():a.collapse()})}})}),define.experiment.component("wixapps.integration.components.panels.ProxyStylePanel.StylePerComponent.New",function(e,t){var i=e,n=t;i.methods({setEditedComponent:n.remove(),_createFields:function(){this._originalStyle=this._editedComponent.getStyle().getId(),this._currentlySelectedStyle=this._originalStyle,this._buildStyleButtons()}})}),define.experiment.Class("wixapps.integration.components.traits.ResizableProxyTrait.AutoResizeEvent.New",function(e){var t=e;t.statics({COMPONENT_AUTO_RESIZE_EVENT:"autoSized"})}),define.experiment.Class("wixapps.integration.managers.LifecycleManager.NBC_WCD.New",function(e){var t=e;t.methods({_waitsForWixification:function(e){var t=!0;return e.$logic&&(e.$logic.isReady?t=!e.$logic.isReady():e.$logic.getComponentStatus&&(t=!("ready"===e.$logic.getComponentStatus()))),t}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPart:function(e,t){var i=e.applicationId;this._applicationPageMgr.openDestinationPageDialogIfNeeded(i,t,function(){var n=e.widgets[t]||{},a={comp:"wixapps.integration.components.AppPart",data:{type:"AppPart",appInnerID:i,appLogicParams:{"wixapps:first-load-after-add-to-stage":{type:"AppPartParam",value:"true"}},appLogicCustomizations:[],appPartName:t,viewName:""},layout:{width:n.defaultWidth||500,height:n.defaultHeight||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},o=e.packageName+"_"+t+"_1",s=W.Commands.getCommand("WEditorCommands.AddComponentFullParams"),r=function(t){var i=t.getAppPartLogic().getDataEditingMetaInfo().hasDataSelection;i&&(s=W.Commands.getCommand("WAppsEditorCommands.OpenSectionDialog"),s.execute({selectedComp:t}));var n="page/"+this.injects().Preview.getPreviewManagers().Viewer.getCurrentPageId();LOG.reportEvent(wixEvents.APPS_FLOW_APP_ADDED_TO_STAGE,{g1:e.appDefinitionId,c1:n,c2:t.getComponentId()}),this.resources.W.Preview.getPreviewManagers().Layout.reportResize([t])}.bind(this);s.execute({compDef:a,styleId:o,onCreation:function(e){void 0!==e.getAppPartLogic()?r(e):e.addEvent("logicLoaded",function(){r(e)})}}),this._applicationPageMgr.addApplicationPages(i)}.bind(this))}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPartComponent:function(e,t,i,n,a){var o={comp:"wixapps.integration.components.AppPart2",data:{type:"AppBuilderComponent",appInnerID:e,appPartName:i},layout:{width:n.defaultWidth||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},s="app1",r=this.resources.W.Commands.getCommand("WEditorCommands.AddComponentFullParams");r.execute({compDef:o,styleId:s,onCreation:function(e){for(var t=e.getDataSelector(),i=t.getDataProvider(),n=0;a.length>n;n++){var o=a[n];this._addDataItemChangeEvent(o,i,t,e)}}.bind(this)}),this._reportAddPartToBi(t,n,i)}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager.EcomRepo.New",function(e,t){var i=e;i.methods({getAppsDeploymentConfig:function(e){this.resource.getResourceValue("WixappsAppsDeploymentEcom",e)}})}),define.experiment.Class("wixapps.integration.proxies.AreaProxy.RichText.New",function(e,t){var i=e;i.methods({_applyBoxLayout:function(){var e=this._getLayoutRootElement();if(this.imports.BoxFlexPolyfill.applyBoxFlexPolyfill(e),this._applyBoxStyles(e),this._setupBox(e),this._element.setStyle("position","relative"),this._componentLogic){var t=this._getInlineContent();this._isLayoutBasedHeight()?(this._componentLogic.getSkinPart("bg").setStyle("height","100%"),t.setStyle("position","absolute"),t.setStyle("height","100%")):(t.setStyle("position","relative"),t.setStyle("width","100%"))}}})}),define.experiment.Class("wixapps.integration.proxies.ClippedParagraphProxy.RichText.New",function(e,t){var i=e;i.methods({_getDefaultSkinName:function(){return"wixapps.integration.skins.ClippedParagraphSkin"}})}),define.experiment.Class("wixapps.integration.proxies.ContainerProxy.RichText.New",function(e,t){var i=e;i.methods({_autoStretchContent:function(){"stretch"!=this._def.getChildValue("heightMode")&&(this._inlineDiv&&this._inlineDiv.getParent()||(this._inlineDiv=this._componentLogic.getSkinPart("inlineContent"),this._inlineDiv.setStyles({height:"false"==this._def.getChildValue("packHeight")||this._def.getChildValue("packHeight")===!1?"100%":"auto",position:"relative"})))}})}),define.experiment.Class("wixapps.integration.proxies.InlineTextProxy.RichText.New",function(e,t){var i=e,n=t;i.methods({_createFormattedText:function(){var e=this._data.getValue(),t=this._getTextAsRichTextElement(e);return t=this._applyDefaultStyleOnText(t),this._isSingleLine()&&t.getFirst().addClass("singleLine"),t.innerHTML},_getBlockDefaultStyledElement:function(e){return new Element("span",{"class":e})},_getAcceptableDataTypes:function(){return["String","Number"]},_getContainerElement:n.remove(),_setupPropertyHandlers:n.remove(),_createRawData:n.remove(),createComponent:n.remove()})}),define.experiment.Class("wixapps.integration.proxies.LabelProxy.RichText.New",function(e,t){var i=e,n=t;i.utilize(["wysiwyg.common.utils.TextMigrationHandler","wysiwyg.common.utils.TextMigrationDomHelper"]),i.resources(["W.Theme"]),i.methods({initialize:function(e,t,i,n){this.parent(e,t,i,n),this._migrationHandler=new this.imports.TextMigrationHandler,this._migrationDomHelper=new this.imports.TextMigrationDomHelper},_createRawData:function(){return{type:"StyledText",text:this._createFormattedText()}},_createFormattedText:function(){var e=this._getInnerText();e=this._prepareLinks(e);var t=this._getTextAsRichTextElement(e);return t=this._applyDefaultStyleOnText(t),this._isSingleLine()&&t.getFirst().addClass("singleLine"),t.innerHTML},_prepareLinks:function(e){return W.Editor||this._def.getChildValue("disableLinks")?e=e.replace(/<a\b[^>]*>(.*?)<\/a>/gi,"$1"):this._updateLinkDataItems(),e},_getInnerText:function(){var e="";if("wix:RichText"===this._data.getTypeName()){var t=this._def.getChildrenRefs().some(function(e){return["prefix","postfix"].contains(e)});if(t)throw"Warning:: type [wix:RichText] does not support [prefix] or [postfix].";this._migrateHtml(),e=this._data.getChildValue("text")}else{var i=this._def.getChildValue("prefix"),n=this._def.getChildValue("postfix"),a=this._data.getValue();i&&(e+=i),a&&(e+=(a+"").trim()),n&&(e+=n)}return e},_getTextAsRichTextElement:function(e){this._isSingleLine()&&(e+="",e=e.replace(/(<p>|<\/p>|<br\/?>)/gi,""));var t=new Element("div");if("wix:RichText"!==this._data.getTypeName()){var i=new Element(this._getDefaultStylePlaceHolderTag());i.set("html",e),t.grab(i)}else t.set("html",e);if(this._isSingleLine()){var n=t.getFirst();t.empty(),t.grab(n)}return t},_applyDefaultStyleOnText:function(e){var t=e.getElements(this._getDefaultStylePlaceHolderTag());return t.forEach(function(e){this._replaceDefaultStyledElement(e)},this),e},_replaceDefaultStyledElement:function(e){var t=this._getDefaultStyleElement();t.innerElement.innerHTML=e.innerHTML,this._copyAttributesFromOneElementToAnother(e,t),this._copyStylesFromOneElementToAnother(e,t),e.parentNode.replaceChild(t.outerElement,e)},_copyAttributesFromOneElementToAnother:function(e,t){for(var i=this._migrationDomHelper.getAllAttributes(e),n=0;i.length>n;n++){var a=i[n],o=a.name;if("style"===o||"class"===o)return;var s=e.getAttribute(o);s&&t.outerElement.setAttribute(o,s)}},_copyStylesFromOneElementToAnother:function(e,t){var i=this._createElementStyleMap(e),n=this._createElementStyleMap(t.outerElement);for(var a in i)n[a]=i[a];t.outerElement.setStyles(n)},_createElementStyleMap:function(e){var t={},i=[],n=e.getAttribute("style");return n&&(n.trim().lastIndexOf(";")===n.length-1&&(n=n.substring(0,n.length-1)),i=n.split(";")),i.forEach(function(e){var i=e.split(":");2==i.length&&(t[i[0].trim()]=i[1].trim())}),t},_getDefaultStyleElement:function(){var e=Constants.WixApps.TEXT_STYLES[this._def.getChildValue("style")]||this._getDefaultStyleName(),t=this._getBlockDefaultStyledElement(e),i=t,n=this._def.getChildValue("bold")===!0||"true"===this._def.getChildValue("bold"),a=this._def.getChildValue("italic")===!0||"true"===this._def.getChildValue("italic"),o=this._def.getChildValue("lineThrough")===!0||"true"===this._def.getChildValue("lineThrough"),s=this._def.getChildValue("underline")===!0||"true"===this._def.getChildValue("underline"),r=parseFloat(this._def.getChildValue("line-height")||this._getLineHeightForStyleCssClass(e)),l=this._getDefaultColorElement();return l&&(i=this._insertElementToParentElement(i,l)),n&&(i=this._insertElementToParentElement(i,new Element("strong"))),a&&(i=this._insertElementToParentElement(i,new Element("em"))),isNaN(r)||i.setStyle("line-height",r+"em"),o&&(i=this._insertElementToParentElement(i,new Element("strike"))),s&&(i=this._insertElementToParentElement(i,new Element("u"))),{outerElement:t,innerElement:i}},_insertElementToParentElement:function(e,t){return e.grab(t),t},_getBlockDefaultStyledElement:function(e){var t=this._getLineHeightForStyleCssClass(e),i=this._getSeoTagForStyleCssClass(e),n=new Element(i,{"class":e});return t&&n.setStyle("line-height",t),n},_getDefaultColorElement:function(){var e=null,t=this._def.getChildValue("color");return t&&(e=new Element("span"),this._isCustomColor(t)?e.setStyle("color",t):e.addClass(t)),e},_setTooltip:function(){if(this._element)if(this._shouldShowTooltip(this._element)){var e=this._getInnerText();e=new Element("div").set("html",e).get("text"),this._element.setAttribute("title",e)}else this._element.removeAttribute("title")},_migrateHtml:function(){var e=this._data.getValue();e.hasOwnProperty("version")&&1!==e.version||(e.text=this._migrationHandler.migrateText(e.text,this._getDefaultStylePlaceHolderTag(),this._getDefaultStyleName()),e.version=2,this._data.setValue(e))},_getContainerElement:n.remove(),_addStylesOnElement:n.remove(),_addStyleOverrides:n.remove(),_applyColorStyle:n.remove(),_applyLineHeightStyle:n.remove(),getStyleString:function(){var e=Constants.WixApps.TEXT_STYLES[this._def.getChildValue("style")]||this._getDefaultStyleName(),t=this._def.getChildValue("color");return t?e+" "+t:e},_getDefaultSkinName:function(){return"wysiwyg.viewer.skins.WRichTextNewSkin"},_getSeoTagForStyleCssClass:function(){return"p"},_getDefaultStyleName:function(){return"font_8"},_getDefaultStylePlaceHolderTag:function(){return"hatul"},_getLineHeightForStyleCssClass:function(e){var t=this.resources.W.Theme.getProperty(e);return t.getLineHeight()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.AppsDispose.New",function(e,t){var i=e;i.methods({_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var i=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(i,e,t,this._stylesMap)}.bind(this)),this._componentLogic.addEvent("endEditing",this._onEditingCompleted),this.resources.W.Commands.registerCommandAndListener("WAppsEditorCommands.FinalizeDataItemEditing",this,this._onFinalizeDataItemEditing)},_onFinalizeDataItemEditing:function(){this.resources.W.Commands.executeCommand("WEditorCommands.StopEditingText"),this.resources.W.Commands.unregisterCommand("WAppsEditorCommands.FinalizeDataItemEditing")},dispose:function(){this._componentLogic.removeEvent("endEditing",this._onEditingCompleted),this.parent()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.RichText.New",function(e,t){var i=e,n=t;i.utilize(["wysiwyg.common.utils.TextMigrationHandler"]),i.resources(["W.Data","W.Commands"]),i.binds(["_linkIdGenerator","_onEditingCompleted"]),i.methods({initialize:function(e,t,i,n){this.parent(e,t,i,n),this._stylesMap=this.resources.W.Data.getDataByQuery("#WIXAPPS_EDITOR_STYLES"),this._migrationHandler=new this.imports.TextMigrationHandler},createComponent:function(){this.useSkinsInsteadOfStyles();var e=W.Data;return W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e),this._createWixComponent("wysiwyg.editor.components.richtext.WRichTextEditor",null,{isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator,isFixedToolbar:!1,isDraggable:!1,isAutoClosing:!1,isInitiallyCollapsed:!1})},_createRawData:n.remove(),_onDataChanged:n.remove(),_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var i=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(i,e,t,this._stylesMap)}.bind(this)),this.resources.W.Commands.registerCommandAndListener("WAppsEditorCommands.FinalizeDataItemEditing",this,this._onFinalizeDataItemEditing)},_onFinalizeDataItemEditing:function(){var e=this._componentLogic.endEditing();this._onEditingCompleted(e),this.resources.W.Commands.unregisterCommand("WAppsEditorCommands.FinalizeDataItemEditing")},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),t.version=2,this._data.setValue(t)},_getLinksDataFromHtml:function(e){for(var t=e.match(/dataQuery="[^"]*/gi)||[],i=[],n=0;t.length>n;n++){var a=t[n].split('"')[1],o=W.Preview.getPreviewManagers().Data.getDataByQuery(a);i.push(this._createAppsLink(o))}return i},_migrateHtml:function(){var e=this._data.getValue();e.hasOwnProperty("version")&&1!==e.version||(e.text=this._migrationHandler.migrateText(e.text,this._getDefaultStylePlaceHolderTag(),this._getDefaultStyleName()),e.version=2,this._data.setValue(e))},dispose:function(){this._componentLogic&&this._componentLogic.dispose(),this.parent()},_getDefaultStyleName:function(){return this._stylesMap.get("items").div.cssClass},_getDefaultStylePlaceHolderTag:function(){return this._stylesMap.get("items").div.seoTag},_getDefaultSkinName:function(){return"wixapps.integration.skins.editor.WRichTextInlineEditorSkin"}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorProxy.RichText.New",function(e,t){var i=e,n=t;i.resources(["W.Data","W.Utils","W.Commands"]),i.binds(["_linkIdGenerator","_onPreviewClicked","_onEditingCompleted"]),i.methods({_onComponentWixified:function(){var e=this._def.getChildValue("height");this._componentLogic.setHeight(e);var t=this._componentLogic.getSkinPart("frame");t.setStyle("height",e+"px"),this._componentLogic.getSkinPart("richTextContainer").addEvent(Constants.CoreEvents.CLICK,this._onPreviewClicked),this._createRTEditorComponent()},_createRTEditorComponent:function(){var e=W.Data;W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e);var t=new Element("DIV");t.set("comp","wysiwyg.editor.components.richtext.WRichTextEditor"),t.set("skin","wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin"),t.set("pos",""),this._editorElement=t,this._editorElement.addEvent(Constants.ComponentEvents.WIXIFIED,function(){}.bind(this)),this._editorElement.addEvent(Constants.ComponentEvents.READY,function(){this._editorLogic=t.getLogic(),this._editorLogic.addEvent("richTextEditorReady",function(){this._componentLogic.getSkinPart("richTextContainer").setStyle("visibility","hidden")}.bind(this)),this._notifyEditorReady()}.bind(this)),this._componentLogic.getSkinPart("frame").grab(t);var i={isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator};this._editorElement.wixify(i,this._editorData)},_onPreviewClicked:function(){this._getEditorComponent(function(e){var t=this._element.getWidth(),i=this._def.getChildValue("height"),n=this._data.getChildValue("text");e.addEvent("endEditing",this._onEditingCompleted),this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",this,this._onBeforeDataItemChanged),e.startEditing(n,i,t,this._stylesMap)}.bind(this))},_onBeforeDataItemChanged:function(){this.resources.W.Commands.executeCommand("WEditorCommands.StopEditingText")},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t),this._componentLogic.getSkinPart("richTextContainer").setStyle("visibility","inherit"),this._editorLogic.removeEvent("endEditing");var i=this.resources.W.Commands.getCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka");i&&i.unregisterListener(this)},_getLinksDataFromHtml:function(e){for(var t=e.match(/dataQuery="[^"]*/gi)||[],i=[],n=0;t.length>n;n++){var a=t[n].split('"')[1],o=W.Preview.getPreviewManagers().Data.getDataByQuery(a);i.push(this._createAppsLink(o))}return i},_getEditorComponent:function(e){this._editorLogic?e(this._editorLogic):this._registerToEditorReadyNotification(e)},_isSingleLine:function(){return!1},_getInnerText:n.remove(),_onEditorDataChanged:n.remove(),getRichTextEditor:n.remove(),_createRawData:n.remove(),_createEditor:n.remove(),_openEditor:n.remove(),_closeEditor:n.remove(),_getContainerForEditor:n.remove(),_getDialogLayer:n.remove(),_getCleanedHtml:n.remove(),dispose:function(){this._componentLogic&&this._componentLogic.getSkinPart("richTextContainer").removeEvent(Constants.CoreEvents.CLICK,this._onPreviewClicked),this._editorLogic&&this._editorLogic.dispose(),this.parent()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorProxy.RichText2.New",function(e,t){var i=e;i.binds(["_linkIdGenerator","_onPreviewClicked","_onEditingCompleted","_onCKDataChanged"]),i.methods({_createRTEditorComponent:function(){var e=W.Data;W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e);var t=new Element("DIV");t.set("comp","wysiwyg.editor.components.richtext.WRichTextEditor"),t.set("skin","wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin"),t.set("pos",""),this._editorElement=t,this._editorElement.addEvent(Constants.ComponentEvents.WIXIFIED,function(){}.bind(this)),this._editorElement.addEvent(Constants.ComponentEvents.READY,function(){this._editorLogic=t.getLogic(),this._editorLogic.addEvent("richTextEditorReady",function(){this._componentLogic.getSkinPart("frame").setStyle("visibility","hidden")}.bind(this)),this._notifyEditorReady()}.bind(this)),this._componentLogic.getSkinPart("frame").grab(t);var i={isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator,getDataOnCKChange:!0};this._editorElement.wixify(i,this._editorData)},_onPreviewClicked:function(){this._getEditorComponent(function(e){var t=this._element.getWidth(),i=this._def.getChildValue("height"),n=this._data.getChildValue("text");e.addEvent("endEditing",this._onEditingCompleted),e.addEvent("ckDataChanged",this._onCKDataChanged),this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",this,this._onBeforeDataItemChanged),e.startEditing(n,i,t,this._stylesMap)}.bind(this))},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t),this._componentLogic.getSkinPart("frame").setStyle("visibility","inherit"),this._editorLogic.removeEvent("endEditing"),this._editorLogic.removeEvent("ckDataChanged");var i=this.resources.W.Commands.getCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka");i&&i.unregisterListener(this)},_onCKDataChanged:function(e){var t=this._data.getValue();t.text!==e&&(t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t))}})}),define.experiment.Class("wixapps.integration.proxies.UnstyledLabelProxy.RichText.New",function(e,t){var i=e;i.resources(["W.Data"]),i.methods({initialize:function(e,t,i,n){this.parent(e,t,i,n),this._stylesMap=this.resources.W.Data.getDataByQuery("#WIXAPPS_EDITOR_STYLES")},_createFormattedText:function(){var e=this.parent(),t=new Element("div");return t.innerHTML=e,this._removeStyleAttributesFromSpans(t),this._replaceAllStylesWithDefault(t),t.innerHTML},_removeStyleAttributesFromSpans:function(e){var t=e.getElements("span");t.forEach(function(e){e.removeAttribute("style"),e.removeAttribute("class")})},_getDefaultStyleElement:function(){var e=this._getBlockDefaultStyledElement();return{outerElement:e,innerElement:e}},_getBlockDefaultStyledElement:function(){var e=this._stylesMap.get("items").div.cssClass,t=this._getSeoTagForStyleCssClass(e);
return new Element(t,{"class":e})},_replaceAllStylesWithDefault:function(e){var t=this._stylesMap.get("items").div.cssClass,i=e.getElements('[class*="font_"]');i.forEach(function(e){var i=e.getAttribute("class");i=i.replace(/\bfont_\d\b/gi,t),e.setAttribute("class",i)})}})}),define.experiment.Class("wixapps.integration.proxies.layout.DataEditFieldProxy.AppBuilderLinks.New",function(e,t){var i=e;i.binds(["_linkClick","_onLinkDialogClosing"]),i.traits(["wixapps.integration.proxies.traits.AppsLinkTrait"]),i.methods({_rewriteDefinition:function(e,t,i,n){if(!t.items||1!==t.items.length)throw"DataEditFieldProxy accepts exactly one child";var a=t.items[0];a.layout=a.layout||{};var o=this._linkPath+"_click",s=this._getLinkData(),r=[],l="";s?(r=this._generateLinkSelectorContent(a,o,n),l="bottom"):(r=this._generateAddLinkContent(t,a,o,n),l="top");var p={name:"HBox","box-align":l,items:r,events:{}},d=i.getEnvironment(),h=d.getEventsDispatcher();return h.addEvent(o,this._linkClick),p},_generateLinkSelectorContent:function(e,t,i){var n={id:i+"_addLinkButton",comp:{name:"Icon",css:{cursor:"pointer"},events:{click:{event:t,mode:"remove"}}},value:{_type:"wix:Image",src:"http://images/icons/link_remove.png",height:20,width:20,title:""},layout:{spacerBefore:3,height:27}},a={id:i+"_linkSelector",comp:{name:"LinkSelector",skin:"wixapps.integration.skins.LinkSelectorSkinII",showDescription:!0},data:this._linkPath},o={id:i+"_selectorWrapper",comp:{name:"VBox",items:[e,a]},layout:{"box-flex":1}};return[o,n]},_generateAddLinkContent:function(e,t,i,n){t=Object.merge({},t,{layout:{"box-flex":1}});var a={id:n+"_addLinkButton",comp:{name:"Icon",css:{cursor:"pointer"},events:{click:{event:i,mode:"add"}}},value:{_type:"wix:Image",src:"http://images/icons/link_create.png",height:20,width:20,title:""},layout:{spacerBefore:e["link-top-offset"]}};return a={id:n+"_addLinkButtonSpacing",comp:{name:"VBox",items:[a]},layout:{spacerBefore:3}},[t,a]},_linkClick:function(e){if("add"===e.mode){var t="appbuilderlink",i=this._getLinkData();i=i&&i.getValue?i.getValue():{_type:"wix:LinkBase"},this._openLinkDialog(i,t,this._onLinkDialogClosing)}if("remove"===e.mode){var n=this._viewContext.evaluatePath("links"),a=n.getValue(),o=this._linkPath.split(".").pop();delete a[o],n.setValue(a)}},_onLinkDialogClosing:function(e,t,i,n){var a=this;this.resource.getResources(["W.EditorDialogs"],function(o){if(n.result===o.W.EditorDialogs.DialogButtons.OK){e.copySchemaFieldsFrom(i);var s=a._createAppsLink(e).getValue(),r=a._viewContext.evaluatePath("links"),l=r.getValue(),p=a._linkPath.split(".").pop();t!==Constants.LinkState.NO_LINK&&s._type?l[p]=s:delete l[p],r.setValue(l)}})}})}),define.experiment.skin("wixapps.integration.skins.ClippedParagraphSkin.RichTextPresets.New",function(e){var t=e;t.css([" {word-wrap: break-word;}"," ul { list-style-type: disc; padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}"," ol {  list-style-type: decimal;padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}",' ul[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}',' ol[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}'," ul ul {list-style-type: circle; line-height: normal;}"," ol ul {list-style-type: circle; line-height: normal;}"," ol ol ul {list-style-type: square; line-height: normal;}"," ol ul ul {list-style-type: square; line-height: normal;}"," ul ol ul {list-style-type: square; line-height: normal;}"," ul ul ul {list-style-type: square; line-height: normal;}"," li{ color: inherit; font-size: inherit; font-family: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; letter-spacing: normal;}"," p {margin: 0; line-height: normal; letter-spacing: normal;}"," h1 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h2 {margin: 0; line-height: normal; letter-spacing: normal;}"," h3 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h4 {margin: 0; line-height: normal; letter-spacing: normal;}"," h5 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h6 {margin: 0;  line-height: normal; letter-spacing: normal;}"," a { color: inherit}"])}),define.experiment.newSkin("wixapps.integration.skins.ClippedParagraphSkin.RichTextViewer.New",function(e){var t=e;t.inherits("wysiwyg.viewer.skins.WRichTextNewSkin"),t.html('<div skinPart="richTextContainer" class=""></div>'),t.css([" {word-wrap: break-word;}"," ul { list-style-type: disc; padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}"," ol {  list-style-type: decimal;padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}",' ul[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}',' ol[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}'," ul ul {list-style-type: circle;}"," ol ul {list-style-type: circle;}"," ol ol ul {list-style-type: square;}"," ol ul ul {list-style-type: square;}"," ul ol ul {list-style-type: square;}"," ul ul ul {list-style-type: square;}"," li{ color: inherit; font-size: inherit; font-family: inherit; font-style: inherit; font-weight: inherit; line-height: normal; letter-spacing: normal;}"," p {margin: 0; line-height: normal; letter-spacing: normal;}"," h1 {margin: 0;line-height: normal; letter-spacing: normal;}"," h2 {margin: 0;line-height: normal; letter-spacing: normal;}"," h3 {margin: 0;line-height: normal; letter-spacing: normal;}"," h4 {margin: 0;line-height: normal; letter-spacing: normal;}"," h5 {margin: 0;line-height: normal; letter-spacing: normal;}"," h6 {margin: 0;line-height: normal; letter-spacing: normal;}"," a { color: inherit}"])}),define.experiment.skin("wixapps.integration.skins.WixAppsButtonSkin.NBC_SiteButton.New",function(e){var t=e;t.inherits("core.managers.skin.BaseSkin2")}),define.experiment.skin("wixapps.integration.skins.editor.DataEditorItemSkin.RichText.New",function(e,t){var i=e,n=t;i.css(n.merge(["%inlineContent% span {color:#999; }","%inlineContent% span.typeName { color:#808080; }","%inlineContent% .headingGrey18 > * { font-size:18px; font-weight:bold; color:#333; }","%inlineContent% .headingGrey18norm > * { font-size:18px; font-weight:normal; color:#333; }","%inlineContent% .headingGrey16 > * { font-size:16px; font-weight:normal; color:#333; }","%inlineContent% .textItalic14 > * { font-size:13px; font-style:italic; color:#808080; }","%inlineContent% .textItalic16 > * { font-size:16px; font-style:italic; color:#808080; }","[state=header] %inlineContent% > * {color:#333;}","[state=header] %inlineContent% span.typeName { color:#808080; }"]))}),define.experiment.skin("wixapps.integration.skins.editor.DataItemEditorDialogSkin.RichText.New",function(e,t){var i=e,n=t;i.css(n.merge(["%editViewContainer% .labelStyle p {display:block; color:#818181; font-size:14px; padding:2px 0 4px 5px; font-weight:normal;}"]))}),define.experiment.newSkin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"hover",type:Constants.SkinParamTypes.OTHER,defaultValue:"border:1px solid #ddd; background-color:#ddd; box-shadow: inset 0 1px 1px rgba(0,0,0,0.4), 0 1px 0 #fff;"},{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 1px 3px rgba(0,0,0,0.5)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#f0f0f0; [shd][rd]}",'%.drag%  {display: none; left :2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/drag.png")  no-repeat 50% 50%; [rd] cursor:pointer;}','%.close% {display: none; right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd] cursor:pointer;}','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0px;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; }","li .content {display:none; position:absolute; top:100%; min-width:100px; background:#fff; border-radius:3px; box-shadow:0 1px 3px rgba(0,0,0,0.3); z-index:99;}","li .content h5 { padding:3px 5px 3px 15px; border-radius:3px 3px  0 0; box-shadow:0 1px 3px rgba(0,0,0,0.4); font-weight:normal; font-size:12px; color:#666; text-transform:capitalize; background:#f0f0f0;}","li .options {overflow-x:hidden; overflow-y:auto; max-height:220px; background: #fff; margin:4px; border-radius:3px;}","li .options::-webkit-scrollbar {width: 10px; border-radius: 5px; background: #ddd;}","li .options::-webkit-scrollbar-thumb {width: 10px; border-radius: 5px; background: #ccc;}","li.btn { overflow:hidden;}","li.btn span {height:22px; width:22px;}","li.drop                { position:relative; min-width:60px; background-color:#fff; border:1px solid #ccc; box-shadow: inset 0 1px 5px 0px rgba(0,0,0,0.15);}","li.drop:after          { position:absolute; content:url([tdr]richtext/arrow.png); top:0; right:5px; bottom:0; line-height:18px; pointer-events:none;}","li.drop .select label  { padding:0 16px 0 4px; white-space:nowrap; overflow:hidden; text-overflow: ellipsis; display:block; text-transform:capitalize; cursor:pointer;}","li.drop .options label { font-size:11px; padding:0 5px 0 20px;}","li.style {width:80px;}","li.style .options { width:215px;}","li.style .options .wrap { position:relative; border-bottom:1px solid #ddd;}","li.style .options label {position:static !important; display:inline-block; padding:0 !important; margin:0 0 4px 0 !important; !important; white-space:nowrap; overflow:hidden; text-overflow: ellipsis;}","li.style .options span  {position:static !important; display:inline-block; padding:0 !important; margin:0 4px 0 0 !important; width:10px; !important; height:10px; !important; border:1px solid #ddd}","li.style .options em    {position:static !important; display:inline-block; padding:0 !important; margin:0 0 0 4px !important;  white-space:nowrap; overflow:hidden; text-overflow: ellipsis;}","li.style .options .labelwrapper {display:block !important; width:100% !important;}","li.font  {width:100px;}","li.font .options { width:180px;}","li.font .options label { margin:0 0 0 20px !important; padding:0 !important; display:block;}","li.font .options span  { display:block; height:24px; width:100%; margin:0 0 0 20px !important;}","li.fontsize {width:50px;}","li.size { width:88px;}","li.size .select {padding-left:28px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url([tdr]richtext/icons.png) no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px;}',"li.sp:before {background-position:2px -220px}","li.hg:before {background-position:2px -240px}","li.cols {width:40px;}","li.cols:after {position:absolute; content:url([tdr]richtext/arrow.png); right:4px; top:0; bottom:0; line-height:18px; pointer-events:none;}","li.color {background:url([tdr]richtext/icons.png) no-repeat;}","li.color:after {line-height:16px;}","li.fc {background-position:1px 1px;}","li.bc {background-position:1px -19px;}","li.justify {}","li.justify .options {margin:0; max-height:24px; overflow:hidden;}","li.justify .options label {display:none;}","li.btn:hover {[hover]}","li.cols:hover {[hover]}","li.part .options > div:hover {background-color:#d5effe;}",'li[state~="selected"] .content{ display:inline-block; }','li[state~="selected"]    {z-index:1;}','li.btn[state~="selected"] {[hover]}','li.cols[state~="selected"] {[hover]}','li.drop .options [state~="selected"] {background-color:#d5effe;}','li.drop .options [state~="selected"]:after {position:absolute; content:"✔"; top:0; left:5px; color:#555;}','li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }'])}),define.experiment.newSkin("wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<textarea skinPart="ckArea" ></textarea><div skinPart="toolBar" skin="wixapps.integration.skins.editor.WixAppsToolBarSkin"></div>'),t.css(["{margin:0px; cursor:default; position:absolute; top:0px; bottom:0px; left:0px; right:0px}","%toolBar% {position:fixed; top:350px; left:500px;}"])}),define.experiment.newSkin("wixapps.integration.skins.editor.WRichTextInlineEditorSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div skinPart="toolBar" skin="wixapps.integration.skins.editor.RichTextInlineToolBarSkin"></div><div class="bg"><textarea skinPart="ckArea" ></textarea></div>'),t.css(["{margin:5px; cursor:default;}"," .bg { background-color:#fff; }","%toolBar% { }"])}),define.experiment.newSkin("wixapps.integration.skins.editor.WixAppsToolBarSkin.RichText.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"hover",type:Constants.SkinParamTypes.OTHER,defaultValue:"border:1px solid #ddd; background-color:#ddd; box-shadow: inset 0 1px 1px rgba(0,0,0,0.4), 0 1px 0 #fff;"},{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 1px 3px rgba(0,0,0,0.5)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#f0f0f0; [shd][rd]}",'%.drag%  {display:none; left:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/drag.png")  no-repeat 50% 50%; [rd] cursor:move;}','%.close% {right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd] cursor:pointer;}','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0 20px 0 0;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {cursor:pointer; border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; box-sizing: content-box; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; }","li .content {display:none; position:absolute; top:100%; min-width:100px; background:#fff; border-radius:3px; box-shadow:0 1px 3px rgba(0,0,0,0.3); z-index:99;}","li .content h5 { padding:3px 5px 3px 15px; border-radius:3px 3px  0 0; box-shadow:0 1px 3px rgba(0,0,0,0.4); font-weight:normal; font-size:12px; color:#666; text-transform:capitalize; background:#f0f0f0;}","li .options {overflow-x:hidden; overflow-y:auto; max-height:220px; background: #fff; margin:4px; border-radius:3px;}","li .options::-webkit-scrollbar {width: 10px; border-radius: 5px; background: #ddd;}","li .options::-webkit-scrollbar-thumb {width: 10px; border-radius: 5px; background: #ccc;}","li.btn { overflow:hidden;}","li.btn span {height:22px; width:22px;}","li.drop                { position:relative; min-width:60px; background-color:#fff; border:1px solid #ccc; box-shadow: inset 0 1px 5px 0px rgba(0,0,0,0.15);}","li.drop:after          { position:absolute; content:url([tdr]richtext/arrow.png); top:0; right:5px; bottom:0; line-height:18px; pointer-events:none;}","li.drop .select label  { padding:0 16px 0 4px; white-space:nowrap; overflow:hidden; text-overflow: ellipsis; display:block; text-transform:capitalize; cursor:pointer;}","li.drop .options label { font-size:11px; padding:0 5px 0 20px;}","li.style {width:80px;}","li.style .options { width:215px;}","li.style .options .wrap { position:relative; border-bottom:1px solid #ddd;}","li.style .options label {position:static !important; display:inline-block; padding:0 !important; margin:0 0 4px 0 !important; !important; white-space:nowrap; overflow:hidden; text-overflow: ellipsis;}","li.style .options span  {position:static !important; display:inline-block; padding:0 !important; margin:0 4px 0 0 !important; width:10px; !important; height:10px; !important; border:1px solid #ddd}","li.style .options em    {position:static !important; display:inline-block; padding:0 !important; margin:0 0 0 4px !important;  white-space:nowrap; overflow:hidden; text-overflow: ellipsis;}","li.style .options .labelwrapper {display:block !important; width:100% !important;}","li.font  {width:100px;}","li.font .options { width:180px;}","li.font .options label { margin:0 0 0 20px !important; padding:0 !important; display:block;}","li.font .options span  { display:block; height:24px; width:100%; margin:0 0 0 20px !important;}","li.fontsize {width:50px;}","li.size { width:90px;}","li.size .select {padding-left:28px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url([tdr]richtext/icons.png) no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px;}',"li.sp:before {background-position:2px -220px}","li.hg:before {background-position:2px -240px}","li.cols {width:40px;}","li.cols:after {position:absolute; content:url([tdr]richtext/arrow.png); right:4px; top:0; bottom:0; line-height:18px; pointer-events:none;}","li.color {background:url([tdr]richtext/icons.png) no-repeat;}","li.color:after {line-height:16px;}","li.fc {background-position:1px 1px;}","li.bc {background-position:1px -19px;}","li.justify {}","li.justify .options {margin:0; max-height:24px; overflow:hidden;}","li.justify .options label {display:none;}","li.btn:hover {[hover]}","li.cols:hover {[hover]}","li.part .options > div:hover {background-color:#d5effe;}",'li[state~="selected"] .content{ display:inline-block; }','li[state~="selected"]    {z-index:1;}','li.btn[state~="selected"] {[hover]}','li.cols[state~="selected"] {[hover]}','li.drop .options [state~="selected"] {background-color:#d5effe;}','li.drop .options [state~="selected"]:after {position:absolute; content:"✔"; top:0; left:5px; color:#555;}','li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }'])}),define.experiment.skin("wixapps.integration.skins.inputs.RichTextEditorSkin.RichText.New",function(e){var t=e;t.html('<div skinPart="frame"><div skinPart="richTextContainer" class="richTextContainer"></div></div>'),t.css(["{ background-color:#fff; }","%frame% { [$borderRadius]; border: 1px solid #b4b4b4; box-shadow: 0 1px 1px 0 [shadowColor] inset; padding:2px; position: relative; }","%richTextContainer% { position:relative; width:100%; height:100%; overflow-y:auto; word-wrap: break-word; }"])}),define.experiment.skin("wixapps.integration.skins.inputs.TextLinkSkin.RichText.New",function(e){var t=e;t.html(""),t.css(["{ position:relative; cursor:pointer; color:#09f; width:100%; height:100%; word-wrap: break-word; }"," span { color:#09f; }"," span:hover { text-decoration:underline }"," p { color:#09f; }"," p:hover { text-decoration:underline }"])}),define.experiment.Class("wixapps.integration.utils.ParagraphClipping.RichTextViewer.New",function(e,t){var i=e;i.methods({clipParagraph:function(e,t,i,n){if(this._maxWidth!==i||this._maxHeight!==n||e!==this._lastTextContent){this._container=t,this._lastTextContent!==e&&(this._lastTextContent=e,this.rebuildCache(e,t));var a=i-this._maxWidth,o=n-this._maxHeight;this._reusable||this.rebuildCache(e,t),0!==a&&(this._cache=[]),this._maxWidth=i,this._maxHeight=n,isNaN(a)||a>.1*i||o>.1*n?this._cropParagraph(this._spanList,function(){return this._searchBinary(0,this._spanList.length-1)}.bind(this)):a>0||0===a&&o>0?this._cropParagraph(this._spanList,function(){return this._searchSequentially(this._lastCropIndex,1)}.bind(this)):this._cropParagraph(this._spanList,function(){return this._searchSequentially(this._lastCropIndex,-1)}.bind(this))}},rebuildCache:function(e,t){this.resetCache(),this._reusable=!0,this._prepareContent(e,t),this._createEllipsisSpan(t),this._cache=[]}})});